<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Immigr-Aid - Your 24/7 Immigration Caseworker</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: #ffffff;
            color: #000000;
            min-height: 100vh;
            transition: all 0.3s ease;
        }
        
        body.dark-mode {
            background: #000000;
            color: #ffffff;
        }
        
        /* Navigation Bar */
        .nav-bar {
            background: #ffffff;
            border-bottom: 1px solid #e0e0e0;
            padding: 15px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: sticky;
            top: 0;
            z-index: 1000;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .dark-mode .nav-bar {
            background: #1a1a1a;
            border-bottom-color: #333333;
        }
        
        .nav-title {
            font-size: 1.8rem;
            font-weight: bold;
            color: #000000;
        }
        
        .dark-mode .nav-title {
            color: #ffffff;
        }
        
        .ai-emphasis {
            color: #00ff88;
            text-shadow: 0 0 10px #00ff88;
        }
        
        .nav-controls {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .language-selector {
            padding: 8px 12px;
            border: 1px solid #ddd;
            border-radius: 8px;
            background: #ffffff;
            color: #000000;
            font-size: 0.9rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .dark-mode .language-selector {
            background: #2a2a2a;
            border-color: #444444;
            color: #ffffff;
        }
        
        .language-selector:hover {
            border-color: #00ff88;
        }
        
        .theme-toggle {
            background: #00ff88;
            color: #000000;
            border: none;
            padding: 8px 12px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.9rem;
            font-weight: 500;
            transition: all 0.3s ease;
        }
        
        .theme-toggle:hover {
            background: #00cc6a;
            transform: translateY(-1px);
        }
        
        /* Main Container */
        .main-container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
            display: flex;
            gap: 20px;
        }
        
        /* Main Content */
        .main-content {
            flex: 1;
            min-width: 0;
        }
        
        /* AI Sidebar */
        .ai-sidebar {
            width: 350px;
            background: #ffffff;
            border: 1px solid #e0e0e0;
            border-radius: 15px;
            padding: 20px;
            height: fit-content;
            position: sticky;
            top: 100px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }
        
        .dark-mode .ai-sidebar {
            background: #1a1a1a;
            border-color: #333333;
        }
        
        .ai-sidebar-header {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 15px;
            padding-bottom: 15px;
            border-bottom: 1px solid #e0e0e0;
        }
        
        .dark-mode .ai-sidebar-header {
            border-bottom-color: #333333;
        }
        
        .ai-sidebar-title {
            font-size: 1.2rem;
            font-weight: bold;
            color: #000000;
        }
        
        .dark-mode .ai-sidebar-title {
            color: #ffffff;
        }
        
        .ai-sidebar-subtitle {
            font-size: 0.9rem;
            color: #666666;
            margin-bottom: 15px;
        }
        
        .dark-mode .ai-sidebar-subtitle {
            color: #cccccc;
        }
        
        .ai-sidebar-chat {
            height: 400px;
            overflow-y: auto;
            margin-bottom: 15px;
            padding: 10px;
            background: #f8f9fa;
            border-radius: 10px;
        }
        
        .dark-mode .ai-sidebar-chat {
            background: #2a2a2a;
        }
        
        .ai-sidebar-input {
            display: flex;
            gap: 10px;
            margin-bottom: 10px;
        }
        
        .ai-sidebar-input input {
            flex: 1;
            padding: 8px 12px;
            border: 1px solid #e0e0e0;
            border-radius: 20px;
            font-size: 0.9rem;
            background: #ffffff;
            color: #000000;
        }
        
        .dark-mode .ai-sidebar-input input {
            background: #2a2a2a;
            border-color: #444444;
            color: #ffffff;
        }
        
        .ai-sidebar-input input:focus {
            outline: none;
            border-color: #00ff88;
        }
        
        .ai-sidebar-voice-btn {
            background: #ff6b6b;
            color: #ffffff;
            border: none;
            padding: 8px;
            border-radius: 50%;
            cursor: pointer;
            width: 35px;
            height: 35px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.8rem;
        }
        
        .ai-sidebar-voice-btn:hover {
            background: #ff5252;
        }
        
        .ai-sidebar-voice-btn.recording {
            background: #ff4444;
            animation: pulse 1s infinite;
        }
        
        .ai-sidebar-upload-btn {
            background: #4CAF50;
            color: #ffffff;
            border: none;
            padding: 8px;
            border-radius: 50%;
            cursor: pointer;
            width: 35px;
            height: 35px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.8rem;
        }
        
        .ai-sidebar-upload-btn:hover {
            background: #45a049;
        }
        
        .ai-sidebar-send-btn {
            background: #00ff88;
            color: #000000;
            border: none;
            padding: 8px 16px;
            border-radius: 20px;
            cursor: pointer;
            font-size: 0.9rem;
            font-weight: 500;
        }
        
        .ai-sidebar-send-btn:hover {
            background: #00cc6a;
        }
        
        .ai-sidebar-message {
            margin-bottom: 10px;
            padding: 8px 12px;
            border-radius: 12px;
            font-size: 0.9rem;
            max-width: 90%;
            word-wrap: break-word;
        }
        
        .ai-sidebar-message.user {
            background: #00ff88;
            color: #000000;
            margin-left: auto;
            text-align: right;
        }
        
        .ai-sidebar-message.ai {
            background: #ffffff;
            color: #000000;
            border: 1px solid #e0e0e0;
        }
        
        .dark-mode .ai-sidebar-message.ai {
            background: #1a1a1a;
            color: #ffffff;
            border-color: #333333;
        }
        
        .ai-sidebar-message.typing {
            background: #e5e5e5;
            color: #666666;
        }
        
        .dark-mode .ai-sidebar-message.typing {
            background: #333333;
            color: #999999;
        }
        
        .ai-sidebar-typing-dots {
            display: flex;
            gap: 3px;
            align-items: center;
        }
        
        .ai-sidebar-typing-dots span {
            width: 6px;
            height: 6px;
            border-radius: 50%;
            background: #666666;
            animation: typing 1.4s infinite ease-in-out;
        }
        
        .dark-mode .ai-sidebar-typing-dots span {
            background: #999999;
        }
        
        .ai-sidebar-typing-dots span:nth-child(1) {
            animation-delay: -0.32s;
        }
        
        .ai-sidebar-typing-dots span:nth-child(2) {
            animation-delay: -0.16s;
        }
        
        /* Responsive adjustments */
        @media (max-width: 1200px) {
            .main-container {
                flex-direction: column;
            }
            
            .ai-sidebar {
                width: 100%;
                position: static;
                order: -1;
            }
        }
        
        /* Navigation Tabs */
        .nav-tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }
        
        .nav-tab {
            background: #f8f9fa;
            color: #000000;
            border: 1px solid #e0e0e0;
            padding: 12px 20px;
            border-radius: 10px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 500;
            transition: all 0.3s ease;
            text-decoration: none;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .dark-mode .nav-tab {
            background: #2a2a2a;
            color: #ffffff;
            border-color: #444444;
        }
        
        .nav-tab:hover {
            background: #00ff88;
            color: #000000;
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(0,255,136,0.3);
        }
        
        .nav-tab.active {
            background: #00ff88;
            color: #000000;
            box-shadow: 0 4px 15px rgba(0,255,136,0.3);
        }
        
        /* Content Sections */
        .content-section {
            display: none;
            animation: fadeIn 0.5s ease-in-out;
        }
        
        .content-section.active {
            display: block;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        /* Section Titles */
        .section-title {
            font-size: 2rem;
            font-weight: bold;
            margin-bottom: 20px;
            color: #000000;
        }
        
        .dark-mode .section-title {
            color: #ffffff;
        }
        
        /* Cards */
        .card {
            background: #ffffff;
            border: 1px solid #e0e0e0;
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            transition: all 0.3s ease;
        }
        
        .dark-mode .card {
            background: #1a1a1a;
            border-color: #333333;
        }
        
        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.15);
        }
        
        .dark-mode .card:hover {
            box-shadow: 0 8px 25px rgba(0,255,136,0.1);
        }
        
        /* Progress Section */
        .progress-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .progress-card {
            background: linear-gradient(135deg, #00ff88 0%, #00cc6a 100%);
            color: #000000;
            padding: 25px;
            border-radius: 15px;
            text-align: center;
            box-shadow: 0 4px 15px rgba(0,255,136,0.3);
        }
        
        .progress-number {
            font-size: 3rem;
            font-weight: bold;
            margin-bottom: 10px;
        }
        
        .progress-label {
            font-size: 1.1rem;
            font-weight: 500;
        }
        
        /* Profile Section */
        .profile-form {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: #000000;
        }
        
        .dark-mode .form-group label {
            color: #ffffff;
        }
        
        .required-field {
            color: #ff4444;
        }
        
        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            font-size: 1rem;
            background: #ffffff;
            color: #000000;
            transition: all 0.3s ease;
        }
        
        .dark-mode .form-group input,
        .dark-mode .form-group select,
        .dark-mode .form-group textarea {
            background: #2a2a2a;
            border-color: #444444;
            color: #ffffff;
        }
        
        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: #00ff88;
            box-shadow: 0 0 10px rgba(0,255,136,0.3);
        }
        
        /* Buttons */
        .btn {
            background: #00ff88;
            color: #000000;
            border: none;
            padding: 12px 24px;
            border-radius: 10px;
            font-size: 1rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-block;
            text-align: center;
        }
        
        .btn:hover {
            background: #00cc6a;
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(0,255,136,0.3);
        }
        
        .btn-secondary {
            background: #6c757d;
            color: #ffffff;
        }
        
        .btn-secondary:hover {
            background: #5a6268;
        }
        
        .btn-success {
            background: #28a745;
            color: #ffffff;
        }
        
        .btn-success:hover {
            background: #218838;
        }
        
        /* Documents Section */
        .documents-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 20px;
        }
        
        .document-card {
            background: #ffffff;
            border: 1px solid #e0e0e0;
            border-radius: 15px;
            padding: 25px;
            transition: all 0.3s ease;
            position: relative;
        }
        
        .dark-mode .document-card {
            background: #1a1a1a;
            border-color: #333333;
        }
        
        .document-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.15);
        }
        
        .document-status {
            position: absolute;
            top: 15px;
            right: 15px;
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 500;
        }
        
        .status-pending {
            background: #fff3cd;
            color: #856404;
        }
        
        .status-in-progress {
            background: #d1ecf1;
            color: #0c5460;
        }
        
        .status-completed {
            background: #d4edda;
            color: #155724;
        }
        
        .document-title {
            font-size: 1.3rem;
            font-weight: bold;
            margin-bottom: 10px;
            color: #000000;
        }
        
        .dark-mode .document-title {
            color: #ffffff;
        }
        
        .document-description {
            color: #666666;
            margin-bottom: 20px;
            line-height: 1.5;
        }
        
        .dark-mode .document-description {
            color: #cccccc;
        }
        
        .document-actions {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }
        
        .document-actions .btn {
            flex: 1;
            min-width: 80px;
            padding: 8px 16px;
            font-size: 0.9rem;
        }
        
        /* Chat Section */
        .chat-container {
            display: flex;
            flex-direction: column;
            height: 600px;
            border: 1px solid #e0e0e0;
            border-radius: 15px;
            overflow: hidden;
        }
        
        .dark-mode .chat-container {
            border-color: #333333;
        }
        
        .chat-messages {
            flex: 1;
            padding: 20px;
            overflow-y: auto;
            background: #f8f9fa;
        }
        
        .dark-mode .chat-messages {
            background: #2a2a2a;
        }
        
        .message {
            margin-bottom: 15px;
            padding: 12px 16px;
            border-radius: 15px;
            max-width: 80%;
            word-wrap: break-word;
        }
        
        .message.user {
            background: #00ff88;
            color: #000000;
            margin-left: auto;
            text-align: right;
        }
        
        .message.ai {
            background: #ffffff;
            color: #000000;
            border: 1px solid #e0e0e0;
        }
        
        .dark-mode .message.ai {
            background: #1a1a1a;
            color: #ffffff;
            border-color: #333333;
        }
        
        .message.typing {
            background: #e5e5e5;
            color: #666666;
        }
        
        .dark-mode .message.typing {
            background: #333333;
            color: #999999;
        }
        
        .typing-dots {
            display: flex;
            gap: 4px;
            align-items: center;
        }
        
        .typing-dots span {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: #666666;
            animation: typing 1.4s infinite ease-in-out;
        }
        
        .dark-mode .typing-dots span {
            background: #999999;
        }
        
        .typing-dots span:nth-child(1) {
            animation-delay: -0.32s;
        }
        
        .typing-dots span:nth-child(2) {
            animation-delay: -0.16s;
        }
        
        @keyframes typing {
            0%, 80%, 100% {
                transform: scale(0);
                opacity: 0.5;
            }
            40% {
                transform: scale(1);
                opacity: 1;
            }
        }
        
        .chat-input-container {
            padding: 20px;
            background: #ffffff;
            border-top: 1px solid #e0e0e0;
            display: flex;
            gap: 10px;
        }
        
        .dark-mode .chat-input-container {
            background: #1a1a1a;
            border-top-color: #333333;
        }
        
        .chat-input {
            flex: 1;
            padding: 12px 15px;
            border: 2px solid #e0e0e0;
            border-radius: 25px;
            font-size: 1rem;
            background: #ffffff;
            color: #000000;
        }
        
        .dark-mode .chat-input {
            background: #2a2a2a;
            border-color: #444444;
            color: #ffffff;
        }
        
        .chat-input:focus {
            outline: none;
            border-color: #00ff88;
        }
        
        .voice-btn {
            background: #ff6b6b;
            color: #ffffff;
            border: none;
            padding: 12px;
            border-radius: 50%;
            cursor: pointer;
            transition: all 0.3s ease;
            width: 45px;
            height: 45px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .voice-btn:hover {
            background: #ff5252;
            transform: scale(1.1);
        }
        
        .voice-btn.recording {
            background: #ff4444;
            animation: pulse 1s infinite;
        }
        
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }
        
        .send-btn {
            background: #00ff88;
            color: #000000;
            border: none;
            padding: 12px 20px;
            border-radius: 25px;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.3s ease;
        }
        
        .send-btn:hover {
            background: #00cc6a;
            transform: translateY(-1px);
        }
        
        /* Pathway Selection */
        .pathway-selection {
            margin-bottom: 30px;
        }
        
        .pathway-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        
        .pathway-card {
            background: #ffffff;
            border: 2px solid #e0e0e0;
            border-radius: 15px;
            padding: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
        }
        
        .dark-mode .pathway-card {
            background: #1a1a1a;
            border-color: #333333;
        }
        
        .pathway-card:hover {
            border-color: #00ff88;
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(0,255,136,0.1);
        }
        
        .pathway-card.selected {
            border-color: #00ff88;
            background: #f0fff4;
        }
        
        .dark-mode .pathway-card.selected {
            background: #0d1b0d;
        }
        
        .pathway-name {
            font-size: 1.3rem;
            font-weight: bold;
            margin-bottom: 10px;
            color: #000000;
        }
        
        .dark-mode .pathway-name {
            color: #ffffff;
        }
        
        .pathway-description {
            color: #666666;
            margin-bottom: 15px;
            line-height: 1.5;
        }
        
        .dark-mode .pathway-description {
            color: #cccccc;
        }
        
        .pathway-status {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.9rem;
            font-weight: 500;
            margin-bottom: 10px;
        }
        
        .pathway-status.available {
            background: #d4edda;
            color: #155724;
        }
        
        .pathway-status.limited {
            background: #fff3cd;
            color: #856404;
        }
        
        .pathway-status.restricted {
            background: #f8d7da;
            color: #721c24;
        }
        
        .pathway-details {
            background: #ffffff;
            border: 1px solid #e0e0e0;
            border-radius: 15px;
            padding: 25px;
            margin-top: 20px;
        }
        
        .dark-mode .pathway-details {
            background: #1a1a1a;
            border-color: #333333;
        }
        
        .pathway-info {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }
        
        .info-item {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 10px;
            border-left: 4px solid #00ff88;
        }
        
        .dark-mode .info-item {
            background: #2a2a2a;
        }
        
        .info-item strong {
            color: #00ff88;
            display: block;
            margin-bottom: 5px;
        }
        
        .info-item span {
            color: #666666;
            line-height: 1.5;
        }
        
        .dark-mode .info-item span {
            color: #cccccc;
        }

        /* Help Resources */
        .help-resources {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
        }
        
        .resource-card {
            background: #ffffff;
            border: 1px solid #e0e0e0;
            border-radius: 15px;
            padding: 20px;
            transition: all 0.3s ease;
        }
        
        .dark-mode .resource-card {
            background: #1a1a1a;
            border-color: #333333;
        }
        
        .resource-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 20px rgba(0,0,0,0.1);
        }
        
        .resource-name {
            font-size: 1.2rem;
            font-weight: bold;
            margin-bottom: 8px;
            color: #000000;
        }
        
        .dark-mode .resource-name {
            color: #ffffff;
        }
        
        .resource-type {
            color: #00ff88;
            font-weight: 500;
            margin-bottom: 10px;
        }
        
        .resource-phone {
            margin-bottom: 5px;
            color: #666666;
        }
        
        .dark-mode .resource-phone {
            color: #cccccc;
        }
        
        .resource-website {
            color: #00ff88;
            text-decoration: none;
        }
        
        .resource-website:hover {
            text-decoration: underline;
        }
        
        .service-tag,
        .language-tag {
            display: inline-block;
            background: #e9ecef;
            color: #495057;
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 0.8rem;
            margin: 2px;
        }
        
        .dark-mode .service-tag,
        .dark-mode .language-tag {
            background: #444444;
            color: #ffffff;
        }
        
        /* Modal */
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 2000;
        }
        
        .modal-content {
            background: #ffffff;
            border-radius: 15px;
            width: 90%;
            max-width: 800px;
            max-height: 90vh;
            overflow-y: auto;
            position: relative;
        }
        
        .dark-mode .modal-content {
            background: #1a1a1a;
        }
        
        .modal-header {
            padding: 20px;
            border-bottom: 1px solid #e0e0e0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .dark-mode .modal-header {
            border-bottom-color: #333333;
        }
        
        .modal-header h2 {
            margin: 0;
            color: #000000;
        }
        
        .dark-mode .modal-header h2 {
            color: #ffffff;
        }
        
        .close-btn {
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: #666666;
            padding: 5px;
        }
        
        .dark-mode .close-btn {
            color: #cccccc;
        }
        
        .close-btn:hover {
            color: #ff4444;
        }
        
        .modal-body {
            padding: 20px;
        }
        
        .modal-footer {
            padding: 20px;
            border-top: 1px solid #e0e0e0;
            display: flex;
            gap: 10px;
            justify-content: flex-end;
        }
        
        .dark-mode .modal-footer {
            border-top-color: #333333;
        }
        
        /* Form Styles */
        .immigration-form {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
        }
        
        .form-header {
            grid-column: 1 / -1;
            text-align: center;
            margin-bottom: 20px;
        }
        
        .form-header h3 {
            font-size: 1.5rem;
            margin-bottom: 10px;
            color: #000000;
        }
        
        .dark-mode .form-header h3 {
            color: #ffffff;
        }
        
        .form-description {
            color: #666666;
            font-size: 1rem;
        }
        
        .dark-mode .form-description {
            color: #cccccc;
        }
        
        /* Responsive Design */
        @media (max-width: 768px) {
            .nav-bar {
                flex-direction: column;
                gap: 15px;
            }
            
            .nav-tabs {
                justify-content: center;
            }
            
            .nav-tab {
                font-size: 0.9rem;
                padding: 10px 15px;
            }
            
            .main-container {
                padding: 15px;
            }
            
            .section-title {
                font-size: 1.5rem;
            }
            
            .progress-container {
                grid-template-columns: 1fr;
            }
            
            .profile-form {
                grid-template-columns: 1fr;
            }
            
            .documents-grid {
                grid-template-columns: 1fr;
            }
            
            .help-resources {
                grid-template-columns: 1fr;
            }
            
            .chat-container {
                height: 500px;
            }
            
            .modal-content {
                width: 95%;
                margin: 10px;
            }
            
            .immigration-form {
                grid-template-columns: 1fr;
            }
        }
        
        @media (max-width: 480px) {
            .nav-title {
                font-size: 1.5rem;
            }
            
            .nav-tab {
                font-size: 0.8rem;
                padding: 8px 12px;
            }
            
            .card {
                padding: 20px;
            }
            
            .document-card {
                padding: 20px;
            }
            
            .chat-container {
                height: 400px;
            }
            
            .chat-input-container {
                flex-direction: column;
                gap: 10px;
            }
            
            .chat-input {
                border-radius: 10px;
            }
            
            .send-btn {
                border-radius: 10px;
            }
        }
    </style>
</head>
<body>
    <!-- Navigation Bar -->
    <nav class="nav-bar">
        <div class="nav-title">
            Immigr-<span class="ai-emphasis">Aid</span>
        </div>
        <div class="nav-controls">
            <select id="languageSelect" class="language-selector" onchange="changeLanguage(this.value)">
                <option value="en">English</option>
                <option value="es">Espa√±ol</option>
                <option value="zh">‰∏≠Êñá</option>
                <option value="ar">ÿßŸÑÿπÿ±ÿ®Ÿäÿ©</option>
                <option value="hi">‡§π‡§ø‡§®‡•ç‡§¶‡•Ä</option>
                <option value="pt">Portugu√™s</option>
                <option value="ru">–†—É—Å—Å–∫–∏–π</option>
                <option value="fr">Fran√ßais</option>
            </select>
            <button class="theme-toggle" onclick="toggleTheme()">üåô Dark</button>
        </div>
    </nav>

    <!-- Main Container -->
    <div class="main-container">
        <!-- Main Content -->
        <div class="main-content">
            <!-- Navigation Tabs -->
            <div class="nav-tabs">
                <a href="#" class="nav-tab active" onclick="showSection('dashboard')" id="dashboardNav">üìä Dashboard</a>
                <a href="#" class="nav-tab" onclick="showSection('profile')" id="profileNav">üë§ Profile</a>
                <a href="#" class="nav-tab" onclick="showSection('documents')" id="documentsNav">üìÑ Documents</a>
                <a href="#" class="nav-tab" onclick="showSection('help')" id="helpNav">üÜò Help Resources</a>
            </div>

            <!-- Dashboard Section -->
            <div id="dashboardSection" class="content-section active">
                <h1 class="section-title" id="dashboardTitle">Dashboard - Immigr-Aid</h1>
                
                <!-- Progress Cards -->
                <div class="progress-container">
                    <div class="progress-card">
                        <div class="progress-number" id="completedCount">0</div>
                        <div class="progress-label" id="completedLabel">Completed</div>
                    </div>
                    <div class="progress-card">
                        <div class="progress-number" id="remainingCount">3</div>
                        <div class="progress-label" id="remainingLabel">Remaining</div>
                    </div>
                </div>

                <!-- Profile Completion Card -->
                <div class="card">
                    <h2 id="profileTitle">Personal Information</h2>
                    <p id="profileDescription">Complete your profile to enable AI assistance with form filling and personalized guidance.</p>
                    <div style="margin-top: 15px;">
                        <button class="btn" onclick="showSection('profile')" id="completeProfileBtn">Complete Profile</button>
                    </div>
                </div>

                <!-- Documents Overview -->
                <div class="card">
                    <h2 id="documentsTitle">Required Documents</h2>
                    <p id="documentsDescription">All documents needed to complete your immigration application process</p>
                    <div id="documentsPreview" class="documents-grid" style="margin-top: 20px;">
                        <!-- Documents will be populated here -->
                    </div>
                </div>
            </div>

            <!-- Profile Section -->
            <div id="profileSection" class="content-section">
                <h1 class="section-title" id="profileSectionTitle">Personal Information</h1>
                <div class="card">
                    <form class="profile-form" id="profileForm">
                        <div class="form-group">
                            <label for="firstName" id="firstNameLabel">First Name *</label>
                            <input type="text" id="firstName" name="firstName" required>
                        </div>
                        <div class="form-group">
                            <label for="lastName" id="lastNameLabel">Last Name *</label>
                            <input type="text" id="lastName" name="lastName" required>
                        </div>
                        <div class="form-group">
                            <label for="middleName" id="middleNameLabel">Middle Name</label>
                            <input type="text" id="middleName" name="middleName">
                        </div>
                        <div class="form-group">
                            <label for="dateOfBirth" id="dateOfBirthLabel">Date of Birth *</label>
                            <input type="date" id="dateOfBirth" name="dateOfBirth" required>
                        </div>
                        <div class="form-group">
                            <label for="countryOfBirth" id="countryOfBirthLabel">Country of Birth *</label>
                            <select id="countryOfBirth" name="countryOfBirth" required>
                                <option value="">Select Country</option>
                                <option value="Mexico">Mexico</option>
                                <option value="China">China</option>
                                <option value="India">India</option>
                                <option value="Philippines">Philippines</option>
                                <option value="El Salvador">El Salvador</option>
                                <option value="Guatemala">Guatemala</option>
                                <option value="Honduras">Honduras</option>
                                <option value="Cuba">Cuba</option>
                                <option value="Dominican Republic">Dominican Republic</option>
                                <option value="Colombia">Colombia</option>
                                <option value="Venezuela">Venezuela</option>
                                <option value="Brazil">Brazil</option>
                                <option value="Argentina">Argentina</option>
                                <option value="Peru">Peru</option>
                                <option value="Ecuador">Ecuador</option>
                                <option value="Bolivia">Bolivia</option>
                                <option value="Chile">Chile</option>
                                <option value="Uruguay">Uruguay</option>
                                <option value="Paraguay">Paraguay</option>
                                <option value="Other">Other</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="currentAddress" id="currentAddressLabel">Current Address *</label>
                            <textarea id="currentAddress" name="currentAddress" rows="3" required></textarea>
                        </div>
                        <div class="form-group">
                            <label for="phoneNumber" id="phoneNumberLabel">Phone Number *</label>
                            <input type="tel" id="phoneNumber" name="phoneNumber" required>
                        </div>
                        <div class="form-group">
                            <label for="emailAddress" id="emailAddressLabel">Email Address *</label>
                            <input type="email" id="emailAddress" name="emailAddress" required>
                        </div>
                        <div class="form-group">
                            <label for="socialSecurityNumber" id="socialSecurityNumberLabel">Social Security Number</label>
                            <input type="text" id="socialSecurityNumber" name="socialSecurityNumber">
                        </div>
                        <div class="form-group">
                            <label for="entryDate" id="entryDateLabel">Entry Date to US *</label>
                            <input type="date" id="entryDate" name="entryDate" required>
                        </div>
                        <div class="form-group">
                            <label for="methodOfEntry" id="methodOfEntryLabel">Method of Entry *</label>
                            <select id="methodOfEntry" name="methodOfEntry" required>
                                <option value="">Select Method</option>
                                <option value="Visa">Visa</option>
                                <option value="Border Crossing">Border Crossing</option>
                                <option value="Airport">Airport</option>
                                <option value="Other">Other</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="educationLevel" id="educationLevelLabel">Education Level *</label>
                            <select id="educationLevel" name="educationLevel" required>
                                <option value="">Select Education Level</option>
                                <option value="Elementary">Elementary School</option>
                                <option value="Middle School">Middle School</option>
                                <option value="High School">High School</option>
                                <option value="Some College">Some College</option>
                                <option value="Associate Degree">Associate Degree</option>
                                <option value="Bachelor Degree">Bachelor Degree</option>
                                <option value="Master Degree">Master Degree</option>
                                <option value="Doctorate">Doctorate</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="employmentStatus" id="employmentStatusLabel">Employment Status *</label>
                            <select id="employmentStatus" name="employmentStatus" required>
                                <option value="">Select Status</option>
                                <option value="Employed">Employed</option>
                                <option value="Unemployed">Unemployed</option>
                                <option value="Student">Student</option>
                                <option value="Self-Employed">Self-Employed</option>
                                <option value="Retired">Retired</option>
                                <option value="Other">Other</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="criminalHistory" id="criminalHistoryLabel">Criminal History *</label>
                            <select id="criminalHistory" name="criminalHistory" required>
                                <option value="">Select Status</option>
                                <option value="None">No Criminal History</option>
                                <option value="Minor">Minor Offenses</option>
                                <option value="Major">Major Offenses</option>
                            </select>
                        </div>
                        <div class="form-group" style="grid-column: 1 / -1;">
                            <button type="button" class="btn" onclick="saveProfile()" id="saveProfileBtn">Save Profile Information</button>
                        </div>
                    </form>
                </div>
            </div>

            <!-- Documents Section -->
            <div id="documentsSection" class="content-section">
                <h1 class="section-title" id="documentsSectionTitle">Immigration Pathway Selection</h1>
                <p id="documentsDescription">Select what you are applying for to see all required forms for your specific immigration process</p>
                
                <!-- Pathway Selection -->
                <div class="pathway-selection">
                    <h3>What are you applying for?</h3>
                    <div class="pathway-grid" id="pathwayGrid">
                        <!-- Pathways will be populated by JavaScript -->
                    </div>
                </div>
                
                <!-- Selected Pathway Details -->
                <div class="pathway-details" id="pathwayDetails" style="display: none;">
                    <h3 id="selectedPathwayName">Selected Pathway</h3>
                    <p id="selectedPathwayDescription">Description</p>
                    <div class="pathway-info">
                        <div class="info-item">
                            <strong>Status:</strong> <span id="pathwayStatus"></span>
                        </div>
                        <div class="info-item">
                            <strong>Eligibility:</strong> <span id="pathwayEligibility"></span>
                        </div>
                        <div class="info-item">
                            <strong>Risks:</strong> <span id="pathwayRisks"></span>
                        </div>
                    </div>
                    
                    <h4>Required Forms for This Process:</h4>
                    <div id="requiredFormsContainer" class="documents-grid"></div>
                </div>
            </div>

            <!-- Help Resources Section -->
            <div id="helpSection" class="content-section">
                <h1 class="section-title" id="helpTitle">Help Resources & Locations</h1>
                <div class="help-resources">
                    <div>
                        <h3 id="emergencyResources">Emergency Resources</h3>
                        <div id="emergencyResourcesContainer">
                            <!-- Emergency resources will be populated here -->
                        </div>
                    </div>
                    <div>
                        <h3 id="legalAid">Legal Aid</h3>
                        <div id="legalAidContainer">
                            <!-- Legal aid resources will be populated here -->
                        </div>
                    </div>
                    <div>
                        <h3 id="communityCenters">Community Centers</h3>
                        <div id="communityCentersContainer">
                            <!-- Community centers will be populated here -->
                        </div>
                    </div>
                    <div>
                        <h3 id="healthcareResources">Healthcare</h3>
                        <div id="healthcareResourcesContainer">
                            <!-- Healthcare resources will be populated here -->
                        </div>
                    </div>
                    <div>
                        <h3 id="employmentResources">Employment</h3>
                        <div id="employmentResourcesContainer">
                            <!-- Employment resources will be populated here -->
                        </div>
                    </div>
                    <div>
                        <h3 id="educationalResources">Educational Resources</h3>
                        <div id="educationalResourcesContainer">
                            <!-- Educational resources will be populated here -->
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- AI Sidebar -->
        <div class="ai-sidebar">
            <div class="ai-sidebar-header">
                <div class="ai-sidebar-title">ü§ñ AI Assistant</div>
            </div>
            <div class="ai-sidebar-subtitle" id="aiSidebarSubtitle">I'm here to help you with your immigration forms and questions. Ask me anything!</div>
            
            <div class="ai-sidebar-chat" id="aiSidebarChat">
                <div class="ai-sidebar-message ai" id="aiSidebarWelcome">
                    <div id="aiSidebarWelcomeMessage">Hello! I'm your AI immigration assistant. I can help you fill out forms, answer questions about your immigration process, and guide you through each step. How can I assist you today?</div>
                </div>
            </div>
            
            <div class="ai-sidebar-input">
                <input type="text" id="aiSidebarInput" placeholder="Ask me anything..." onkeypress="handleSidebarKeyPress(event)">
                <button class="ai-sidebar-voice-btn" id="aiSidebarVoiceBtn" onclick="toggleSidebarVoiceRecording()" title="Voice Input">üé§</button>
                <button class="ai-sidebar-upload-btn" onclick="uploadDocument()" title="Upload Document">üìÑ</button>
                <button class="ai-sidebar-send-btn" onclick="sendSidebarMessage()">Send</button>
            </div>
            <input type="file" id="documentUpload" accept=".txt,.pdf,.doc,.docx" style="display: none;" onchange="handleDocumentUpload(event)">
        </div>
    </div>

    <script>
        // Global variables
        let currentLanguage = 'en';
        let currentSection = 'dashboard';
        let userProfile = {};
        let profileComplete = false;
        let chatHistory = [];
        let currentChatId = null;
        let recognition = null;
        let isRecording = false;

        // Initialize the application
        document.addEventListener('DOMContentLoaded', function() {
            initializeApp();
        });

        function initializeApp() {
            // Load saved preferences
            loadPreferences();
            
            // Initialize speech recognition
            initializeSpeechRecognition();
            
            // Populate initial content
            populateDocuments();
            populateHelpResources();
            updateProgress();
            updateChatHistory();
            
            // Set initial language
            updateLanguage();
        }

        function loadPreferences() {
            // Load language preference
            const savedLanguage = localStorage.getItem('language');
            if (savedLanguage) {
                currentLanguage = savedLanguage;
                document.getElementById('languageSelect').value = currentLanguage;
            }
            
            // Load theme preference
            const savedTheme = localStorage.getItem('theme');
            if (savedTheme === 'dark') {
                document.body.classList.add('dark-mode');
                document.querySelector('.theme-toggle').textContent = '‚òÄÔ∏è Light';
            }
            
            // Load profile data
            const savedProfile = localStorage.getItem('profileData');
            if (savedProfile) {
                userProfile = JSON.parse(savedProfile);
                profileComplete = true;
                populateProfileForm();
            }
            
            // Load chat history
            const savedChatHistory = localStorage.getItem('chatHistory');
            if (savedChatHistory) {
                chatHistory = JSON.parse(savedChatHistory);
            }
        }

        function savePreferences() {
            localStorage.setItem('language', currentLanguage);
            localStorage.setItem('theme', document.body.classList.contains('dark-mode') ? 'dark' : 'light');
            localStorage.setItem('profileData', JSON.stringify(userProfile));
            localStorage.setItem('chatHistory', JSON.stringify(chatHistory));
        }

        // Language and Theme Functions
        function changeLanguage(language) {
            currentLanguage = language;
            updateLanguage();
            updateAILanguage();
            savePreferences();
        }

        function updateAILanguage() {
            // Update AI system prompt language
            if (immigrationLLM) {
                immigrationLLM.currentLanguage = currentLanguage;
            }
            
            // Update speech recognition language
            if (recognition) {
                const languageMap = {
                    'en': 'en-US',
                    'es': 'es-ES', 
                    'zh': 'zh-CN',
                    'ar': 'ar-SA',
                    'hi': 'hi-IN',
                    'pt': 'pt-BR',
                    'ru': 'ru-RU',
                    'fr': 'fr-FR'
                };
                recognition.lang = languageMap[currentLanguage] || 'en-US';
            }
        }

        function toggleTheme() {
            document.body.classList.toggle('dark-mode');
            const themeBtn = document.querySelector('.theme-toggle');
            if (document.body.classList.contains('dark-mode')) {
                themeBtn.textContent = '‚òÄÔ∏è Light';
            } else {
                themeBtn.textContent = 'üåô Dark';
            }
            savePreferences();
        }

        // Navigation Functions
        function showSection(sectionName) {
            // Hide all sections
            document.querySelectorAll('.content-section').forEach(section => {
                section.classList.remove('active');
            });
            
            // Remove active class from all tabs
            document.querySelectorAll('.nav-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // Show selected section
            document.getElementById(sectionName + 'Section').classList.add('active');
            
            // Add active class to selected tab
            event.target.classList.add('active');
            
            currentSection = sectionName;
        }

        // Profile Functions
        function saveProfile() {
            const form = document.getElementById('profileForm');
            const formData = new FormData(form);
            
            userProfile = {};
            for (let [key, value] of formData.entries()) {
                userProfile[key] = value;
            }
            
            profileComplete = true;
            savePreferences();
            updateProgress();
            
            // Show success message
            alert('Profile saved successfully!');
        }

        function populateProfileForm() {
            if (userProfile && Object.keys(userProfile).length > 0) {
                Object.keys(userProfile).forEach(key => {
                    const element = document.getElementById(key);
                    if (element) {
                        element.value = userProfile[key];
                    }
                });
            }
        }

        // Immigration Pathways and Required Forms
        const immigrationPathways = {
            'daca': {
                name: 'DACA (Deferred Action for Childhood Arrivals)',
                description: 'For undocumented individuals who came to the US as children',
                status: 'Currently limited due to court rulings',
                requiredForms: [
                    { id: 'i-821d', name: 'Form I-821D - DACA Application', priority: 'high', status: 'pending' },
                    { id: 'i-765', name: 'Form I-765 - Employment Authorization', priority: 'high', status: 'pending' },
                    { id: 'i-131', name: 'Form I-131 - Advance Parole (if needed)', priority: 'medium', status: 'pending' },
                    { id: 'g-1145', name: 'Form G-1145 - E-Notification', priority: 'low', status: 'pending' }
                ],
                eligibility: 'Arrived before age 16, continuous residence since 2007, education/military requirements',
                risks: 'No permanent status, subject to policy changes'
            },
            'asylum': {
                name: 'Asylum',
                description: 'For individuals fleeing persecution in their home country',
                status: 'Available for those with credible fear',
                requiredForms: [
                    { id: 'i-589', name: 'Form I-589 - Asylum Application', priority: 'high', status: 'pending' },
                    { id: 'i-765', name: 'Form I-765 - Employment Authorization (after 150 days)', priority: 'high', status: 'pending' },
                    { id: 'i-131', name: 'Form I-131 - Refugee Travel Document', priority: 'medium', status: 'pending' },
                    { id: 'g-1145', name: 'Form G-1145 - E-Notification', priority: 'low', status: 'pending' }
                ],
                eligibility: 'Fear of persecution based on race, religion, nationality, political opinion, or membership in social group',
                risks: 'Must prove persecution, strict deadlines, potential detention'
            },
            'family_based': {
                name: 'Family-Based Immigration',
                description: 'For family members of US citizens or lawful permanent residents',
                status: 'Available with varying wait times',
                requiredForms: [
                    { id: 'i-130', name: 'Form I-130 - Petition for Alien Relative', priority: 'high', status: 'pending' },
                    { id: 'i-485', name: 'Form I-485 - Adjustment of Status (if in US)', priority: 'high', status: 'pending' },
                    { id: 'i-864', name: 'Form I-864 - Affidavit of Support', priority: 'high', status: 'pending' },
                    { id: 'i-693', name: 'Form I-693 - Medical Examination', priority: 'high', status: 'pending' },
                    { id: 'i-765', name: 'Form I-765 - Employment Authorization', priority: 'medium', status: 'pending' },
                    { id: 'i-131', name: 'Form I-131 - Advance Parole', priority: 'medium', status: 'pending' },
                    { id: 'g-1145', name: 'Form G-1145 - E-Notification', priority: 'low', status: 'pending' }
                ],
                eligibility: 'Immediate relatives (spouse, parent, child under 21) or family preference categories',
                risks: 'Long wait times for some categories, public charge considerations'
            },
            'employment_based': {
                name: 'Employment-Based Immigration',
                description: 'For skilled workers, professionals, and investors',
                status: 'Available with varying wait times',
                requiredForms: [
                    { id: 'i-140', name: 'Form I-140 - Immigrant Petition for Alien Worker', priority: 'high', status: 'pending' },
                    { id: 'i-485', name: 'Form I-485 - Adjustment of Status', priority: 'high', status: 'pending' },
                    { id: 'i-864', name: 'Form I-864 - Affidavit of Support', priority: 'high', status: 'pending' },
                    { id: 'i-693', name: 'Form I-693 - Medical Examination', priority: 'high', status: 'pending' },
                    { id: 'i-765', name: 'Form I-765 - Employment Authorization', priority: 'medium', status: 'pending' },
                    { id: 'i-131', name: 'Form I-131 - Advance Parole', priority: 'medium', status: 'pending' },
                    { id: 'g-1145', name: 'Form G-1145 - E-Notification', priority: 'low', status: 'pending' }
                ],
                eligibility: 'EB-1 (extraordinary ability), EB-2 (advanced degree), EB-3 (skilled workers), EB-5 (investors)',
                risks: 'Labor certification required, strict requirements, long processing times'
            },
            'naturalization': {
                name: 'Naturalization (Citizenship)',
                description: 'For lawful permanent residents seeking US citizenship',
                status: 'Available for eligible LPRs',
                requiredForms: [
                    { id: 'n-400', name: 'Form N-400 - Application for Naturalization', priority: 'high', status: 'pending' },
                    { id: 'g-1145', name: 'Form G-1145 - E-Notification', priority: 'low', status: 'pending' }
                ],
                eligibility: '5 years as LPR (3 if married to US citizen), good moral character, English/civics test',
                risks: 'Must maintain good moral character, pass tests, continuous residence requirement'
            },
            'tps': {
                name: 'Temporary Protected Status (TPS)',
                description: 'For nationals of designated countries due to conflict or disaster',
                status: 'Available for designated countries',
                requiredForms: [
                    { id: 'i-821', name: 'Form I-821 - TPS Application', priority: 'high', status: 'pending' },
                    { id: 'i-765', name: 'Form I-765 - Employment Authorization', priority: 'high', status: 'pending' },
                    { id: 'g-1145', name: 'Form G-1145 - E-Notification', priority: 'low', status: 'pending' }
                ],
                eligibility: 'National of designated country, continuous residence, no serious criminal record',
                risks: 'Temporary status only, subject to country designation changes'
            },
            'u_visa': {
                name: 'U-Visa (Crime Victims)',
                description: 'For victims of certain crimes who cooperate with law enforcement',
                status: 'Available with annual cap',
                requiredForms: [
                    { id: 'i-918', name: 'Form I-918 - U-Visa Application', priority: 'high', status: 'pending' },
                    { id: 'i-765', name: 'Form I-765 - Employment Authorization', priority: 'high', status: 'pending' },
                    { id: 'g-1145', name: 'Form G-1145 - E-Notification', priority: 'low', status: 'pending' }
                ],
                eligibility: 'Victim of qualifying crime, cooperation with law enforcement, suffered substantial harm',
                risks: 'Annual cap limits, must prove cooperation, strict requirements'
            },
            't_visa': {
                name: 'T-Visa (Human Trafficking Victims)',
                description: 'For victims of human trafficking',
                status: 'Available with annual cap',
                requiredForms: [
                    { id: 'i-914', name: 'Form I-914 - T-Visa Application', priority: 'high', status: 'pending' },
                    { id: 'i-765', name: 'Form I-765 - Employment Authorization', priority: 'high', status: 'pending' },
                    { id: 'g-1145', name: 'Form G-1145 - E-Notification', priority: 'low', status: 'pending' }
                ],
                eligibility: 'Victim of severe trafficking, cooperation with law enforcement, extreme hardship if removed',
                risks: 'Annual cap limits, must prove trafficking, strict requirements'
            },
            'si_js': {
                name: 'Special Immigrant Juvenile Status (SIJS)',
                description: 'For children who have been abused, neglected, or abandoned',
                status: 'Available for eligible children',
                requiredForms: [
                    { id: 'i-360', name: 'Form I-360 - Special Immigrant Petition', priority: 'high', status: 'pending' },
                    { id: 'i-485', name: 'Form I-485 - Adjustment of Status', priority: 'high', status: 'pending' },
                    { id: 'i-693', name: 'Form I-693 - Medical Examination', priority: 'high', status: 'pending' },
                    { id: 'i-765', name: 'Form I-765 - Employment Authorization', priority: 'medium', status: 'pending' },
                    { id: 'g-1145', name: 'Form G-1145 - E-Notification', priority: 'low', status: 'pending' }
                ],
                eligibility: 'Under 21, unmarried, court finding of abuse/neglect/abandonment, not in best interest to return',
                risks: 'Must be under 21, complex court process, strict requirements'
            },
            'va_wa': {
                name: 'VAWA (Violence Against Women Act)',
                description: 'For victims of domestic violence by US citizen/LPR spouse/parent',
                status: 'Available for eligible victims',
                requiredForms: [
                    { id: 'i-360', name: 'Form I-360 - VAWA Self-Petition', priority: 'high', status: 'pending' },
                    { id: 'i-485', name: 'Form I-485 - Adjustment of Status', priority: 'high', status: 'pending' },
                    { id: 'i-693', name: 'Form I-693 - Medical Examination', priority: 'high', status: 'pending' },
                    { id: 'i-765', name: 'Form I-765 - Employment Authorization', priority: 'medium', status: 'pending' },
                    { id: 'g-1145', name: 'Form G-1145 - E-Notification', priority: 'low', status: 'pending' }
                ],
                eligibility: 'Victim of battery/extreme cruelty by US citizen/LPR spouse/parent, good moral character',
                risks: 'Must prove abuse, strict evidence requirements, complex process'
            },
            'waivers': {
                name: 'Waivers of Inadmissibility',
                description: 'For individuals with grounds of inadmissibility seeking immigration relief',
                status: 'Available for qualifying individuals',
                requiredForms: [
                    { id: 'i-601', name: 'Form I-601 - Waiver of Grounds of Inadmissibility', priority: 'high', status: 'pending' },
                    { id: 'i-601a', name: 'Form I-601A - Provisional Unlawful Presence Waiver', priority: 'high', status: 'pending' },
                    { id: 'i-212', name: 'Form I-212 - Application for Permission to Reapply', priority: 'high', status: 'pending' },
                    { id: 'g-1145', name: 'Form G-1145 - E-Notification', priority: 'low', status: 'pending' }
                ],
                eligibility: 'Qualifying relative (US citizen/LPR spouse/parent), extreme hardship, good moral character',
                risks: 'High denial rates, strict hardship requirements, complex evidence'
            },
            'removal_defense': {
                name: 'Removal Defense',
                description: 'For individuals in removal proceedings seeking relief',
                status: 'Available for those in proceedings',
                requiredForms: [
                    { id: 'i-589', name: 'Form I-589 - Asylum Application', priority: 'high', status: 'pending' },
                    { id: 'i-360', name: 'Form I-360 - Special Immigrant Petition', priority: 'high', status: 'pending' },
                    { id: 'i-601', name: 'Form I-601 - Waiver Application', priority: 'high', status: 'pending' },
                    { id: 'i-765', name: 'Form I-765 - Employment Authorization', priority: 'medium', status: 'pending' },
                    { id: 'g-1145', name: 'Form G-1145 - E-Notification', priority: 'low', status: 'pending' }
                ],
                eligibility: 'Various forms of relief available in removal proceedings',
                risks: 'Must appear in immigration court, strict deadlines, high stakes'
            }
        };

        // Pathway Selection Functions
        function populatePathways() {
            const pathwayGrid = document.getElementById('pathwayGrid');
            if (!pathwayGrid) return;
            
            pathwayGrid.innerHTML = '';
            
            Object.keys(immigrationPathways).forEach(pathwayKey => {
                const pathway = immigrationPathways[pathwayKey];
                const pathwayCard = createPathwayCard(pathwayKey, pathway);
                pathwayGrid.appendChild(pathwayCard);
            });
        }
        
        function createPathwayCard(pathwayKey, pathway) {
            const card = document.createElement('div');
            card.className = 'pathway-card';
            card.onclick = () => selectPathway(pathwayKey);
            
            let statusClass = 'available';
            if (pathway.status.includes('limited') || pathway.status.includes('court')) {
                statusClass = 'limited';
            } else if (pathway.status.includes('cap') || pathway.status.includes('restricted')) {
                statusClass = 'restricted';
            }
            
            card.innerHTML = `
                <div class="pathway-name">${pathway.name}</div>
                <div class="pathway-description">${pathway.description}</div>
                <div class="pathway-status ${statusClass}">${pathway.status}</div>
            `;
            
            return card;
        }
        
        function selectPathway(pathwayKey) {
            const pathway = immigrationPathways[pathwayKey];
            if (!pathway) return;
            
            // Remove selected class from all cards
            document.querySelectorAll('.pathway-card').forEach(card => {
                card.classList.remove('selected');
            });
            
            // Add selected class to clicked card
            event.currentTarget.classList.add('selected');
            
            // Show pathway details
            const pathwayDetails = document.getElementById('pathwayDetails');
            const selectedPathwayName = document.getElementById('selectedPathwayName');
            const selectedPathwayDescription = document.getElementById('selectedPathwayDescription');
            const pathwayStatus = document.getElementById('pathwayStatus');
            const pathwayEligibility = document.getElementById('pathwayEligibility');
            const pathwayRisks = document.getElementById('pathwayRisks');
            const requiredFormsContainer = document.getElementById('requiredFormsContainer');
            
            selectedPathwayName.textContent = pathway.name;
            selectedPathwayDescription.textContent = pathway.description;
            pathwayStatus.textContent = pathway.status;
            pathwayEligibility.textContent = pathway.eligibility;
            pathwayRisks.textContent = pathway.risks;
            
            // Populate required forms
            requiredFormsContainer.innerHTML = '';
            pathway.requiredForms.forEach(form => {
                const formCard = createFormCard(form);
                requiredFormsContainer.appendChild(formCard);
            });
            
            pathwayDetails.style.display = 'block';
            
            // Scroll to details
            pathwayDetails.scrollIntoView({ behavior: 'smooth' });
        }
        
        function createFormCard(form) {
            const card = document.createElement('div');
            card.className = 'document-card';
            
            const priorityClass = `priority-${form.priority}`;
            const statusClass = `status-${form.status}`;
            
            card.innerHTML = `
                <div class="document-status ${statusClass}">${form.status.charAt(0).toUpperCase() + form.status.slice(1)}</div>
                <div class="document-title" data-doc-id="${form.id}">${form.name}</div>
                <div class="document-priority ${priorityClass}">Priority: ${form.priority.charAt(0).toUpperCase() + form.priority.slice(1)}</div>
                <div class="document-actions">
                    <button class="btn btn-secondary" onclick="viewDocument('${form.id}')">View</button>
                    <button class="btn" onclick="fillDocument('${form.id}')">Fill</button>
                    <button class="btn btn-success" onclick="downloadDocument('${form.id}')">Download</button>
                </div>
            `;
            
            return card;
        }

        // Document Functions
        function populateDocuments() {
            const documents = [
                // Family-based Immigration
                {
                    id: 'i-130',
                    name: 'Form I-130 - Petition for Alien Relative',
                    description: 'Petition filed by U.S. citizen or LPR to establish family relationship for immigrant status',
                    status: 'pending',
                    fields: ['petitionerInfo', 'beneficiaryInfo', 'relationshipEvidence', 'supportingDocuments'],
                    category: 'family',
                    priority: 'high',
                    stage: 'family-based'
                },
                {
                    id: 'i-485',
                    name: 'Form I-485 - Adjustment of Status',
                    description: 'Application to register permanent residence or adjust status to lawful permanent resident',
                    status: 'pending',
                    fields: ['personalInfo', 'immigrationHistory', 'familyInfo', 'criminalHistory', 'medicalExam'],
                    category: 'permanent_resident',
                    priority: 'high',
                    stage: 'family-based'
                },
                
                // Employment-based Immigration
                {
                    id: 'i-140',
                    name: 'Form I-140 - Immigrant Petition for Alien Worker',
                    description: 'Petition filed by employer for foreign worker to obtain employment-based immigrant visa',
                    status: 'pending',
                    fields: ['employerInfo', 'workerInfo', 'jobOffer', 'qualifications', 'laborCertification'],
                    category: 'employment',
                    priority: 'high',
                    stage: 'employment-based'
                },
                
                // Naturalization
                {
                    id: 'n-400',
                    name: 'Form N-400 - Application for Naturalization',
                    description: 'Application for lawful permanent residents to become U.S. citizens',
                    status: 'pending',
                    fields: ['personalInfo', 'residenceHistory', 'employmentHistory', 'criminalHistory', 'englishTest', 'civicsTest'],
                    category: 'citizenship',
                    priority: 'high',
                    stage: 'naturalization'
                },
                
                // Maintenance of Status
                {
                    id: 'i-90',
                    name: 'Form I-90 - Application to Replace Permanent Resident Card',
                    description: 'Application for lawful permanent residents to renew or replace their green card',
                    status: 'pending',
                    fields: ['personalInfo', 'cardInfo', 'reasonForReplacement', 'supportingDocuments'],
                    category: 'permanent_resident',
                    priority: 'medium',
                    stage: 'maintenance'
                },
                {
                    id: 'i-751',
                    name: 'Form I-751 - Petition to Remove Conditions on Residence',
                    description: 'Petition for conditional green card holders to remove conditions after 2 years',
                    status: 'pending',
                    fields: ['personalInfo', 'marriageInfo', 'relationshipEvidence', 'supportingDocuments'],
                    category: 'permanent_resident',
                    priority: 'high',
                    stage: 'maintenance'
                },
                
                // Relief and Waivers
                {
                    id: 'i-601',
                    name: 'Form I-601 - Application for Waiver of Grounds of Inadmissibility',
                    description: 'Application for waiver for inadmissible individuals seeking to immigrate',
                    status: 'pending',
                    fields: ['personalInfo', 'inadmissibilityGrounds', 'hardshipEvidence', 'supportingDocuments'],
                    category: 'waiver',
                    priority: 'high',
                    stage: 'relief'
                },
                {
                    id: 'i-821',
                    name: 'Form I-821 - Application for Temporary Protected Status',
                    description: 'Application for nationals of designated countries for TPS due to conflict or disaster',
                    status: 'pending',
                    fields: ['personalInfo', 'countryOfOrigin', 'entryDate', 'supportingDocuments'],
                    category: 'tps',
                    priority: 'high',
                    stage: 'relief'
                },
                
                // Supportive Documents
                {
                    id: 'i-765',
                    name: 'Form I-765 - Application for Employment Authorization Document',
                    description: 'Application for certain non-citizens to request work permission while status is pending',
                    status: 'pending',
                    fields: ['personalInfo', 'immigrationStatus', 'employmentHistory', 'supportingDocuments'],
                    category: 'employment',
                    priority: 'high',
                    stage: 'supportive'
                },
                {
                    id: 'g-1145',
                    name: 'Form G-1145 - E-Notification of Application/Petition Acceptance',
                    description: 'Optional form to request electronic notification when USCIS accepts application',
                    status: 'pending',
                    fields: ['personalInfo', 'contactInfo', 'applicationDetails'],
                    category: 'notification',
                    priority: 'low',
                    stage: 'supportive'
                },
                
                // Additional Important Forms
                {
                    id: 'i-821d',
                    name: 'Form I-821D - DACA Application',
                    description: 'Application for Deferred Action for Childhood Arrivals',
                    status: 'pending',
                    fields: ['personalInfo', 'arrivalInfo', 'educationInfo', 'criminalHistory', 'economicNecessity'],
                    category: 'daca',
                    priority: 'high',
                    stage: 'relief'
                },
                {
                    id: 'i-131',
                    name: 'Form I-131 - Application for Travel Document',
                    description: 'Application for advance parole or refugee travel document',
                    status: 'pending',
                    fields: ['personalInfo', 'travelPurpose', 'travelDates', 'supportingEvidence'],
                    category: 'travel',
                    priority: 'medium',
                    stage: 'supportive'
                },
                {
                    id: 'i-589',
                    name: 'Form I-589 - Application for Asylum and Withholding of Removal',
                    description: 'Application for asylum and withholding of removal',
                    status: 'pending',
                    fields: ['personalInfo', 'asylumReason', 'persecutionDetails', 'supportingEvidence'],
                    category: 'asylum',
                    priority: 'high',
                    stage: 'relief'
                }
            ];
            
            const container = document.getElementById('documentsContainer');
            const previewContainer = document.getElementById('documentsPreview');
            
            if (container) {
                container.innerHTML = '';
                documents.forEach(doc => {
                    const docCard = createDocumentCard(doc);
                    container.appendChild(docCard);
                });
            }
            
            if (previewContainer) {
                previewContainer.innerHTML = '';
                documents.forEach(doc => {
                    const docCard = createDocumentCard(doc, true);
                    previewContainer.appendChild(docCard);
                });
            }
        }

        function createDocumentCard(doc, isPreview = false) {
            const card = document.createElement('div');
            card.className = 'document-card';
            
            const statusClass = `status-${doc.status}`;
            const statusText = doc.status.charAt(0).toUpperCase() + doc.status.slice(1).replace('-', ' ');
            
            card.innerHTML = `
                <div class="document-status ${statusClass}">${statusText}</div>
                <div class="document-title" data-doc-id="${doc.id}">${doc.name}</div>
                <div class="document-description" data-doc-id="${doc.id}">${doc.description}</div>
                <div class="document-actions">
                    <button class="btn btn-secondary" onclick="viewDocument('${doc.id}')">View</button>
                    <button class="btn" onclick="fillDocument('${doc.id}')">Fill</button>
                    <button class="btn btn-success" onclick="downloadDocument('${doc.id}')">Download</button>
                </div>
            `;
            
            return card;
        }

        function viewDocument(docId) {
            const documents = {
                'i-130': {
                    name: 'Form I-130 - Petition for Alien Relative',
                    description: 'Petition filed by U.S. citizen or LPR to establish family relationship for immigrant status',
                    fields: [
                        { id: 'petitionerInfo', label: 'Petitioner Information', type: 'section' },
                        { id: 'petitionerName', label: 'Petitioner Full Name', type: 'text', required: true },
                        { id: 'petitionerCitizenship', label: 'Petitioner Citizenship Status', type: 'select', required: true, options: ['U.S. Citizen', 'Lawful Permanent Resident'] },
                        { id: 'petitionerAddress', label: 'Petitioner Address', type: 'textarea', required: true },
                        { id: 'beneficiaryInfo', label: 'Beneficiary Information', type: 'section' },
                        { id: 'beneficiaryName', label: 'Beneficiary Full Name', type: 'text', required: true },
                        { id: 'beneficiaryBirthDate', label: 'Beneficiary Date of Birth', type: 'date', required: true },
                        { id: 'beneficiaryCountry', label: 'Beneficiary Country of Birth', type: 'select', required: true, options: ['Mexico', 'China', 'India', 'Philippines', 'El Salvador', 'Guatemala', 'Honduras', 'Cuba', 'Dominican Republic', 'Colombia', 'Venezuela', 'Brazil', 'Argentina', 'Peru', 'Ecuador', 'Bolivia', 'Chile', 'Uruguay', 'Paraguay', 'Other'] },
                        { id: 'relationshipInfo', label: 'Relationship Information', type: 'section' },
                        { id: 'relationshipType', label: 'Relationship Type', type: 'select', required: true, options: ['Spouse', 'Parent', 'Child', 'Sibling', 'Other'] },
                        { id: 'marriageDate', label: 'Marriage Date (if applicable)', type: 'date', required: false },
                        { id: 'marriageLocation', label: 'Marriage Location (if applicable)', type: 'text', required: false },
                        { id: 'supportingDocuments', label: 'Supporting Documents', type: 'section' },
                        { id: 'birthCertificate', label: 'Birth Certificate Provided', type: 'checkbox', required: false },
                        { id: 'marriageCertificate', label: 'Marriage Certificate Provided', type: 'checkbox', required: false },
                        { id: 'passportPhotos', label: 'Passport Photos Provided', type: 'checkbox', required: false }
                    ]
                },
                'i-140': {
                    name: 'Form I-140 - Immigrant Petition for Alien Worker',
                    description: 'Petition filed by employer for foreign worker to obtain employment-based immigrant visa',
                    fields: [
                        { id: 'employerInfo', label: 'Employer Information', type: 'section' },
                        { id: 'employerName', label: 'Employer Company Name', type: 'text', required: true },
                        { id: 'employerAddress', label: 'Employer Address', type: 'textarea', required: true },
                        { id: 'employerPhone', label: 'Employer Phone Number', type: 'tel', required: true },
                        { id: 'workerInfo', label: 'Worker Information', type: 'section' },
                        { id: 'workerName', label: 'Worker Full Name', type: 'text', required: true },
                        { id: 'workerBirthDate', label: 'Worker Date of Birth', type: 'date', required: true },
                        { id: 'workerCountry', label: 'Worker Country of Birth', type: 'select', required: true, options: ['Mexico', 'China', 'India', 'Philippines', 'El Salvador', 'Guatemala', 'Honduras', 'Cuba', 'Dominican Republic', 'Colombia', 'Venezuela', 'Brazil', 'Argentina', 'Peru', 'Ecuador', 'Bolivia', 'Chile', 'Uruguay', 'Paraguay', 'Other'] },
                        { id: 'jobOffer', label: 'Job Offer Information', type: 'section' },
                        { id: 'jobTitle', label: 'Job Title', type: 'text', required: true },
                        { id: 'jobDescription', label: 'Job Description', type: 'textarea', required: true },
                        { id: 'salary', label: 'Offered Salary', type: 'number', required: true },
                        { id: 'qualifications', label: 'Worker Qualifications', type: 'section' },
                        { id: 'educationLevel', label: 'Education Level', type: 'select', required: true, options: ['High School', 'Associate Degree', 'Bachelor Degree', 'Master Degree', 'Doctorate', 'Professional Degree'] },
                        { id: 'workExperience', label: 'Years of Work Experience', type: 'number', required: true },
                        { id: 'specialSkills', label: 'Special Skills or Certifications', type: 'textarea', required: false },
                        { id: 'laborCertification', label: 'Labor Certification', type: 'section' },
                        { id: 'laborCertProvided', label: 'Labor Certification Provided', type: 'checkbox', required: true },
                        { id: 'laborCertNumber', label: 'Labor Certification Number', type: 'text', required: false }
                    ]
                },
                'i-485': {
                    name: 'Form I-485 - Adjustment of Status',
                    description: 'Application to register permanent residence or adjust status to lawful permanent resident',
                    fields: [
                        { id: 'personalInfo', label: 'Personal Information', type: 'section' },
                        { id: 'firstName', label: 'First Name', type: 'text', required: true },
                        { id: 'lastName', label: 'Last Name', type: 'text', required: true },
                        { id: 'middleName', label: 'Middle Name', type: 'text', required: false },
                        { id: 'dateOfBirth', label: 'Date of Birth', type: 'date', required: true },
                        { id: 'countryOfBirth', label: 'Country of Birth', type: 'select', required: true, options: ['Mexico', 'China', 'India', 'Philippines', 'El Salvador', 'Guatemala', 'Honduras', 'Cuba', 'Dominican Republic', 'Colombia', 'Venezuela', 'Brazil', 'Argentina', 'Peru', 'Ecuador', 'Bolivia', 'Chile', 'Uruguay', 'Paraguay', 'Other'] },
                        { id: 'currentAddress', label: 'Current Address', type: 'textarea', required: true },
                        { id: 'phoneNumber', label: 'Phone Number', type: 'tel', required: true },
                        { id: 'emailAddress', label: 'Email Address', type: 'email', required: true },
                        { id: 'immigrationHistory', label: 'Immigration History', type: 'section' },
                        { id: 'currentStatus', label: 'Current Immigration Status', type: 'select', required: true, options: ['F-1 Student', 'H-1B Worker', 'L-1 Intracompany Transfer', 'K-1 Fianc√©', 'Other'] },
                        { id: 'entryDate', label: 'Date of Entry to US', type: 'date', required: true },
                        { id: 'entryPort', label: 'Port of Entry', type: 'text', required: true },
                        { id: 'familyInfo', label: 'Family Information', type: 'section' },
                        { id: 'maritalStatus', label: 'Marital Status', type: 'select', required: true, options: ['Single', 'Married', 'Divorced', 'Widowed'] },
                        { id: 'spouseName', label: 'Spouse Name (if married)', type: 'text', required: false },
                        { id: 'childrenCount', label: 'Number of Children', type: 'number', required: false },
                        { id: 'criminalHistory', label: 'Criminal History', type: 'section' },
                        { id: 'criminalRecord', label: 'Criminal Record', type: 'select', required: true, options: ['None', 'Minor Offenses', 'Major Offenses'] },
                        { id: 'criminalDetails', label: 'Criminal Details (if applicable)', type: 'textarea', required: false },
                        { id: 'medicalExam', label: 'Medical Examination', type: 'section' },
                        { id: 'medicalExamCompleted', label: 'Medical Examination Completed', type: 'checkbox', required: true },
                        { id: 'vaccinationRecords', label: 'Vaccination Records Provided', type: 'checkbox', required: true }
                    ]
                },
                'n-400': {
                    name: 'Form N-400 - Application for Naturalization',
                    description: 'Application for lawful permanent residents to become U.S. citizens',
                    fields: [
                        { id: 'personalInfo', label: 'Personal Information', type: 'section' },
                        { id: 'firstName', label: 'First Name', type: 'text', required: true },
                        { id: 'lastName', label: 'Last Name', type: 'text', required: true },
                        { id: 'middleName', label: 'Middle Name', type: 'text', required: false },
                        { id: 'dateOfBirth', label: 'Date of Birth', type: 'date', required: true },
                        { id: 'countryOfBirth', label: 'Country of Birth', type: 'select', required: true, options: ['Mexico', 'China', 'India', 'Philippines', 'El Salvador', 'Guatemala', 'Honduras', 'Cuba', 'Dominican Republic', 'Colombia', 'Venezuela', 'Brazil', 'Argentina', 'Peru', 'Ecuador', 'Bolivia', 'Chile', 'Uruguay', 'Paraguay', 'Other'] },
                        { id: 'currentAddress', label: 'Current Address', type: 'textarea', required: true },
                        { id: 'phoneNumber', label: 'Phone Number', type: 'tel', required: true },
                        { id: 'emailAddress', label: 'Email Address', type: 'email', required: true },
                        { id: 'residenceHistory', label: 'Residence History', type: 'section' },
                        { id: 'greenCardDate', label: 'Green Card Date', type: 'date', required: true },
                        { id: 'greenCardNumber', label: 'Green Card Number', type: 'text', required: true },
                        { id: 'residenceYears', label: 'Years of Permanent Residence', type: 'number', required: true },
                        { id: 'employmentHistory', label: 'Employment History', type: 'section' },
                        { id: 'currentEmployer', label: 'Current Employer', type: 'text', required: false },
                        { id: 'jobTitle', label: 'Job Title', type: 'text', required: false },
                        { id: 'employmentYears', label: 'Years of Employment', type: 'number', required: false },
                        { id: 'criminalHistory', label: 'Criminal History', type: 'section' },
                        { id: 'criminalRecord', label: 'Criminal Record', type: 'select', required: true, options: ['None', 'Minor Offenses', 'Major Offenses'] },
                        { id: 'criminalDetails', label: 'Criminal Details (if applicable)', type: 'textarea', required: false },
                        { id: 'englishTest', label: 'English Language Test', type: 'section' },
                        { id: 'englishProficiency', label: 'English Proficiency Level', type: 'select', required: true, options: ['Native Speaker', 'Fluent', 'Conversational', 'Basic', 'Limited'] },
                        { id: 'educationLevel', label: 'Education Level', type: 'select', required: true, options: ['Elementary', 'Middle School', 'High School', 'Some College', 'Associate Degree', 'Bachelor Degree', 'Master Degree', 'Doctorate'] },
                        { id: 'civicsTest', label: 'Civics Test Preparation', type: 'section' },
                        { id: 'civicsStudy', label: 'Civics Test Study Completed', type: 'checkbox', required: true },
                        { id: 'civicsPractice', label: 'Civics Practice Tests Taken', type: 'number', required: false }
                    ]
                },
                'i-90': {
                    name: 'Form I-90 - Application to Replace Permanent Resident Card',
                    description: 'Application for lawful permanent residents to renew or replace their green card',
                    fields: [
                        { id: 'personalInfo', label: 'Personal Information', type: 'section' },
                        { id: 'firstName', label: 'First Name', type: 'text', required: true },
                        { id: 'lastName', label: 'Last Name', type: 'text', required: true },
                        { id: 'middleName', label: 'Middle Name', type: 'text', required: false },
                        { id: 'dateOfBirth', label: 'Date of Birth', type: 'date', required: true },
                        { id: 'countryOfBirth', label: 'Country of Birth', type: 'select', required: true, options: ['Mexico', 'China', 'India', 'Philippines', 'El Salvador', 'Guatemala', 'Honduras', 'Cuba', 'Dominican Republic', 'Colombia', 'Venezuela', 'Brazil', 'Argentina', 'Peru', 'Ecuador', 'Bolivia', 'Chile', 'Uruguay', 'Paraguay', 'Other'] },
                        { id: 'currentAddress', label: 'Current Address', type: 'textarea', required: true },
                        { id: 'phoneNumber', label: 'Phone Number', type: 'tel', required: true },
                        { id: 'emailAddress', label: 'Email Address', type: 'email', required: true },
                        { id: 'cardInfo', label: 'Current Green Card Information', type: 'section' },
                        { id: 'cardNumber', label: 'Current Green Card Number', type: 'text', required: true },
                        { id: 'cardExpiryDate', label: 'Card Expiry Date', type: 'date', required: true },
                        { id: 'cardIssueDate', label: 'Card Issue Date', type: 'date', required: true },
                        { id: 'reasonForReplacement', label: 'Reason for Replacement', type: 'section' },
                        { id: 'replacementReason', label: 'Reason for Replacement', type: 'select', required: true, options: ['Card Lost', 'Card Stolen', 'Card Damaged', 'Card Expired', 'Name Change', 'Other'] },
                        { id: 'replacementDetails', label: 'Replacement Details', type: 'textarea', required: false },
                        { id: 'supportingDocuments', label: 'Supporting Documents', type: 'section' },
                        { id: 'passportPhotos', label: 'Passport Photos Provided', type: 'checkbox', required: true },
                        { id: 'identityDocument', label: 'Identity Document Provided', type: 'checkbox', required: true },
                        { id: 'policeReport', label: 'Police Report (if stolen)', type: 'checkbox', required: false }
                    ]
                },
                'i-751': {
                    name: 'Form I-751 - Petition to Remove Conditions on Residence',
                    description: 'Petition for conditional green card holders to remove conditions after 2 years',
                    fields: [
                        { id: 'personalInfo', label: 'Personal Information', type: 'section' },
                        { id: 'firstName', label: 'First Name', type: 'text', required: true },
                        { id: 'lastName', label: 'Last Name', type: 'text', required: true },
                        { id: 'middleName', label: 'Middle Name', type: 'text', required: false },
                        { id: 'dateOfBirth', label: 'Date of Birth', type: 'date', required: true },
                        { id: 'countryOfBirth', label: 'Country of Birth', type: 'select', required: true, options: ['Mexico', 'China', 'India', 'Philippines', 'El Salvador', 'Guatemala', 'Honduras', 'Cuba', 'Dominican Republic', 'Colombia', 'Venezuela', 'Brazil', 'Argentina', 'Peru', 'Ecuador', 'Bolivia', 'Chile', 'Uruguay', 'Paraguay', 'Other'] },
                        { id: 'currentAddress', label: 'Current Address', type: 'textarea', required: true },
                        { id: 'phoneNumber', label: 'Phone Number', type: 'tel', required: true },
                        { id: 'emailAddress', label: 'Email Address', type: 'email', required: true },
                        { id: 'marriageInfo', label: 'Marriage Information', type: 'section' },
                        { id: 'spouseName', label: 'Spouse Full Name', type: 'text', required: true },
                        { id: 'marriageDate', label: 'Marriage Date', type: 'date', required: true },
                        { id: 'marriageLocation', label: 'Marriage Location', type: 'text', required: true },
                        { id: 'conditionalCardDate', label: 'Conditional Green Card Date', type: 'date', required: true },
                        { id: 'relationshipEvidence', label: 'Relationship Evidence', type: 'section' },
                        { id: 'jointBankAccount', label: 'Joint Bank Account', type: 'checkbox', required: false },
                        { id: 'jointLease', label: 'Joint Lease/Mortgage', type: 'checkbox', required: false },
                        { id: 'jointTaxReturns', label: 'Joint Tax Returns', type: 'checkbox', required: false },
                        { id: 'childrenBirthCertificates', label: 'Children Birth Certificates', type: 'checkbox', required: false },
                        { id: 'photosTogether', label: 'Photos Together', type: 'checkbox', required: false },
                        { id: 'supportingDocuments', label: 'Supporting Documents', type: 'section' },
                        { id: 'marriageCertificate', label: 'Marriage Certificate', type: 'checkbox', required: true },
                        { id: 'passportPhotos', label: 'Passport Photos', type: 'checkbox', required: true },
                        { id: 'affidavits', label: 'Affidavits from Friends/Family', type: 'checkbox', required: false }
                    ]
                },
                'i-601': {
                    name: 'Form I-601 - Application for Waiver of Grounds of Inadmissibility',
                    description: 'Application for waiver for inadmissible individuals seeking to immigrate',
                    fields: [
                        { id: 'personalInfo', label: 'Personal Information', type: 'section' },
                        { id: 'firstName', label: 'First Name', type: 'text', required: true },
                        { id: 'lastName', label: 'Last Name', type: 'text', required: true },
                        { id: 'middleName', label: 'Middle Name', type: 'text', required: false },
                        { id: 'dateOfBirth', label: 'Date of Birth', type: 'date', required: true },
                        { id: 'countryOfBirth', label: 'Country of Birth', type: 'select', required: true, options: ['Mexico', 'China', 'India', 'Philippines', 'El Salvador', 'Guatemala', 'Honduras', 'Cuba', 'Dominican Republic', 'Colombia', 'Venezuela', 'Brazil', 'Argentina', 'Peru', 'Ecuador', 'Bolivia', 'Chile', 'Uruguay', 'Paraguay', 'Other'] },
                        { id: 'currentAddress', label: 'Current Address', type: 'textarea', required: true },
                        { id: 'phoneNumber', label: 'Phone Number', type: 'tel', required: true },
                        { id: 'emailAddress', label: 'Email Address', type: 'email', required: true },
                        { id: 'inadmissibilityGrounds', label: 'Inadmissibility Grounds', type: 'section' },
                        { id: 'inadmissibilityReason', label: 'Reason for Inadmissibility', type: 'select', required: true, options: ['Health-related', 'Criminal', 'Immigration Violation', 'Fraud', 'Security', 'Other'] },
                        { id: 'inadmissibilityDetails', label: 'Inadmissibility Details', type: 'textarea', required: true },
                        { id: 'hardshipEvidence', label: 'Hardship Evidence', type: 'section' },
                        { id: 'qualifyingRelative', label: 'Qualifying Relative', type: 'text', required: true },
                        { id: 'relationshipToRelative', label: 'Relationship to Qualifying Relative', type: 'select', required: true, options: ['Spouse', 'Parent', 'Child', 'Sibling'] },
                        { id: 'hardshipDescription', label: 'Hardship Description', type: 'textarea', required: true },
                        { id: 'medicalEvidence', label: 'Medical Evidence (if applicable)', type: 'textarea', required: false },
                        { id: 'supportingDocuments', label: 'Supporting Documents', type: 'section' },
                        { id: 'birthCertificate', label: 'Birth Certificate', type: 'checkbox', required: true },
                        { id: 'passportPhotos', label: 'Passport Photos', type: 'checkbox', required: true },
                        { id: 'medicalRecords', label: 'Medical Records (if applicable)', type: 'checkbox', required: false },
                        { id: 'criminalRecords', label: 'Criminal Records (if applicable)', type: 'checkbox', required: false }
                    ]
                },
                'i-821': {
                    name: 'Form I-821 - Application for Temporary Protected Status',
                    description: 'Application for nationals of designated countries for TPS due to conflict or disaster',
                    fields: [
                        { id: 'personalInfo', label: 'Personal Information', type: 'section' },
                        { id: 'firstName', label: 'First Name', type: 'text', required: true },
                        { id: 'lastName', label: 'Last Name', type: 'text', required: true },
                        { id: 'middleName', label: 'Middle Name', type: 'text', required: false },
                        { id: 'dateOfBirth', label: 'Date of Birth', type: 'date', required: true },
                        { id: 'countryOfOrigin', label: 'Country of Origin', type: 'select', required: true, options: ['El Salvador', 'Haiti', 'Honduras', 'Nepal', 'Nicaragua', 'Somalia', 'South Sudan', 'Sudan', 'Syria', 'Venezuela', 'Yemen'] },
                        { id: 'currentAddress', label: 'Current Address', type: 'textarea', required: true },
                        { id: 'phoneNumber', label: 'Phone Number', type: 'tel', required: true },
                        { id: 'emailAddress', label: 'Email Address', type: 'email', required: true },
                        { id: 'entryDate', label: 'Entry Information', type: 'section' },
                        { id: 'entryDateUS', label: 'Date of Entry to US', type: 'date', required: true },
                        { id: 'entryPort', label: 'Port of Entry', type: 'text', required: true },
                        { id: 'lastDepartureDate', label: 'Last Departure Date from TPS Country', type: 'date', required: true },
                        { id: 'supportingDocuments', label: 'Supporting Documents', type: 'section' },
                        { id: 'passport', label: 'Passport from TPS Country', type: 'checkbox', required: true },
                        { id: 'birthCertificate', label: 'Birth Certificate', type: 'checkbox', required: true },
                        { id: 'passportPhotos', label: 'Passport Photos', type: 'checkbox', required: true },
                        { id: 'entryDocument', label: 'Entry Document', type: 'checkbox', required: true }
                    ]
                },
                'i-765': {
                    name: 'Form I-765 - Application for Employment Authorization Document',
                    description: 'Application for certain non-citizens to request work permission while status is pending',
                    fields: [
                        { id: 'personalInfo', label: 'Personal Information', type: 'section' },
                        { id: 'firstName', label: 'First Name', type: 'text', required: true },
                        { id: 'lastName', label: 'Last Name', type: 'text', required: true },
                        { id: 'middleName', label: 'Middle Name', type: 'text', required: false },
                        { id: 'dateOfBirth', label: 'Date of Birth', type: 'date', required: true },
                        { id: 'countryOfBirth', label: 'Country of Birth', type: 'select', required: true, options: ['Mexico', 'China', 'India', 'Philippines', 'El Salvador', 'Guatemala', 'Honduras', 'Cuba', 'Dominican Republic', 'Colombia', 'Venezuela', 'Brazil', 'Argentina', 'Peru', 'Ecuador', 'Bolivia', 'Chile', 'Uruguay', 'Paraguay', 'Other'] },
                        { id: 'currentAddress', label: 'Current Address', type: 'textarea', required: true },
                        { id: 'phoneNumber', label: 'Phone Number', type: 'tel', required: true },
                        { id: 'emailAddress', label: 'Email Address', type: 'email', required: true },
                        { id: 'immigrationStatus', label: 'Immigration Status', type: 'section' },
                        { id: 'currentStatus', label: 'Current Immigration Status', type: 'select', required: true, options: ['F-1 Student', 'H-1B Worker', 'L-1 Intracompany Transfer', 'K-1 Fianc√©', 'Asylum Applicant', 'TPS', 'DACA', 'Other'] },
                        { id: 'statusExpiryDate', label: 'Status Expiry Date', type: 'date', required: false },
                        { id: 'employmentHistory', label: 'Employment History', type: 'section' },
                        { id: 'previousEmployment', label: 'Previous Employment', type: 'textarea', required: false },
                        { id: 'currentEmployer', label: 'Current Employer (if any)', type: 'text', required: false },
                        { id: 'supportingDocuments', label: 'Supporting Documents', type: 'section' },
                        { id: 'passportPhotos', label: 'Passport Photos', type: 'checkbox', required: true },
                        { id: 'identityDocument', label: 'Identity Document', type: 'checkbox', required: true },
                        { id: 'statusDocument', label: 'Immigration Status Document', type: 'checkbox', required: true }
                    ]
                },
                'g-1145': {
                    name: 'Form G-1145 - E-Notification of Application/Petition Acceptance',
                    description: 'Optional form to request electronic notification when USCIS accepts application',
                    fields: [
                        { id: 'personalInfo', label: 'Personal Information', type: 'section' },
                        { id: 'firstName', label: 'First Name', type: 'text', required: true },
                        { id: 'lastName', label: 'Last Name', type: 'text', required: true },
                        { id: 'middleName', label: 'Middle Name', type: 'text', required: false },
                        { id: 'dateOfBirth', label: 'Date of Birth', type: 'date', required: true },
                        { id: 'currentAddress', label: 'Current Address', type: 'textarea', required: true },
                        { id: 'phoneNumber', label: 'Phone Number', type: 'tel', required: true },
                        { id: 'emailAddress', label: 'Email Address', type: 'email', required: true },
                        { id: 'contactInfo', label: 'Contact Information', type: 'section' },
                        { id: 'preferredContact', label: 'Preferred Contact Method', type: 'select', required: true, options: ['Email', 'Phone', 'Text Message'] },
                        { id: 'alternatePhone', label: 'Alternate Phone Number', type: 'tel', required: false },
                        { id: 'alternateEmail', label: 'Alternate Email Address', type: 'email', required: false },
                        { id: 'applicationDetails', label: 'Application Details', type: 'section' },
                        { id: 'formType', label: 'Form Type', type: 'select', required: true, options: ['I-130', 'I-140', 'I-485', 'I-765', 'I-131', 'N-400', 'I-821', 'I-821D', 'I-589', 'I-601', 'I-751', 'I-90', 'Other'] },
                        { id: 'receiptNumber', label: 'Receipt Number (if known)', type: 'text', required: false },
                        { id: 'filingDate', label: 'Filing Date', type: 'date', required: false }
                    ]
                },
                'i-821d': {
                    name: 'Form I-821D - DACA Application',
                    description: 'Application for Deferred Action for Childhood Arrivals',
                    fields: [
                        { id: 'personalInfo', label: 'Personal Information', type: 'section' },
                        { id: 'firstName', label: 'First Name', type: 'text', required: true },
                        { id: 'lastName', label: 'Last Name', type: 'text', required: true },
                        { id: 'middleName', label: 'Middle Name', type: 'text', required: false },
                        { id: 'dateOfBirth', label: 'Date of Birth', type: 'date', required: true },
                        { id: 'countryOfBirth', label: 'Country of Birth', type: 'select', required: true, options: ['Mexico', 'China', 'India', 'Philippines', 'El Salvador', 'Guatemala', 'Honduras', 'Cuba', 'Dominican Republic', 'Colombia', 'Venezuela', 'Brazil', 'Argentina', 'Peru', 'Ecuador', 'Bolivia', 'Chile', 'Uruguay', 'Paraguay', 'Other'] },
                        { id: 'currentAddress', label: 'Current Address', type: 'textarea', required: true },
                        { id: 'phoneNumber', label: 'Phone Number', type: 'tel', required: true },
                        { id: 'emailAddress', label: 'Email Address', type: 'email', required: true },
                        { id: 'socialSecurityNumber', label: 'Social Security Number', type: 'text', required: false },
                        { id: 'arrivalInfo', label: 'Arrival Information', type: 'section' },
                        { id: 'entryDate', label: 'Date of Entry to US', type: 'date', required: true },
                        { id: 'methodOfEntry', label: 'Method of Entry', type: 'select', required: true, options: ['Visa', 'Border Crossing', 'Airport', 'Other'] },
                        { id: 'educationInfo', label: 'Education Information', type: 'section' },
                        { id: 'educationLevel', label: 'Education Level', type: 'select', required: true, options: ['Elementary', 'Middle School', 'High School', 'Some College', 'Associate Degree', 'Bachelor Degree', 'Master Degree', 'Doctorate'] },
                        { id: 'schoolName', label: 'Current/Last School Name', type: 'text', required: false },
                        { id: 'graduationDate', label: 'Graduation Date', type: 'date', required: false },
                        { id: 'criminalHistory', label: 'Criminal History', type: 'section' },
                        { id: 'criminalRecord', label: 'Criminal Record', type: 'select', required: true, options: ['None', 'Minor Offenses', 'Major Offenses'] },
                        { id: 'criminalDetails', label: 'Criminal Details (if applicable)', type: 'textarea', required: false },
                        { id: 'economicNecessity', label: 'Economic Necessity', type: 'section' },
                        { id: 'employmentStatus', label: 'Employment Status', type: 'select', required: true, options: ['Employed', 'Unemployed', 'Student', 'Self-Employed', 'Retired', 'Other'] },
                        { id: 'annualIncome', label: 'Annual Income', type: 'number', required: false },
                        { id: 'householdSize', label: 'Household Size', type: 'number', required: false },
                        { id: 'economicHardship', label: 'Economic Hardship Explanation', type: 'textarea', required: false }
                    ]
                },
                'i-131': {
                    name: 'Form I-131 - Application for Travel Document',
                    description: 'Application for advance parole or refugee travel document',
                    fields: [
                        { id: 'personalInfo', label: 'Personal Information', type: 'section' },
                        { id: 'firstName', label: 'First Name', type: 'text', required: true },
                        { id: 'lastName', label: 'Last Name', type: 'text', required: true },
                        { id: 'middleName', label: 'Middle Name', type: 'text', required: false },
                        { id: 'dateOfBirth', label: 'Date of Birth', type: 'date', required: true },
                        { id: 'countryOfBirth', label: 'Country of Birth', type: 'select', required: true, options: ['Mexico', 'China', 'India', 'Philippines', 'El Salvador', 'Guatemala', 'Honduras', 'Cuba', 'Dominican Republic', 'Colombia', 'Venezuela', 'Brazil', 'Argentina', 'Peru', 'Ecuador', 'Bolivia', 'Chile', 'Uruguay', 'Paraguay', 'Other'] },
                        { id: 'currentAddress', label: 'Current Address', type: 'textarea', required: true },
                        { id: 'phoneNumber', label: 'Phone Number', type: 'tel', required: true },
                        { id: 'emailAddress', label: 'Email Address', type: 'email', required: true },
                        { id: 'travelPurpose', label: 'Travel Purpose', type: 'section' },
                        { id: 'travelReason', label: 'Reason for Travel', type: 'select', required: true, options: ['Educational', 'Employment', 'Humanitarian', 'Family Emergency', 'Medical', 'Other'] },
                        { id: 'travelDestination', label: 'Travel Destination', type: 'text', required: true },
                        { id: 'travelDates', label: 'Travel Dates', type: 'section' },
                        { id: 'departureDate', label: 'Departure Date', type: 'date', required: true },
                        { id: 'returnDate', label: 'Return Date', type: 'date', required: true },
                        { id: 'supportingEvidence', label: 'Supporting Evidence', type: 'section' },
                        { id: 'passportPhotos', label: 'Passport Photos', type: 'checkbox', required: true },
                        { id: 'travelDocumentation', label: 'Travel Documentation', type: 'textarea', required: false },
                        { id: 'emergencyContact', label: 'Emergency Contact', type: 'text', required: true },
                        { id: 'emergencyPhone', label: 'Emergency Phone', type: 'tel', required: true }
                    ]
                },
                'i-589': {
                    name: 'Form I-589 - Application for Asylum and Withholding of Removal',
                    description: 'Application for asylum and withholding of removal',
                    fields: [
                        { id: 'personalInfo', label: 'Personal Information', type: 'section' },
                        { id: 'firstName', label: 'First Name', type: 'text', required: true },
                        { id: 'lastName', label: 'Last Name', type: 'text', required: true },
                        { id: 'middleName', label: 'Middle Name', type: 'text', required: false },
                        { id: 'dateOfBirth', label: 'Date of Birth', type: 'date', required: true },
                        { id: 'countryOfBirth', label: 'Country of Birth', type: 'select', required: true, options: ['Mexico', 'China', 'India', 'Philippines', 'El Salvador', 'Guatemala', 'Honduras', 'Cuba', 'Dominican Republic', 'Colombia', 'Venezuela', 'Brazil', 'Argentina', 'Peru', 'Ecuador', 'Bolivia', 'Chile', 'Uruguay', 'Paraguay', 'Other'] },
                        { id: 'currentAddress', label: 'Current Address', type: 'textarea', required: true },
                        { id: 'phoneNumber', label: 'Phone Number', type: 'tel', required: true },
                        { id: 'emailAddress', label: 'Email Address', type: 'email', required: true },
                        { id: 'asylumReason', label: 'Asylum Reason', type: 'section' },
                        { id: 'persecutionType', label: 'Type of Persecution', type: 'select', required: true, options: ['Political Opinion', 'Religion', 'Race', 'Nationality', 'Membership in Social Group', 'Other'] },
                        { id: 'persecutionDetails', label: 'Persecution Details', type: 'section' },
                        { id: 'persecutionDescription', label: 'Description of Persecution', type: 'textarea', required: true },
                        { id: 'persecutionLocation', label: 'Location of Persecution', type: 'text', required: true },
                        { id: 'persecutionDate', label: 'Date of Persecution', type: 'date', required: false },
                        { id: 'supportingEvidence', label: 'Supporting Evidence', type: 'section' },
                        { id: 'passportPhotos', label: 'Passport Photos', type: 'checkbox', required: true },
                        { id: 'identityDocument', label: 'Identity Document', type: 'checkbox', required: true },
                        { id: 'medicalRecords', label: 'Medical Records (if applicable)', type: 'checkbox', required: false },
                        { id: 'policeReports', label: 'Police Reports (if applicable)', type: 'checkbox', required: false },
                        { id: 'witnessStatements', label: 'Witness Statements', type: 'checkbox', required: false }
                    ]
                }
            };
            
            const doc = documents[docId];
            if (!doc) return;
            
            openDocumentModal(doc);
        }

        function fillDocument(docId) {
            // Load saved form data if available
            const savedData = localStorage.getItem(`form_${docId}`);
            if (savedData) {
                const data = JSON.parse(savedData);
                // Pre-fill form with saved data
                Object.keys(data).forEach(key => {
                    const element = document.getElementById(key);
                    if (element) {
                        element.value = data[key];
                    }
                });
            }
            
            viewDocument(docId);
        }

        function downloadDocument(docId) {
            const savedData = localStorage.getItem(`form_${docId}`);
            if (!savedData) {
                alert('Please fill out the form first before downloading.');
                return;
            }
            
            const data = JSON.parse(savedData);
            const doc = getDocumentInfo(docId);
            
            // Generate PDF content
            let pdfContent = `
                <h1>${doc.name}</h1>
                <h2>${doc.description}</h2>
                <hr>
            `;
            
            Object.keys(data).forEach(key => {
                if (data[key]) {
                    const field = doc.fields.find(f => f.id === key);
                    if (field) {
                        pdfContent += `<p><strong>${field.label}:</strong> ${data[key]}</p>`;
                    }
                }
            });
            
            // Create downloadable file
            const blob = new Blob([pdfContent], { type: 'text/html' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `${docId}_filled.html`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
            
            alert('Document downloaded successfully!');
        }

        function getDocumentInfo(docId) {
            const documents = {
                'i-821d': {
                    name: 'Form I-821D - DACA Application',
                    description: 'Application for Deferred Action for Childhood Arrivals',
                    fields: [
                        { id: 'firstName', label: 'First Name' },
                        { id: 'lastName', label: 'Last Name' },
                        { id: 'middleName', label: 'Middle Name' },
                        { id: 'dateOfBirth', label: 'Date of Birth' },
                        { id: 'countryOfBirth', label: 'Country of Birth' },
                        { id: 'currentAddress', label: 'Current Address' },
                        { id: 'phoneNumber', label: 'Phone Number' },
                        { id: 'emailAddress', label: 'Email Address' },
                        { id: 'socialSecurityNumber', label: 'Social Security Number' },
                        { id: 'entryDate', label: 'Date of Entry to US' },
                        { id: 'methodOfEntry', label: 'Method of Entry' },
                        { id: 'educationLevel', label: 'Education Level' },
                        { id: 'schoolName', label: 'Current/Last School Name' },
                        { id: 'graduationDate', label: 'Graduation Date' },
                        { id: 'criminalRecord', label: 'Criminal Record' },
                        { id: 'criminalDetails', label: 'Criminal Details' },
                        { id: 'employmentStatus', label: 'Employment Status' },
                        { id: 'annualIncome', label: 'Annual Income' },
                        { id: 'householdSize', label: 'Household Size' },
                        { id: 'economicHardship', label: 'Economic Hardship Explanation' }
                    ]
                },
                'i-765': {
                    name: 'Form I-765 - Work Authorization',
                    description: 'Application for Employment Authorization Document',
                    fields: [
                        { id: 'firstName', label: 'First Name' },
                        { id: 'lastName', label: 'Last Name' },
                        { id: 'middleName', label: 'Middle Name' },
                        { id: 'dateOfBirth', label: 'Date of Birth' },
                        { id: 'countryOfBirth', label: 'Country of Birth' },
                        { id: 'currentAddress', label: 'Current Address' },
                        { id: 'phoneNumber', label: 'Phone Number' },
                        { id: 'emailAddress', label: 'Email Address' },
                        { id: 'socialSecurityNumber', label: 'Social Security Number' },
                        { id: 'currentStatus', label: 'Current Immigration Status' },
                        { id: 'alienNumber', label: 'Alien Number' },
                        { id: 'previousEmployer', label: 'Previous Employer' },
                        { id: 'employmentDates', label: 'Employment Dates' },
                        { id: 'jobTitle', label: 'Job Title' }
                    ]
                },
                'i-131': {
                    name: 'Form I-131 - Advance Parole',
                    description: 'Application for Travel Document',
                    fields: [
                        { id: 'firstName', label: 'First Name' },
                        { id: 'lastName', label: 'Last Name' },
                        { id: 'middleName', label: 'Middle Name' },
                        { id: 'dateOfBirth', label: 'Date of Birth' },
                        { id: 'countryOfBirth', label: 'Country of Birth' },
                        { id: 'currentAddress', label: 'Current Address' },
                        { id: 'phoneNumber', label: 'Phone Number' },
                        { id: 'emailAddress', label: 'Email Address' },
                        { id: 'socialSecurityNumber', label: 'Social Security Number' },
                        { id: 'travelReason', label: 'Reason for Travel' },
                        { id: 'travelDestination', label: 'Travel Destination' },
                        { id: 'departureDate', label: 'Departure Date' },
                        { id: 'returnDate', label: 'Return Date' },
                        { id: 'travelDocumentation', label: 'Travel Documentation' },
                        { id: 'emergencyContact', label: 'Emergency Contact' },
                        { id: 'emergencyPhone', label: 'Emergency Phone' }
                    ]
                }
            };
            
            return documents[docId];
        }

        function openDocumentModal(doc) {
            // Create modal
            const modal = document.createElement('div');
            modal.className = 'modal';
            modal.innerHTML = `
                <div class="modal-content">
                    <div class="modal-header">
                        <h2>${doc.name}</h2>
                        <button class="close-btn" onclick="closeModal()">&times;</button>
                    </div>
                    <div class="modal-body">
                        <div class="form-header">
                            <h3>${doc.name}</h3>
                            <p class="form-description">${doc.description}</p>
                        </div>
                        <form id="documentForm" class="immigration-form">
                            ${generateFormFields(doc.fields)}
                        </form>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" onclick="saveDocumentForm('${doc.id || 'unknown'}')">Save</button>
                        <button type="button" class="btn btn-success" onclick="downloadDocument('${doc.id || 'unknown'}')">Download</button>
                        <button type="button" class="btn btn-secondary" onclick="closeModal()">Close</button>
                    </div>
                </div>
            `;
            
            document.body.appendChild(modal);
            
            // Load saved data
            loadFormData(doc.id || 'unknown');
        }

        function generateFormFields(fields) {
            let html = '';
            const t = translations[currentLanguage] || translations.en;
            
            fields.forEach(field => {
                if (field.type === 'section') {
                    html += `<div class="form-section" style="grid-column: 1 / -1; margin: 20px 0 10px 0; padding: 10px; background: #f8f9fa; border-radius: 8px; border-left: 4px solid #00ff88;">
                        <h4 style="margin: 0; color: #000000;">${getTranslatedFieldLabel(field.label)}</h4>
                    </div>`;
                } else {
                    html += `<div class="form-group">
                        <label for="${field.id}">${getTranslatedFieldLabel(field.label)}${field.required ? ' *' : ''}</label>
                        ${generateFieldInput(field)}
                    </div>`;
                }
            });
            
            return html;
        }

        function generateFieldInput(field) {
            const required = field.required ? 'required' : '';
            const t = translations[currentLanguage] || translations.en;
            
            switch (field.type) {
                case 'text':
                case 'email':
                case 'tel':
                case 'date':
                case 'number':
                    return `<input type="${field.type}" id="${field.id}" name="${field.id}" ${required} placeholder="${getTranslatedPlaceholder(field.id)}">`;
                
                case 'textarea':
                    return `<textarea id="${field.id}" name="${field.id}" rows="3" ${required} placeholder="${getTranslatedPlaceholder(field.id)}"></textarea>`;
                
                case 'select':
                    let options = `<option value="">${getTranslatedText('selectOption') || 'Select...'}</option>`;
                    if (field.options) {
                        field.options.forEach(option => {
                            options += `<option value="${option}">${getTranslatedOption(option)}</option>`;
                        });
                    }
                    return `<select id="${field.id}" name="${field.id}" ${required}>${options}</select>`;
                
                case 'checkbox':
                    return `<input type="checkbox" id="${field.id}" name="${field.id}" ${required}>`;
                
                default:
                    return `<input type="text" id="${field.id}" name="${field.id}" ${required} placeholder="${getTranslatedPlaceholder(field.id)}">`;
            }
        }

        function getTranslatedFieldLabel(fieldLabel) {
            const t = translations[currentLanguage] || translations.en;
            
            // Map field labels to translations
            const fieldTranslations = {
                'Personal Information': t.personalInformation || 'Personal Information',
                'First Name': t.firstName || 'First Name',
                'Last Name': t.lastName || 'Last Name',
                'Middle Name': t.middleName || 'Middle Name',
                'Date of Birth': t.dateOfBirth || 'Date of Birth',
                'Country of Birth': t.countryOfBirth || 'Country of Birth',
                'Current Address': t.currentAddress || 'Current Address',
                'Phone Number': t.phoneNumber || 'Phone Number',
                'Email Address': t.emailAddress || 'Email Address',
                'Social Security Number': t.socialSecurityNumber || 'Social Security Number',
                'Arrival Information': t.arrivalInformation || 'Arrival Information',
                'Date of Entry to US': t.entryDate || 'Date of Entry to US',
                'Method of Entry': t.methodOfEntry || 'Method of Entry',
                'Education Information': t.educationInformation || 'Education Information',
                'Education Level': t.educationLevel || 'Education Level',
                'Current/Last School Name': t.schoolName || 'Current/Last School Name',
                'Graduation Date': t.graduationDate || 'Graduation Date',
                'Criminal History': t.criminalHistory || 'Criminal History',
                'Criminal Record': t.criminalRecord || 'Criminal Record',
                'Criminal Details (if applicable)': t.criminalDetails || 'Criminal Details (if applicable)',
                'Economic Necessity': t.economicNecessity || 'Economic Necessity',
                'Employment Status': t.employmentStatus || 'Employment Status',
                'Annual Income': t.annualIncome || 'Annual Income',
                'Household Size': t.householdSize || 'Household Size',
                'Economic Hardship Explanation': t.economicHardship || 'Economic Hardship Explanation',
                'Immigration Status': t.immigrationStatus || 'Immigration Status',
                'Current Immigration Status': t.currentStatus || 'Current Immigration Status',
                'Alien Number (if applicable)': t.alienNumber || 'Alien Number (if applicable)',
                'Employment History': t.employmentHistory || 'Employment History',
                'Previous Employer': t.previousEmployer || 'Previous Employer',
                'Employment Dates': t.employmentDates || 'Employment Dates',
                'Job Title': t.jobTitle || 'Job Title',
                'Supporting Documents': t.supportingDocuments || 'Supporting Documents',
                'Passport Photo Required': t.passportPhoto || 'Passport Photo Required',
                'Identity Document': t.identityDocument || 'Identity Document',
                'Employment Evidence': t.employmentEvidence || 'Employment Evidence',
                'Travel Purpose': t.travelPurpose || 'Travel Purpose',
                'Reason for Travel': t.travelReason || 'Reason for Travel',
                'Travel Destination': t.travelDestination || 'Travel Destination',
                'Travel Dates': t.travelDates || 'Travel Dates',
                'Departure Date': t.departureDate || 'Departure Date',
                'Return Date': t.returnDate || 'Return Date',
                'Supporting Evidence': t.supportingEvidence || 'Supporting Evidence',
                'Travel Documentation': t.travelDocumentation || 'Travel Documentation',
                'Emergency Contact': t.emergencyContact || 'Emergency Contact',
                'Emergency Phone': t.emergencyPhone || 'Emergency Phone'
            };
            
            return fieldTranslations[fieldLabel] || fieldLabel;
        }

        function getTranslatedPlaceholder(fieldId) {
            const t = translations[currentLanguage] || translations.en;
            
            const placeholderTranslations = {
                'firstName': t.firstNamePlaceholder || 'Enter your first name',
                'lastName': t.lastNamePlaceholder || 'Enter your last name',
                'middleName': t.middleNamePlaceholder || 'Enter your middle name (optional)',
                'dateOfBirth': t.dateOfBirthPlaceholder || 'Select your date of birth',
                'currentAddress': t.addressPlaceholder || 'Enter your current address',
                'phoneNumber': t.phonePlaceholder || 'Enter your phone number',
                'emailAddress': t.emailPlaceholder || 'Enter your email address',
                'socialSecurityNumber': t.ssnPlaceholder || 'Enter your SSN (if applicable)',
                'entryDate': t.entryDatePlaceholder || 'Select your date of entry',
                'schoolName': t.schoolNamePlaceholder || 'Enter school name',
                'graduationDate': t.graduationDatePlaceholder || 'Select graduation date',
                'criminalDetails': t.criminalDetailsPlaceholder || 'Enter criminal details if applicable',
                'annualIncome': t.annualIncomePlaceholder || 'Enter annual income',
                'householdSize': t.householdSizePlaceholder || 'Enter household size',
                'economicHardship': t.economicHardshipPlaceholder || 'Explain economic hardship',
                'alienNumber': t.alienNumberPlaceholder || 'Enter alien number if applicable',
                'previousEmployer': t.previousEmployerPlaceholder || 'Enter previous employer',
                'employmentDates': t.employmentDatesPlaceholder || 'Enter employment dates',
                'jobTitle': t.jobTitlePlaceholder || 'Enter job title',
                'travelDestination': t.travelDestinationPlaceholder || 'Enter travel destination',
                'travelDocumentation': t.travelDocumentationPlaceholder || 'Enter travel documentation',
                'emergencyContact': t.emergencyContactPlaceholder || 'Enter emergency contact name',
                'emergencyPhone': t.emergencyPhonePlaceholder || 'Enter emergency contact phone'
            };
            
            return placeholderTranslations[fieldId] || '';
        }

        function getTranslatedOption(option) {
            const t = translations[currentLanguage] || translations.en;
            
            const optionTranslations = {
                'Mexico': t.mexico || 'Mexico',
                'China': t.china || 'China',
                'India': t.india || 'India',
                'Philippines': t.philippines || 'Philippines',
                'El Salvador': t.elSalvador || 'El Salvador',
                'Guatemala': t.guatemala || 'Guatemala',
                'Honduras': t.honduras || 'Honduras',
                'Cuba': t.cuba || 'Cuba',
                'Dominican Republic': t.dominicanRepublic || 'Dominican Republic',
                'Colombia': t.colombia || 'Colombia',
                'Venezuela': t.venezuela || 'Venezuela',
                'Brazil': t.brazil || 'Brazil',
                'Argentina': t.argentina || 'Argentina',
                'Peru': t.peru || 'Peru',
                'Ecuador': t.ecuador || 'Ecuador',
                'Bolivia': t.bolivia || 'Bolivia',
                'Chile': t.chile || 'Chile',
                'Uruguay': t.uruguay || 'Uruguay',
                'Paraguay': t.paraguay || 'Paraguay',
                'Other': t.other || 'Other',
                'Visa': t.visa || 'Visa',
                'Border Crossing': t.borderCrossing || 'Border Crossing',
                'Airport': t.airport || 'Airport',
                'Elementary': t.elementary || 'Elementary School',
                'Middle School': t.middleSchool || 'Middle School',
                'High School': t.highSchool || 'High School',
                'Some College': t.someCollege || 'Some College',
                'Associate Degree': t.associateDegree || 'Associate Degree',
                'Bachelor Degree': t.bachelorDegree || 'Bachelor Degree',
                'Master Degree': t.masterDegree || 'Master Degree',
                'Doctorate': t.doctorate || 'Doctorate',
                'Employed': t.employed || 'Employed',
                'Unemployed': t.unemployed || 'Unemployed',
                'Student': t.student || 'Student',
                'Self-Employed': t.selfEmployed || 'Self-Employed',
                'Retired': t.retired || 'Retired',
                'None': t.none || 'No Criminal History',
                'Minor': t.minor || 'Minor Offenses',
                'Major': t.major || 'Major Offenses',
                'DACA': t.daca || 'DACA',
                'TPS': t.tps || 'TPS',
                'Asylum Pending': t.asylumPending || 'Asylum Pending',
                'Family Petition Pending': t.familyPetitionPending || 'Family Petition Pending',
                'Educational': t.educational || 'Educational',
                'Employment': t.employment || 'Employment',
                'Humanitarian': t.humanitarian || 'Humanitarian',
                'Family Emergency': t.familyEmergency || 'Family Emergency',
                'Medical': t.medical || 'Medical'
            };
            
            return optionTranslations[option] || option;
        }

        function saveDocumentForm(docId) {
            const form = document.getElementById('documentForm');
            const formData = new FormData(form);
            const data = {};
            
            for (let [key, value] of formData.entries()) {
                data[key] = value;
            }
            
            // Save to localStorage
            localStorage.setItem(`form_${docId}`, JSON.stringify(data));
            
            // Show success message
            alert('Form saved successfully!');
        }

        function loadFormData(docId) {
            const savedData = localStorage.getItem(`form_${docId}`);
            if (savedData) {
                const data = JSON.parse(savedData);
                Object.keys(data).forEach(key => {
                    const element = document.getElementById(key);
                    if (element) {
                        element.value = data[key];
                    }
                });
            }
        }

        function closeModal() {
            const modal = document.querySelector('.modal');
            if (modal) {
                modal.remove();
            }
        }

        // Sidebar AI Functions
        async function sendSidebarMessage() {
            const input = document.getElementById('aiSidebarInput');
            const message = input.value.trim();
            
            if (message) {
                addSidebarMessage(message, true);
                
                // Save to chat history
                if (!currentChatId) {
                    currentChatId = Date.now();
                    chatHistory.push({
                        id: currentChatId,
                        title: message.substring(0, 50) + (message.length > 50 ? '...' : ''),
                        date: new Date(),
                        messages: []
                    });
                }
                
                chatHistory[chatHistory.length - 1].messages.push({
                    text: message,
                    isUser: true,
                    timestamp: new Date()
                });
                
                input.value = '';
                
                // Show typing indicator
                const typingIndicator = document.createElement('div');
                typingIndicator.className = 'ai-sidebar-message ai typing';
                typingIndicator.innerHTML = '<div class="ai-sidebar-typing-dots"><span></span><span></span><span></span></div>';
                document.getElementById('aiSidebarChat').appendChild(typingIndicator);
                document.getElementById('aiSidebarChat').scrollTop = document.getElementById('aiSidebarChat').scrollHeight;
                
                try {
                    // Generate intelligent AI response using LLM with current language
                    const aiResponse = await immigrationLLM.generateResponse(message, userProfile, currentLanguage);
                    
                    // Remove typing indicator
                    typingIndicator.remove();
                    
                    // Add AI response
                    addSidebarMessage(aiResponse, false);
                    
                    // Save AI response to chat history
                    chatHistory[chatHistory.length - 1].messages.push({
                        text: aiResponse,
                        isUser: false,
                        timestamp: new Date()
                    });
                    
                    // Check if user is asking about forms and offer to help fill them
                    if (message.toLowerCase().includes('form') || message.toLowerCase().includes('document') || message.toLowerCase().includes('i-821d') || message.toLowerCase().includes('i-765') || message.toLowerCase().includes('i-131')) {
                        setTimeout(() => {
                            const formHelpMessage = getTranslatedText('formHelpMessage') || "I can help you fill out immigration forms. Would you like me to open a specific form for you?";
                            addSidebarMessage(formHelpMessage, false);
                            
                            chatHistory[chatHistory.length - 1].messages.push({
                                text: formHelpMessage,
                                isUser: false,
                                timestamp: new Date()
                            });
                        }, 1000);
                    }
                    
                    savePreferences();
                    
                } catch (error) {
                    // Remove typing indicator
                    typingIndicator.remove();
                    
                    // Fallback response in current language
                    const fallbackResponse = immigrationLLM.getFallbackResponse(message, currentLanguage);
                    addSidebarMessage(fallbackResponse, false);
                    
                    // Save fallback response to chat history
                    chatHistory[chatHistory.length - 1].messages.push({
                        text: fallbackResponse,
                        isUser: false,
                        timestamp: new Date()
                    });
                    
                    savePreferences();
                }
            }
        }

        function uploadDocument() {
            document.getElementById('documentUpload').click();
        }

        async function handleDocumentUpload(event) {
            const file = event.target.files[0];
            if (!file) return;

            // Show processing message
            addSidebarMessage(`üìÑ Processing document: ${file.name}`, true);
            
            const typingIndicator = document.createElement('div');
            typingIndicator.className = 'ai-sidebar-message ai typing';
            typingIndicator.innerHTML = '<div class="ai-sidebar-typing-dots"><span></span><span></span><span></span></div>';
            document.getElementById('aiSidebarChat').appendChild(typingIndicator);
            document.getElementById('aiSidebarChat').scrollTop = document.getElementById('aiSidebarChat').scrollHeight;

            try {
                // Extract text from document
                const documentText = await extractTextFromFile(file);
                
                // Process the document
                const parsedQuestions = await immigrationLLM.documentParser.parseDocument(documentText, currentLanguage);
                
                // Remove typing indicator
                typingIndicator.remove();
                
                // Format and display results
                const formattedResponse = immigrationLLM.formatParsedQuestions(parsedQuestions, currentLanguage);
                addSidebarMessage(formattedResponse, false);
                
                // Save to chat history
                chatHistory[chatHistory.length - 1].messages.push({
                    text: formattedResponse,
                    isUser: false,
                    timestamp: new Date()
                });
                
                savePreferences();
                
            } catch (error) {
                console.error('Document processing error:', error);
                
                // Remove typing indicator
                typingIndicator.remove();
                
                // Show error message
                const errorMessage = getTranslatedText('documentProcessingError', currentLanguage) || 
                                   "I had trouble processing that document. Please try uploading a text file or paste the content directly.";
                addSidebarMessage(errorMessage, false);
                
                chatHistory[chatHistory.length - 1].messages.push({
                    text: errorMessage,
                    isUser: false,
                    timestamp: new Date()
                });
                
                savePreferences();
            }
        }

        async function extractTextFromFile(file) {
            return new Promise((resolve, reject) => {
                const reader = new FileReader();
                
                reader.onload = function(e) {
                    const content = e.target.result;
                    
                    // Handle different file types
                    if (file.type === 'text/plain') {
                        resolve(content);
                    } else if (file.type === 'application/pdf') {
                        // For PDF files, we'll use a simple approach
                        // In a real implementation, you'd use a PDF parsing library
                        resolve("PDF content extraction not implemented. Please copy and paste the text content.");
                    } else if (file.type.includes('word') || file.type.includes('document')) {
                        // For Word documents, we'll use a simple approach
                        resolve("Word document content extraction not implemented. Please copy and paste the text content.");
                    } else {
                        // Try to read as text
                        resolve(content);
                    }
                };
                
                reader.onerror = function() {
                    reject(new Error('Failed to read file'));
                };
                
                // Read as text for now (works for .txt files)
                reader.readAsText(file);
            });
        }

        function addSidebarMessage(message, isUser) {
            const messagesContainer = document.getElementById('aiSidebarChat');
            const messageDiv = document.createElement('div');
            messageDiv.className = `ai-sidebar-message ${isUser ? 'user' : 'ai'}`;
            messageDiv.textContent = message;
            
            messagesContainer.appendChild(messageDiv);
            messagesContainer.scrollTop = messagesContainer.scrollHeight;
        }

        function handleSidebarKeyPress(event) {
            if (event.key === 'Enter') {
                sendSidebarMessage();
            }
        }

        function toggleSidebarVoiceRecording() {
            if (!recognition) {
                alert('Speech recognition not supported in this browser.');
                return;
            }
            
            const voiceBtn = document.getElementById('aiSidebarVoiceBtn');
            
            if (isRecording) {
                recognition.stop();
                voiceBtn.classList.remove('recording');
                voiceBtn.textContent = 'üé§';
                isRecording = false;
            } else {
                recognition.start();
                voiceBtn.classList.add('recording');
                voiceBtn.textContent = '‚èπÔ∏è';
                isRecording = true;
            }
        }

        function addChatMessage(message, isUser) {
            const messagesContainer = document.getElementById('chatMessages');
            const messageDiv = document.createElement('div');
            messageDiv.className = `message ${isUser ? 'user' : 'ai'}`;
            messageDiv.textContent = message;
            
            messagesContainer.appendChild(messageDiv);
            messagesContainer.scrollTop = messagesContainer.scrollHeight;
            
            // Save to chat history
            if (!currentChatId) {
                currentChatId = Date.now();
                chatHistory.push({
                    id: currentChatId,
                    title: message.substring(0, 50) + (message.length > 50 ? '...' : ''),
                    date: new Date(),
                    messages: []
                });
            }
            
            chatHistory[chatHistory.length - 1].messages.push({
                text: message,
                isUser: isUser,
                timestamp: new Date()
            });
            
            savePreferences();
        }

        // Document Parser Class
        class DocumentParser {
            constructor() {
                this.ollamaBaseURL = 'http://localhost:11434/api/generate';
                this.currentLanguage = 'en';
                this.questionTypes = {
                    LEQ: 'long_answer', // Long Essay Questions
                    SAQ: 'short_answer', // Short Answer Questions
                    MCQ: 'multiple_choice', // Multiple Choice Questions
                    BOOLEAN: 'yes_no' // Yes/No Questions
                };
            }

            async parseDocument(documentText, language = 'en') {
                try {
                    console.log('Starting document parsing...');
                    
                    // Step 1: Extract questions from document
                    const questions = await this.extractQuestions(documentText);
                    console.log(`Extracted ${questions.length} questions`);
                    
                    // Step 2: Chunk questions by type
                    const chunkedQuestions = await this.chunkQuestions(questions);
                    console.log('Questions chunked by type:', chunkedQuestions);
                    
                    // Step 3: Summarize LEQs for better understanding
                    const summarizedQuestions = await this.summarizeLEQs(chunkedQuestions, language);
                    console.log('LEQs summarized');
                    
                    // Step 4: Translate if needed
                    const finalQuestions = await this.translateQuestions(summarizedQuestions, language);
                    console.log('Questions translated if needed');
                    
                    return finalQuestions;
                    
                } catch (error) {
                    console.error('Document parsing error:', error);
                    return this.getFallbackQuestions(documentText);
                }
            }

            async extractQuestions(documentText) {
                const prompt = `You are an expert immigration attorney analyzing immigration forms. Extract all questions from this immigration document and categorize them properly.

                IMMIGRATION FORM ANALYSIS:
                Document: "${documentText}"

                Return a JSON array where each question has:
                - "text": the exact question text as it appears
                - "type": "LEQ" for long essay questions (explain, describe, provide details), "SAQ" for short answer (name, date, number), "MCQ" for multiple choice, "BOOLEAN" for yes/no questions
                - "field_id": a unique identifier (use form field names like "firstName", "dateOfBirth", etc.)
                - "complexity": "simple" (basic info), "moderate" (requires some thought), or "complex" (legal/technical)
                - "context": what information this question is seeking
                - "required": true/false based on asterisks or required indicators
                - "category": "personal", "immigration", "criminal", "employment", "education", "travel", "family"

                Focus on USCIS forms like I-821D, I-765, I-131, I-485, I-130, N-400, I-589, I-90.

                Return only valid JSON array:`;

                try {
                    const response = await this.callOllama(prompt);
                    const questions = JSON.parse(response);
                    return Array.isArray(questions) ? questions : [];
                } catch (error) {
                    console.error('Question extraction error:', error);
                    return this.extractQuestionsFallback(documentText);
                }
            }

            async chunkQuestions(questions) {
                const chunked = {
                    LEQ: [],
                    SAQ: [],
                    MCQ: [],
                    BOOLEAN: []
                };

                questions.forEach(question => {
                    const type = question.type || this.detectQuestionType(question.text);
                    if (chunked[type]) {
                        chunked[type].push(question);
                    }
                });

                return chunked;
            }

            async summarizeLEQs(chunkedQuestions, language) {
                const summarized = { ...chunkedQuestions };
                
                for (let i = 0; i < summarized.LEQ.length; i++) {
                    const question = summarized.LEQ[i];
                    try {
                        const summary = await this.summarizeQuestion(question.text, language);
                        summarized.LEQ[i] = {
                            ...question,
                            original_text: question.text,
                            simplified_text: summary,
                            summary_explanation: await this.explainSummary(question.text, summary, language)
                        };
                    } catch (error) {
                        console.error('Summarization error for question:', question.text, error);
                        summarized.LEQ[i].simplified_text = question.text;
                    }
                }

                return summarized;
            }

            async summarizeQuestion(questionText, language) {
                const prompt = `You are helping immigrants understand complex immigration form questions. Simplify this USCIS form question to make it clear for someone who may not read/write well or speak English fluently.

                IMMIGRATION QUESTION SIMPLIFICATION:
                Original question: "${questionText}"
                
                Create a simplified version that:
                - Uses simple, everyday words (avoid legal jargon)
                - Has shorter, clearer sentences
                - Explains what specific information is needed
                - Is direct and easy to understand
                - Maintains the legal meaning but makes it accessible
                
                Examples:
                "Provide a detailed explanation of your current immigration status" ‚Üí "Tell us about your current immigration status in simple words"
                "Describe the circumstances surrounding your entry into the United States" ‚Üí "Tell us how you came to the United States"
                
                Simplified version:`;

                try {
                    const response = await this.callOllama(prompt);
                    return response.trim();
                } catch (error) {
                    console.error('Summarization error:', error);
                    return questionText;
                }
            }

            async explainSummary(originalText, summary, language) {
                const prompt = `Explain why this simplified version is easier to understand than the original:

                Original: "${originalText}"
                Simplified: "${summary}"

                Provide a brief explanation of what was changed and why it's clearer.`;

                try {
                    const response = await this.callOllama(prompt);
                    return response.trim();
                } catch (error) {
                    return "This simplified version uses easier words and shorter sentences.";
                }
            }

            async translateQuestions(questions, targetLanguage) {
                if (targetLanguage === 'en') {
                    return questions;
                }

                const translated = { ...questions };

                // Translate LEQs
                for (let i = 0; i < translated.LEQ.length; i++) {
                    const question = translated.LEQ[i];
                    try {
                        question.translated_text = await this.translateText(question.simplified_text || question.text, targetLanguage);
                        question.translated_explanation = await this.translateText(question.summary_explanation || '', targetLanguage);
                    } catch (error) {
                        console.error('Translation error:', error);
                        question.translated_text = question.simplified_text || question.text;
                    }
                }

                // Translate other question types
                ['SAQ', 'MCQ', 'BOOLEAN'].forEach(type => {
                    translated[type].forEach(question => {
                        if (!question.translated_text) {
                            question.translated_text = question.text;
                        }
                    });
                });

                return translated;
            }

            async translateText(text, targetLanguage) {
                const languageNames = {
                    'es': 'Spanish',
                    'zh': 'Chinese',
                    'ar': 'Arabic',
                    'hi': 'Hindi',
                    'pt': 'Portuguese',
                    'ru': 'Russian',
                    'fr': 'French'
                };

                const prompt = `You are translating immigration form content for immigrants. Translate this USCIS form text to ${languageNames[targetLanguage] || targetLanguage}.

                IMMIGRATION TRANSLATION GUIDELINES:
                - Use simple, clear language that immigrants can understand
                - Maintain legal accuracy but make it accessible
                - Use common words instead of complex legal terms
                - Keep the same meaning and context
                - Make it culturally appropriate for ${languageNames[targetLanguage] || targetLanguage} speakers

                Text to translate: "${text}"

                Translation:`;

                try {
                    const response = await this.callOllama(prompt);
                    return response.trim();
                } catch (error) {
                    console.error('Translation error:', error);
                    return text;
                }
            }

            async callOllama(prompt) {
                try {
                    const response = await fetch(this.ollamaBaseURL, {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify({
                            model: 'llama2', // You can change this to other models
                            prompt: prompt,
                            stream: false
                        })
                    });

                    if (!response.ok) {
                        throw new Error(`Ollama API error: ${response.status}`);
                    }

                    const data = await response.json();
                    return data.response || '';
                } catch (error) {
                    console.error('Ollama API call failed:', error);
                    throw error;
                }
            }

            detectQuestionType(questionText) {
                const text = questionText.toLowerCase();
                
                if (text.includes('yes') && text.includes('no')) {
                    return 'BOOLEAN';
                }
                if (text.includes('check all') || text.includes('select all')) {
                    return 'MCQ';
                }
                if (text.includes('explain') || text.includes('describe') || text.includes('provide details') || text.length > 100) {
                    return 'LEQ';
                }
                
                return 'SAQ';
            }

            extractQuestionsFallback(documentText) {
                // Fallback method using regex patterns
                const questions = [];
                const lines = documentText.split('\n');
                
                lines.forEach((line, index) => {
                    const trimmed = line.trim();
                    if (trimmed.includes('?') || trimmed.match(/^\d+\./)) {
                        questions.push({
                            text: trimmed,
                            type: this.detectQuestionType(trimmed),
                            field_id: `field_${index}`,
                            complexity: trimmed.length > 100 ? 'complex' : 'simple',
                            context: 'Immigration form question'
                        });
                    }
                });

                return questions;
            }

            getFallbackQuestions(documentText) {
                return {
                    LEQ: [{
                        text: "Please provide a detailed explanation of your situation",
                        simplified_text: "Tell us about your situation in simple words",
                        field_id: "fallback_leq_1",
                        complexity: "moderate"
                    }],
                    SAQ: [{
                        text: "What is your full name?",
                        field_id: "fallback_saq_1",
                        complexity: "simple"
                    }],
                    MCQ: [],
                    BOOLEAN: [{
                        text: "Have you ever been arrested?",
                        field_id: "fallback_bool_1",
                        complexity: "simple"
                    }]
                };
            }
        }

        // Immigration LLM Class
        class ImmigrationLLM {
            constructor() {
                this.apiKey = 'sk-proj-your-openai-api-key-here'; // Replace with actual API key
                this.baseURL = 'https://api.openai.com/v1/chat/completions';
                this.model = 'gpt-4';
                this.currentLanguage = 'en';
                this.context = this.buildImmigrationContext();
                this.documentParser = new DocumentParser();
            }
            
            buildImmigrationContext() {
                return {
                    role: "You are an expert immigration attorney and caseworker with 20+ years of experience. You specialize in DACA, TPS, asylum, and family-based immigration. You provide accurate, up-to-date legal guidance while being empathetic and supportive. Always remind users that you are not providing legal advice and they should consult with a qualified attorney for their specific case.",
                    expertise: [
                        "DACA applications and renewals",
                        "TPS applications and extensions", 
                        "Asylum applications and interviews",
                        "Family-based immigration petitions",
                        "Employment authorization documents",
                        "Advance parole applications",
                        "Immigration court proceedings",
                        "Removal defense strategies"
                    ],
                    forms: [
                        "I-821D (DACA)",
                        "I-765 (Employment Authorization)",
                        "I-131 (Advance Parole)",
                        "I-589 (Asylum Application)",
                        "I-130 (Petition for Alien Relative)",
                        "I-485 (Adjustment of Status)",
                        "I-601 (Waiver of Grounds of Inadmissibility)",
                        "I-212 (Application for Permission to Reapply)"
                    ]
                };
            }
            
            async generateResponse(userMessage, userProfile = null, currentLanguage = null) {
                try {
                    // Check if user wants to parse a document
                    if (userMessage.toLowerCase().includes('parse document') || 
                        userMessage.toLowerCase().includes('analyze form') ||
                        userMessage.toLowerCase().includes('help me understand this form')) {
                        return await this.handleDocumentParsing(userMessage, currentLanguage || this.currentLanguage);
                    }

                    // Use instance language if not provided
                    const language = currentLanguage || this.currentLanguage;
                    const systemPrompt = this.buildSystemPrompt(language);
                    const userPrompt = this.buildUserPrompt(userMessage, userProfile, language);
                    
                    const response = await fetch(this.baseURL, {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                            'Authorization': `Bearer ${this.apiKey}`
                        },
                        body: JSON.stringify({
                            model: this.model,
                            messages: [
                                { role: 'system', content: systemPrompt },
                                { role: 'user', content: userPrompt }
                            ],
                            max_tokens: 1000,
                            temperature: 0.7
                        })
                    });
                    
                    if (!response.ok) {
                        throw new Error(`API Error: ${response.status}`);
                    }
                    
                    const data = await response.json();
                    return data.choices[0].message.content;
                    
                } catch (error) {
                    console.error('LLM Error:', error);
                    return this.getFallbackResponse(userMessage, currentLanguage || this.currentLanguage);
                }
            }

            async handleDocumentParsing(userMessage, language) {
                try {
                    // Extract document text from user message
                    const documentText = this.extractDocumentText(userMessage);
                    
                    if (!documentText) {
                        return this.getTranslatedText('documentParsingInstructions', language) || 
                               "Please paste the immigration form text you'd like me to analyze. I'll break it down into simple questions for you.";
                    }

                    // Parse the document
                    const parsedQuestions = await this.documentParser.parseDocument(documentText, language);
                    
                    // Format the response
                    return this.formatParsedQuestions(parsedQuestions, language);
                    
                } catch (error) {
                    console.error('Document parsing error:', error);
                    return this.getTranslatedText('documentParsingError', language) || 
                           "I had trouble analyzing that document. Please try again or paste a shorter section.";
                }
            }

            extractDocumentText(userMessage) {
                // Look for document text in various formats
                const patterns = [
                    /form text[:\s]*(.+)/i,
                    /document[:\s]*(.+)/i,
                    /analyze[:\s]*(.+)/i,
                    /parse[:\s]*(.+)/i
                ];

                for (const pattern of patterns) {
                    const match = userMessage.match(pattern);
                    if (match && match[1].trim().length > 10) {
                        return match[1].trim();
                    }
                }

                // If no pattern matches, return the whole message if it's long enough
                return userMessage.length > 50 ? userMessage : null;
            }

            formatParsedQuestions(parsedQuestions, language) {
                let response = this.getTranslatedText('documentAnalysisComplete', language) || 
                              "I've analyzed your immigration form. Here's what I found:\n\n";

                // Format LEQs (Long Essay Questions)
                if (parsedQuestions.LEQ && parsedQuestions.LEQ.length > 0) {
                    response += `üìù **${this.getTranslatedText('longAnswerQuestions', language) || 'Long Answer Questions'}**\n\n`;
                    
                    parsedQuestions.LEQ.forEach((question, index) => {
                        response += `${index + 1}. **${this.getTranslatedText('originalQuestion', language) || 'Original Question'}:**\n`;
                        response += `   ${question.original_text || question.text}\n\n`;
                        
                        response += `   **${this.getTranslatedText('simplifiedQuestion', language) || 'Simplified Question'}:**\n`;
                        response += `   ${question.translated_text || question.simplified_text || question.text}\n\n`;
                        
                        if (question.translated_explanation || question.summary_explanation) {
                            response += `   **${this.getTranslatedText('explanation', language) || 'Explanation'}:**\n`;
                            response += `   ${question.translated_explanation || question.summary_explanation}\n\n`;
                        }
                        
                        response += "---\n\n";
                    });
                }

                // Format SAQs (Short Answer Questions)
                if (parsedQuestions.SAQ && parsedQuestions.SAQ.length > 0) {
                    response += `üìã **${this.getTranslatedText('shortAnswerQuestions', language) || 'Short Answer Questions'}**\n\n`;
                    
                    parsedQuestions.SAQ.forEach((question, index) => {
                        response += `${index + 1}. ${question.translated_text || question.text}\n`;
                    });
                    response += "\n";
                }

                // Format Boolean Questions
                if (parsedQuestions.BOOLEAN && parsedQuestions.BOOLEAN.length > 0) {
                    response += `‚úÖ **${this.getTranslatedText('yesNoQuestions', language) || 'Yes/No Questions'}**\n\n`;
                    
                    parsedQuestions.BOOLEAN.forEach((question, index) => {
                        response += `${index + 1}. ${question.translated_text || question.text}\n`;
                    });
                    response += "\n";
                }

                // Format Multiple Choice Questions
                if (parsedQuestions.MCQ && parsedQuestions.MCQ.length > 0) {
                    response += `üîò **${this.getTranslatedText('multipleChoiceQuestions', language) || 'Multiple Choice Questions'}**\n\n`;
                    
                    parsedQuestions.MCQ.forEach((question, index) => {
                        response += `${index + 1}. ${question.translated_text || question.text}\n`;
                    });
                    response += "\n";
                }

                response += this.getTranslatedText('documentParsingHelp', language) || 
                           "üí° **Tip:** I can help you fill out these forms step by step. Just ask me about any specific question!";

                return response;
            }

            getTranslatedText(key, language) {
                const translations = {
                    en: {
                        documentParsingInstructions: "Please paste the immigration form text you'd like me to analyze. I'll break it down into simple questions for you.",
                        documentParsingError: "I had trouble analyzing that document. Please try again or paste a shorter section.",
                        documentAnalysisComplete: "I've analyzed your immigration form. Here's what I found:",
                        longAnswerQuestions: "Long Answer Questions",
                        shortAnswerQuestions: "Short Answer Questions",
                        yesNoQuestions: "Yes/No Questions",
                        multipleChoiceQuestions: "Multiple Choice Questions",
                        originalQuestion: "Original Question",
                        simplifiedQuestion: "Simplified Question",
                        explanation: "Explanation",
                        documentParsingHelp: "üí° **Tip:** I can help you fill out these forms step by step. Just ask me about any specific question!"
                    },
                    es: {
                        documentParsingInstructions: "Por favor pega el texto del formulario de inmigraci√≥n que quieres que analice. Lo dividir√© en preguntas simples para ti.",
                        documentParsingError: "Tuve problemas analizando ese documento. Por favor intenta de nuevo o pega una secci√≥n m√°s corta.",
                        documentAnalysisComplete: "He analizado tu formulario de inmigraci√≥n. Esto es lo que encontr√©:",
                        longAnswerQuestions: "Preguntas de Respuesta Larga",
                        shortAnswerQuestions: "Preguntas de Respuesta Corta",
                        yesNoQuestions: "Preguntas de S√≠/No",
                        multipleChoiceQuestions: "Preguntas de Opci√≥n M√∫ltiple",
                        originalQuestion: "Pregunta Original",
                        simplifiedQuestion: "Pregunta Simplificada",
                        explanation: "Explicaci√≥n",
                        documentParsingHelp: "üí° **Consejo:** ¬°Puedo ayudarte a llenar estos formularios paso a paso. Solo preg√∫ntame sobre cualquier pregunta espec√≠fica!"
                    },
                    zh: {
                        documentParsingInstructions: "ËØ∑Á≤òË¥¥ÊÇ®ÊÉ≥ËÆ©ÊàëÂàÜÊûêÁöÑÁßªÊ∞ëË°®Ê†ºÊñáÊú¨„ÄÇÊàë‰ºöÂ∞ÜÂÖ∂ÂàÜËß£‰∏∫ÁÆÄÂçïÁöÑÈóÆÈ¢ò‰æõÊÇ®ÁêÜËß£„ÄÇ",
                        documentParsingError: "ÊàëÂàÜÊûêËØ•ÊñáÊ°£Êó∂ÈÅáÂà∞‰∫ÜÈóÆÈ¢ò„ÄÇËØ∑ÈáçËØïÊàñÁ≤òË¥¥ËæÉÁü≠ÁöÑÊÆµËêΩ„ÄÇ",
                        documentAnalysisComplete: "ÊàëÂ∑≤ÁªèÂàÜÊûê‰∫ÜÊÇ®ÁöÑÁßªÊ∞ëË°®Ê†º„ÄÇ‰ª•‰∏ãÊòØÊàëÂèëÁé∞ÁöÑÂÜÖÂÆπÔºö",
                        longAnswerQuestions: "ÈïøÁ≠îÊ°àÈóÆÈ¢ò",
                        shortAnswerQuestions: "Áü≠Á≠îÊ°àÈóÆÈ¢ò",
                        yesNoQuestions: "ÊòØ/Âê¶ÈóÆÈ¢ò",
                        multipleChoiceQuestions: "Â§öÈÄâÈ¢ò",
                        originalQuestion: "ÂéüÂßãÈóÆÈ¢ò",
                        simplifiedQuestion: "ÁÆÄÂåñÈóÆÈ¢ò",
                        explanation: "Ëß£Èáä",
                        documentParsingHelp: "üí° **ÊèêÁ§∫Ôºö** ÊàëÂèØ‰ª•ÈÄêÊ≠•Â∏ÆÂä©ÊÇ®Â°´ÂÜôËøô‰∫õË°®Ê†º„ÄÇÂè™ÈúÄËØ¢ÈóÆÊàë‰ªª‰ΩïÂÖ∑‰ΩìÈóÆÈ¢òÔºÅ"
                    }
                };

                return translations[language]?.[key] || translations.en[key];
            }
            
            buildSystemPrompt(language) {
                const prompts = {
                    en: `You are an expert immigration attorney and caseworker with 20+ years of experience. You specialize in DACA, TPS, asylum, and family-based immigration. You provide accurate, up-to-date legal guidance while being empathetic and supportive. Always remind users that you are not providing legal advice and they should consult with a qualified attorney for their specific case.`,
                    es: `Eres un abogado de inmigraci√≥n experto y trabajador social con m√°s de 20 a√±os de experiencia. Te especializas en DACA, TPS, asilo e inmigraci√≥n basada en familia. Proporcionas orientaci√≥n legal precisa y actualizada mientras eres emp√°tico y solidario. Siempre recuerda a los usuarios que no est√°s proporcionando asesoramiento legal y que deben consultar con un abogado calificado para su caso espec√≠fico.`,
                    zh: `ÊÇ®ÊòØ‰∏Ä‰ΩçÊã•Êúâ20Â§öÂπ¥ÁªèÈ™åÁöÑ‰∏ìÂÆ∂ÁßªÊ∞ëÂæãÂ∏àÂíåÊ°à‰æãÂ∑•‰ΩúËÄÖ„ÄÇÊÇ®‰∏ìÈó®‰ªé‰∫ãDACA„ÄÅTPS„ÄÅÂ∫áÊä§ÂíåÂÆ∂Â∫≠ÁßªÊ∞ë„ÄÇÊÇ®Êèê‰æõÂáÜÁ°Æ„ÄÅÊúÄÊñ∞ÁöÑÊ≥ïÂæãÊåáÂØºÔºåÂêåÊó∂ÂØåÊúâÂêåÁêÜÂøÉÂíåÊîØÊåÅÊÄß„ÄÇÂßãÁªàÊèêÈÜíÁî®Êà∑ÊÇ®‰∏çÊèê‰æõÊ≥ïÂæãÂª∫ËÆÆÔºå‰ªñ‰ª¨Â∫îËØ•Â∞±ÂÖ∑‰ΩìÊ°à‰ª∂Âí®ËØ¢ÂêàÊ†ºÁöÑÂæãÂ∏à„ÄÇ`,
                    ar: `ÿ£ŸÜÿ™ ŸÖÿ≠ÿßŸÖŸä Ÿáÿ¨ÿ±ÿ© ÿÆÿ®Ÿäÿ± ŸàÿπÿßŸÖŸÑ ÿßÿ¨ÿ™ŸÖÿßÿπŸä ŸÖÿπ ÿ£ŸÉÿ´ÿ± ŸÖŸÜ 20 ÿπÿßŸÖŸãÿß ŸÖŸÜ ÿßŸÑÿÆÿ®ÿ±ÿ©. ÿ™ÿ™ÿÆÿµÿµ ŸÅŸä DACA Ÿà TPS ŸàÿßŸÑŸÑÿ¨Ÿàÿ° ŸàÿßŸÑŸáÿ¨ÿ±ÿ© ÿßŸÑŸÇÿßÿ¶ŸÖÿ© ÿπŸÑŸâ ÿßŸÑÿ£ÿ≥ÿ±ÿ©. ÿ™ŸÇÿØŸÖ ÿ•ÿ±ÿ¥ÿßÿØÿßÿ™ ŸÇÿßŸÜŸàŸÜŸäÿ© ÿØŸÇŸäŸÇÿ© ŸàŸÖÿ≠ÿØÿ´ÿ© ÿ®ŸäŸÜŸÖÿß ÿ™ŸÉŸàŸÜ ŸÖÿ™ÿπÿßÿ∑ŸÅŸãÿß ŸàÿØÿßÿπŸÖŸãÿß. ÿ™ÿ∞ŸÉÿ± ÿßŸÑŸÖÿ≥ÿ™ÿÆÿØŸÖŸäŸÜ ÿØÿßÿ¶ŸÖŸãÿß ÿ£ŸÜŸÉ ŸÑÿß ÿ™ŸÇÿØŸÖ ŸÖÿ¥Ÿàÿ±ÿ© ŸÇÿßŸÜŸàŸÜŸäÿ© ŸàŸäÿ¨ÿ® ÿπŸÑŸäŸáŸÖ ÿßÿ≥ÿ™ÿ¥ÿßÿ±ÿ© ŸÖÿ≠ÿßŸÖŸç ŸÖÿ§ŸáŸÑ ŸÑÿ≠ÿßŸÑÿ™ŸáŸÖ ÿßŸÑŸÖÿ≠ÿØÿØÿ©.`,
                    hi: `‡§Ü‡§™ ‡§è‡§ï ‡§µ‡§ø‡§∂‡•á‡§∑‡§ú‡•ç‡§û ‡§Ü‡§™‡•ç‡§∞‡§µ‡§æ‡§∏‡§® ‡§µ‡§ï‡•Ä‡§≤ ‡§î‡§∞ ‡§ï‡•á‡§∏ ‡§µ‡§∞‡•ç‡§ï‡§∞ ‡§π‡•à‡§Ç ‡§ú‡§ø‡§®‡§ï‡•á ‡§™‡§æ‡§∏ 20+ ‡§µ‡§∞‡•ç‡§∑‡•ã‡§Ç ‡§ï‡§æ ‡§Ö‡§®‡•Å‡§≠‡§µ ‡§π‡•à‡•§ ‡§Ü‡§™ DACA, TPS, ‡§∂‡§∞‡§£ ‡§î‡§∞ ‡§™‡§æ‡§∞‡§ø‡§µ‡§æ‡§∞‡§ø‡§ï ‡§Ü‡§ß‡§æ‡§∞‡§ø‡§§ ‡§Ü‡§™‡•ç‡§∞‡§µ‡§æ‡§∏‡§® ‡§Æ‡•á‡§Ç ‡§µ‡§ø‡§∂‡•á‡§∑‡§ú‡•ç‡§û‡§§‡§æ ‡§∞‡§ñ‡§§‡•á ‡§π‡•à‡§Ç‡•§ ‡§Ü‡§™ ‡§∏‡§π‡§æ‡§®‡•Å‡§≠‡•Ç‡§§‡§ø‡§™‡•Ç‡§∞‡•ç‡§£ ‡§î‡§∞ ‡§∏‡§π‡§æ‡§Ø‡§ï ‡§π‡•ã‡§§‡•á ‡§π‡•Å‡§è ‡§∏‡§ü‡•Ä‡§ï, ‡§Ö‡§¶‡•ç‡§Ø‡§§‡§® ‡§ï‡§æ‡§®‡•Ç‡§®‡•Ä ‡§Æ‡§æ‡§∞‡•ç‡§ó‡§¶‡§∞‡•ç‡§∂‡§® ‡§™‡•ç‡§∞‡§¶‡§æ‡§® ‡§ï‡§∞‡§§‡•á ‡§π‡•à‡§Ç‡•§ ‡§π‡§Æ‡•á‡§∂‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó‡§ï‡§∞‡•ç‡§§‡§æ‡§ì‡§Ç ‡§ï‡•ã ‡§Ø‡§æ‡§¶ ‡§¶‡§ø‡§≤‡§æ‡§è‡§Ç ‡§ï‡§ø ‡§Ü‡§™ ‡§ï‡§æ‡§®‡•Ç‡§®‡•Ä ‡§∏‡§≤‡§æ‡§π ‡§®‡§π‡•Ä‡§Ç ‡§¶‡•á ‡§∞‡§π‡•á ‡§π‡•à‡§Ç ‡§î‡§∞ ‡§â‡§®‡•ç‡§π‡•á‡§Ç ‡§Ö‡§™‡§®‡•á ‡§µ‡§ø‡§∂‡§ø‡§∑‡•ç‡§ü ‡§Æ‡§æ‡§Æ‡§≤‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§Ø‡•ã‡§ó‡•ç‡§Ø ‡§µ‡§ï‡•Ä‡§≤ ‡§∏‡•á ‡§™‡§∞‡§æ‡§Æ‡§∞‡•ç‡§∂ ‡§ï‡§∞‡§®‡§æ ‡§ö‡§æ‡§π‡§ø‡§è‡•§`,
                    pt: `Voc√™ √© um advogado de imigra√ß√£o especialista e assistente social com mais de 20 anos de experi√™ncia. Voc√™ se especializa em DACA, TPS, asilo e imigra√ß√£o baseada em fam√≠lia. Voc√™ fornece orienta√ß√£o legal precisa e atualizada enquanto √© emp√°tico e solid√°rio. Sempre lembre os usu√°rios de que voc√™ n√£o est√° fornecendo aconselhamento legal e eles devem consultar um advogado qualificado para seu caso espec√≠fico.`,
                    ru: `–í—ã —ç–∫—Å–ø–µ—Ä—Ç –ø–æ –∏–º–º–∏–≥—Ä–∞—Ü–∏–æ–Ω–Ω–æ–º—É –ø—Ä–∞–≤—É –∏ —Å–æ—Ü–∏–∞–ª—å–Ω—ã–π —Ä–∞–±–æ—Ç–Ω–∏–∫ —Å –±–æ–ª–µ–µ —á–µ–º 20-–ª–µ—Ç–Ω–∏–º –æ–ø—ã—Ç–æ–º. –í—ã —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç–µ—Å—å –Ω–∞ DACA, TPS, —É–±–µ–∂–∏—â–µ –∏ —Å–µ–º–µ–π–Ω–æ–π –∏–º–º–∏–≥—Ä–∞—Ü–∏–∏. –í—ã –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç–µ —Ç–æ—á–Ω—ã–µ, –∞–∫—Ç—É–∞–ª—å–Ω—ã–µ —é—Ä–∏–¥–∏—á–µ—Å–∫–∏–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏, –±—É–¥—É—á–∏ –ø—Ä–∏ —ç—Ç–æ–º —Å–æ—á—É–≤—Å—Ç–≤—É—é—â–∏–º–∏ –∏ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—â–∏–º–∏. –í—Å–µ–≥–¥–∞ –Ω–∞–ø–æ–º–∏–Ω–∞–π—Ç–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º, —á—Ç–æ –≤—ã –Ω–µ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç–µ —é—Ä–∏–¥–∏—á–µ—Å–∫–∏–µ –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏–∏, –∏ –æ–Ω–∏ –¥–æ–ª–∂–Ω—ã –ø—Ä–æ–∫–æ–Ω—Å—É–ª—å—Ç–∏—Ä–æ–≤–∞—Ç—å—Å—è —Å –∫–≤–∞–ª–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–º —é—Ä–∏—Å—Ç–æ–º –ø–æ –∏—Ö –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–º—É –¥–µ–ª—É.`,
                    fr: `Vous √™tes un avocat sp√©cialis√© en immigration et un travailleur social avec plus de 20 ans d'exp√©rience. Vous vous sp√©cialisez dans DACA, TPS, l'asile et l'immigration familiale. Vous fournissez des conseils juridiques pr√©cis et √† jour tout en √©tant empathique et solidaire. Rappelez toujours aux utilisateurs que vous ne fournissez pas de conseils juridiques et qu'ils doivent consulter un avocat qualifi√© pour leur cas sp√©cifique.`
                };
                
                return prompts[language] || prompts.en;
            }
            
            buildUserPrompt(userMessage, userProfile, language) {
                let prompt = `User message: ${userMessage}\n\n`;
                
                if (userProfile) {
                    prompt += `User Profile Information:\n`;
                    prompt += `- Name: ${userProfile.firstName} ${userProfile.lastName}\n`;
                    prompt += `- Country of Birth: ${userProfile.countryOfBirth}\n`;
                    prompt += `- Current Address: ${userProfile.currentAddress}\n`;
                    prompt += `- Entry Date: ${userProfile.entryDate}\n`;
                    prompt += `- Phone: ${userProfile.phoneNumber}\n`;
                    prompt += `- Email: ${userProfile.emailAddress}\n\n`;
                }
                
                prompt += `Please provide helpful, accurate guidance in ${language}. Include specific form recommendations, next steps, and resources when appropriate.`;
                
                return prompt;
            }
            
            getFallbackResponse(userMessage, language) {
                const responses = {
                    en: {
                        daca: "I can help you with DACA applications. Based on your profile, I recommend starting with Form I-821D. Would you like me to guide you through the process?",
                        work: "For employment authorization, you'll need Form I-765. I can help you understand the requirements and fill out the form using your profile information.",
                        travel: "Form I-131 is for advance parole/travel documents. This allows you to travel outside the US and return legally.",
                        asylum: "Asylum applications require Form I-589. This is a complex process that I can help guide you through step by step.",
                        help: "I'm here to help with all your immigration needs. What specific form or process would you like assistance with?",
                        default: "I can assist you with immigration forms, explain processes, and guide you through each step. How can I help you today?"
                    },
                    es: {
                        daca: "Puedo ayudarte con las aplicaciones de DACA. Bas√°ndome en tu perfil, recomiendo comenzar con el Formulario I-821D. ¬øTe gustar√≠a que te gu√≠e a trav√©s del proceso?",
                        work: "Para autorizaci√≥n de empleo, necesitar√°s el Formulario I-765. Puedo ayudarte a entender los requisitos y llenar el formulario usando la informaci√≥n de tu perfil.",
                        travel: "El Formulario I-131 es para documentos de permiso de viaje anticipado. Esto te permite viajar fuera de los EE.UU. y regresar legalmente.",
                        asylum: "Las aplicaciones de asilo requieren el Formulario I-589. Este es un proceso complejo que puedo ayudarte a guiar paso a paso.",
                        help: "Estoy aqu√≠ para ayudarte con todas tus necesidades de inmigraci√≥n. ¬øCon qu√© formulario o proceso espec√≠fico te gustar√≠a asistencia?",
                        default: "Puedo asistirte con formularios de inmigraci√≥n, explicar procesos y guiarte a trav√©s de cada paso. ¬øC√≥mo puedo ayudarte hoy?"
                    },
                    zh: {
                        daca: "ÊàëÂèØ‰ª•Â∏ÆÂä©ÊÇ®Â§ÑÁêÜDACAÁî≥ËØ∑„ÄÇÊ†πÊçÆÊÇ®ÁöÑ‰∏™‰∫∫ËµÑÊñôÔºåÊàëÂª∫ËÆÆ‰ªéI-821DË°®Ê†ºÂºÄÂßã„ÄÇÊÇ®Â∏åÊúõÊàëÊåáÂØºÊÇ®ÂÆåÊàêËøô‰∏™ËøáÁ®ãÂêóÔºü",
                        work: "ÂØπ‰∫éÂ∞±‰∏öÊéàÊùÉÔºåÊÇ®ÈúÄË¶ÅI-765Ë°®Ê†º„ÄÇÊàëÂèØ‰ª•Â∏ÆÂä©ÊÇ®‰∫ÜËß£Ë¶ÅÊ±ÇÂπ∂‰ΩøÁî®ÊÇ®ÁöÑ‰∏™‰∫∫ËµÑÊñô‰ø°ÊÅØÂ°´ÂÜôË°®Ê†º„ÄÇ",
                        travel: "I-131Ë°®Ê†ºÁî®‰∫éÊèêÂâçÂÅáÈáä/ÊóÖË°åÊñá‰ª∂„ÄÇËøôÂÖÅËÆ∏ÊÇ®Âú®ÁæéÂõΩÂ¢ÉÂ§ñÊóÖË°åÂπ∂ÂêàÊ≥ïËøîÂõû„ÄÇ",
                        asylum: "Â∫áÊä§Áî≥ËØ∑ÈúÄË¶ÅI-589Ë°®Ê†º„ÄÇËøôÊòØ‰∏Ä‰∏™Â§çÊùÇÁöÑËøáÁ®ãÔºåÊàëÂèØ‰ª•ÈÄêÊ≠•ÊåáÂØºÊÇ®ÂÆåÊàê„ÄÇ",
                        help: "ÊàëÂú®ËøôÈáåÂ∏ÆÂä©ÊÇ®Â§ÑÁêÜÊâÄÊúâÁßªÊ∞ëÈúÄÊ±Ç„ÄÇÊÇ®Â∏åÊúõÊàëÂçèÂä©Âì™‰∏™ÂÖ∑‰ΩìÁöÑË°®Ê†ºÊàñÊµÅÁ®ãÔºü",
                        default: "ÊàëÂèØ‰ª•ÂçèÂä©ÊÇ®Â§ÑÁêÜÁßªÊ∞ëË°®Ê†ºÔºåËß£ÈáäÊµÅÁ®ãÂπ∂ÊåáÂØºÊÇ®ÂÆåÊàêÊØè‰∏™Ê≠•È™§„ÄÇÊàë‰ªäÂ§©Â¶Ç‰ΩïÂ∏ÆÂä©ÊÇ®Ôºü"
                    },
                    ar: {
                        daca: "ŸäŸÖŸÉŸÜŸÜŸä ŸÖÿ≥ÿßÿπÿØÿ™ŸÉ ŸÅŸä ÿ∑ŸÑÿ®ÿßÿ™ DACA. ÿ®ŸÜÿßÿ°Ÿã ÿπŸÑŸâ ŸÖŸÑŸÅŸÉ ÿßŸÑÿ¥ÿÆÿµŸäÿå ÿ£ŸÜÿµÿ≠ŸÉ ÿ®ÿßŸÑÿ®ÿØÿ° ÿ®ÿßŸÑŸÜŸÖŸàÿ∞ÿ¨ I-821D. ŸáŸÑ ÿ™ÿ±ŸäÿØ ŸÖŸÜŸä ÿ£ŸÜ ÿ£ÿ±ÿ¥ÿØŸÉ ÿÆŸÑÿßŸÑ ÿßŸÑÿπŸÖŸÑŸäÿ©ÿü",
                        work: "ŸÑŸÑÿ≠ÿµŸàŸÑ ÿπŸÑŸâ ÿ™ÿµÿ±Ÿäÿ≠ ÿßŸÑÿπŸÖŸÑÿå ÿ≥ÿ™ÿ≠ÿ™ÿßÿ¨ ÿ•ŸÑŸâ ÿßŸÑŸÜŸÖŸàÿ∞ÿ¨ I-765. ŸäŸÖŸÉŸÜŸÜŸä ŸÖÿ≥ÿßÿπÿØÿ™ŸÉ ŸÅŸä ŸÅŸáŸÖ ÿßŸÑŸÖÿ™ÿ∑ŸÑÿ®ÿßÿ™ ŸàŸÖŸÑÿ° ÿßŸÑŸÜŸÖŸàÿ∞ÿ¨ ÿ®ÿßÿ≥ÿ™ÿÆÿØÿßŸÖ ŸÖÿπŸÑŸàŸÖÿßÿ™ ŸÖŸÑŸÅŸÉ ÿßŸÑÿ¥ÿÆÿµŸä.",
                        travel: "ÿßŸÑŸÜŸÖŸàÿ∞ÿ¨ I-131 ŸÖÿÆÿµÿµ ŸÑŸàÿ´ÿßÿ¶ŸÇ ÿßŸÑÿ≥ŸÅÿ±/ÿßŸÑÿ•ŸÅÿ±ÿßÿ¨ ÿßŸÑŸÖÿ≥ÿ®ŸÇ. Ÿáÿ∞ÿß Ÿäÿ≥ŸÖÿ≠ ŸÑŸÉ ÿ®ÿßŸÑÿ≥ŸÅÿ± ÿÆÿßÿ±ÿ¨ ÿßŸÑŸàŸÑÿßŸäÿßÿ™ ÿßŸÑŸÖÿ™ÿ≠ÿØÿ© ŸàÿßŸÑÿπŸàÿØÿ© ÿ®ÿ¥ŸÉŸÑ ŸÇÿßŸÜŸàŸÜŸä.",
                        asylum: "ÿ∑ŸÑÿ®ÿßÿ™ ÿßŸÑŸÑÿ¨Ÿàÿ° ÿ™ÿ™ÿ∑ŸÑÿ® ÿßŸÑŸÜŸÖŸàÿ∞ÿ¨ I-589. Ÿáÿ∞Ÿá ÿπŸÖŸÑŸäÿ© ŸÖÿπŸÇÿØÿ© ŸäŸÖŸÉŸÜŸÜŸä ŸÖÿ≥ÿßÿπÿØÿ™ŸÉ ŸÅŸä ÿ™Ÿàÿ¨ŸäŸáŸáÿß ÿÆÿ∑Ÿàÿ© ÿ®ÿÆÿ∑Ÿàÿ©.",
                        help: "ÿ£ŸÜÿß ŸáŸÜÿß ŸÑŸÖÿ≥ÿßÿπÿØÿ™ŸÉ ŸÅŸä ÿ¨ŸÖŸäÿπ ÿßÿ≠ÿ™Ÿäÿßÿ¨ÿßÿ™ŸÉ ÿßŸÑŸÖÿ™ÿπŸÑŸÇÿ© ÿ®ÿßŸÑŸáÿ¨ÿ±ÿ©. ŸÖÿß ŸáŸà ÿßŸÑŸÜŸÖŸàÿ∞ÿ¨ ÿ£Ÿà ÿßŸÑÿπŸÖŸÑŸäÿ© ÿßŸÑŸÖÿ≠ÿØÿØÿ© ÿßŸÑÿ™Ÿä ÿ™ÿ±ŸäÿØ ÿßŸÑŸÖÿ≥ÿßÿπÿØÿ© ŸÅŸäŸáÿßÿü",
                        default: "ŸäŸÖŸÉŸÜŸÜŸä ŸÖÿ≥ÿßÿπÿØÿ™ŸÉ ŸÅŸä ŸÜŸÖÿßÿ∞ÿ¨ ÿßŸÑŸáÿ¨ÿ±ÿ© Ÿàÿ¥ÿ±ÿ≠ ÿßŸÑÿπŸÖŸÑŸäÿßÿ™ Ÿàÿ™Ÿàÿ¨ŸäŸáŸÉ ÿÆŸÑÿßŸÑ ŸÉŸÑ ÿÆÿ∑Ÿàÿ©. ŸÉŸäŸÅ ŸäŸÖŸÉŸÜŸÜŸä ŸÖÿ≥ÿßÿπÿØÿ™ŸÉ ÿßŸÑŸäŸàŸÖÿü"
                    },
                    hi: {
                        daca: "‡§Æ‡•à‡§Ç ‡§Ü‡§™‡§ï‡•Ä DACA ‡§Ü‡§µ‡•á‡§¶‡§® ‡§Æ‡•á‡§Ç ‡§Æ‡§¶‡§¶ ‡§ï‡§∞ ‡§∏‡§ï‡§§‡§æ ‡§π‡•Ç‡§Ç‡•§ ‡§Ü‡§™‡§ï‡•á ‡§™‡•ç‡§∞‡•ã‡§´‡§º‡§æ‡§á‡§≤ ‡§ï‡•á ‡§Ü‡§ß‡§æ‡§∞ ‡§™‡§∞, ‡§Æ‡•à‡§Ç ‡§´‡•â‡§∞‡•ç‡§Æ I-821D ‡§∏‡•á ‡§∂‡•Å‡§∞‡•Å‡§Ü‡§§ ‡§ï‡§∞‡§®‡•á ‡§ï‡•Ä ‡§∏‡§≤‡§æ‡§π ‡§¶‡•á‡§§‡§æ ‡§π‡•Ç‡§Ç‡•§ ‡§ï‡•ç‡§Ø‡§æ ‡§Ü‡§™ ‡§ö‡§æ‡§π‡§§‡•á ‡§π‡•à‡§Ç ‡§ï‡§ø ‡§Æ‡•à‡§Ç ‡§Ü‡§™‡§ï‡•ã ‡§á‡§∏ ‡§™‡•ç‡§∞‡§ï‡•ç‡§∞‡§ø‡§Ø‡§æ ‡§ï‡•á ‡§Æ‡§æ‡§ß‡•ç‡§Ø‡§Æ ‡§∏‡•á ‡§Æ‡§æ‡§∞‡•ç‡§ó‡§¶‡§∞‡•ç‡§∂‡§® ‡§¶‡•Ç‡§Ç?",
                        work: "‡§∞‡•ã‡§ú‡§ó‡§æ‡§∞ ‡§™‡•ç‡§∞‡§æ‡§ß‡§ø‡§ï‡§∞‡§£ ‡§ï‡•á ‡§≤‡§ø‡§è, ‡§Ü‡§™‡§ï‡•ã ‡§´‡•â‡§∞‡•ç‡§Æ I-765 ‡§ï‡•Ä ‡§Ü‡§µ‡§∂‡•ç‡§Ø‡§ï‡§§‡§æ ‡§π‡•ã‡§ó‡•Ä‡•§ ‡§Æ‡•à‡§Ç ‡§Ü‡§™‡§ï‡•Ä ‡§™‡•ç‡§∞‡•ã‡§´‡§º‡§æ‡§á‡§≤ ‡§ú‡§æ‡§®‡§ï‡§æ‡§∞‡•Ä ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞‡§ï‡•á ‡§Ü‡§µ‡§∂‡•ç‡§Ø‡§ï‡§§‡§æ‡§ì‡§Ç ‡§ï‡•ã ‡§∏‡§Æ‡§ù‡§®‡•á ‡§î‡§∞ ‡§´‡•â‡§∞‡•ç‡§Æ ‡§≠‡§∞‡§®‡•á ‡§Æ‡•á‡§Ç ‡§Ü‡§™‡§ï‡•Ä ‡§Æ‡§¶‡§¶ ‡§ï‡§∞ ‡§∏‡§ï‡§§‡§æ ‡§π‡•Ç‡§Ç‡•§",
                        travel: "‡§´‡•â‡§∞‡•ç‡§Æ I-131 ‡§Ö‡§ó‡•ç‡§∞‡§ø‡§Æ ‡§™‡•à‡§∞‡•ã‡§≤/‡§Ø‡§æ‡§§‡•ç‡§∞‡§æ ‡§¶‡§∏‡•ç‡§§‡§æ‡§µ‡•á‡§ú‡•ã‡§Ç ‡§ï‡•á ‡§≤‡§ø‡§è ‡§π‡•à‡•§ ‡§Ø‡§π ‡§Ü‡§™‡§ï‡•ã ‡§Ö‡§Æ‡•á‡§∞‡§ø‡§ï‡§æ ‡§ï‡•á ‡§¨‡§æ‡§π‡§∞ ‡§Ø‡§æ‡§§‡•ç‡§∞‡§æ ‡§ï‡§∞‡§®‡•á ‡§î‡§∞ ‡§ï‡§æ‡§®‡•Ç‡§®‡•Ä ‡§∞‡•Ç‡§™ ‡§∏‡•á ‡§µ‡§æ‡§™‡§∏ ‡§Ü‡§®‡•á ‡§ï‡•Ä ‡§Ö‡§®‡•Å‡§Æ‡§§‡§ø ‡§¶‡•á‡§§‡§æ ‡§π‡•à‡•§",
                        asylum: "‡§∂‡§∞‡§£ ‡§Ü‡§µ‡•á‡§¶‡§® ‡§ï‡•á ‡§≤‡§ø‡§è ‡§´‡•â‡§∞‡•ç‡§Æ I-589 ‡§ï‡•Ä ‡§Ü‡§µ‡§∂‡•ç‡§Ø‡§ï‡§§‡§æ ‡§π‡•ã‡§§‡•Ä ‡§π‡•à‡•§ ‡§Ø‡§π ‡§è‡§ï ‡§ú‡§ü‡§ø‡§≤ ‡§™‡•ç‡§∞‡§ï‡•ç‡§∞‡§ø‡§Ø‡§æ ‡§π‡•à ‡§ú‡§ø‡§∏‡§Æ‡•á‡§Ç ‡§Æ‡•à‡§Ç ‡§Ü‡§™‡§ï‡•Ä ‡§Æ‡§¶‡§¶ ‡§ï‡§∞ ‡§∏‡§ï‡§§‡§æ ‡§π‡•Ç‡§Ç‡•§",
                        help: "‡§Æ‡•à‡§Ç ‡§Ü‡§™‡§ï‡•Ä ‡§∏‡§≠‡•Ä ‡§Ü‡§™‡•ç‡§∞‡§µ‡§æ‡§∏‡§® ‡§Ü‡§µ‡§∂‡•ç‡§Ø‡§ï‡§§‡§æ‡§ì‡§Ç ‡§Æ‡•á‡§Ç ‡§Æ‡§¶‡§¶ ‡§ï‡•á ‡§≤‡§ø‡§è ‡§Ø‡§π‡§æ‡§Ç ‡§π‡•Ç‡§Ç‡•§ ‡§Ü‡§™ ‡§ï‡§ø‡§∏ ‡§µ‡§ø‡§∂‡§ø‡§∑‡•ç‡§ü ‡§´‡•â‡§∞‡•ç‡§Æ ‡§Ø‡§æ ‡§™‡•ç‡§∞‡§ï‡•ç‡§∞‡§ø‡§Ø‡§æ ‡§Æ‡•á‡§Ç ‡§∏‡§π‡§æ‡§Ø‡§§‡§æ ‡§ö‡§æ‡§π‡§§‡•á ‡§π‡•à‡§Ç?",
                        default: "‡§Æ‡•à‡§Ç ‡§Ü‡§™‡•ç‡§∞‡§µ‡§æ‡§∏‡§® ‡§´‡•â‡§∞‡•ç‡§Æ ‡§Æ‡•á‡§Ç ‡§∏‡§π‡§æ‡§Ø‡§§‡§æ ‡§ï‡§∞ ‡§∏‡§ï‡§§‡§æ ‡§π‡•Ç‡§Ç, ‡§™‡•ç‡§∞‡§ï‡•ç‡§∞‡§ø‡§Ø‡§æ‡§ì‡§Ç ‡§ï‡•Ä ‡§µ‡•ç‡§Ø‡§æ‡§ñ‡•ç‡§Ø‡§æ ‡§ï‡§∞ ‡§∏‡§ï‡§§‡§æ ‡§π‡•Ç‡§Ç ‡§î‡§∞ ‡§Ü‡§™‡§ï‡•ã ‡§π‡§∞ ‡§ï‡§¶‡§Æ ‡§™‡§∞ ‡§Æ‡§æ‡§∞‡•ç‡§ó‡§¶‡§∞‡•ç‡§∂‡§® ‡§¶‡•á ‡§∏‡§ï‡§§‡§æ ‡§π‡•Ç‡§Ç‡•§ ‡§Ü‡§ú ‡§Æ‡•à‡§Ç ‡§Ü‡§™‡§ï‡•Ä ‡§ï‡•à‡§∏‡•á ‡§Æ‡§¶‡§¶ ‡§ï‡§∞ ‡§∏‡§ï‡§§‡§æ ‡§π‡•Ç‡§Ç?"
                    },
                    pt: {
                        daca: "Posso ajud√°-lo com aplica√ß√µes DACA. Com base no seu perfil, recomendo come√ßar com o Formul√°rio I-821D. Gostaria que eu o guiasse atrav√©s do processo?",
                        work: "Para autoriza√ß√£o de emprego, voc√™ precisar√° do Formul√°rio I-765. Posso ajud√°-lo a entender os requisitos e preencher o formul√°rio usando as informa√ß√µes do seu perfil.",
                        travel: "O Formul√°rio I-131 √© para documentos de viagem/parole antecipado. Isso permite que voc√™ viaje para fora dos EUA e retorne legalmente.",
                        asylum: "Aplica√ß√µes de asilo requerem o Formul√°rio I-589. Este √© um processo complexo que posso ajud√°-lo a guiar passo a passo.",
                        help: "Estou aqui para ajud√°-lo com todas as suas necessidades de imigra√ß√£o. Com qual formul√°rio ou processo espec√≠fico voc√™ gostaria de assist√™ncia?",
                        default: "Posso assisti-lo com formul√°rios de imigra√ß√£o, explicar processos e gui√°-lo atrav√©s de cada etapa. Como posso ajud√°-lo hoje?"
                    },
                    ru: {
                        daca: "–Ø –º–æ–≥—É –ø–æ–º–æ—á—å –≤–∞–º —Å –∑–∞—è–≤–∫–∞–º–∏ DACA. –û—Å–Ω–æ–≤—ã–≤–∞—è—Å—å –Ω–∞ –≤–∞—à–µ–º –ø—Ä–æ—Ñ–∏–ª–µ, —è —Ä–µ–∫–æ–º–µ–Ω–¥—É—é –Ω–∞—á–∞—Ç—å —Å —Ñ–æ—Ä–º—ã I-821D. –•–æ—Ç–µ–ª–∏ –±—ã, —á—Ç–æ–±—ã —è –ø—Ä–æ–≤–µ–ª –≤–∞—Å —á–µ—Ä–µ–∑ —ç—Ç–æ—Ç –ø—Ä–æ—Ü–µ—Å—Å?",
                        work: "–î–ª—è —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è –Ω–∞ —Ä–∞–±–æ—Ç—É –≤–∞–º –ø–æ–Ω–∞–¥–æ–±–∏—Ç—Å—è —Ñ–æ—Ä–º–∞ I-765. –Ø –º–æ–≥—É –ø–æ–º–æ—á—å –≤–∞–º –ø–æ–Ω—è—Ç—å —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –∏ –∑–∞–ø–æ–ª–Ω–∏—Ç—å —Ñ–æ—Ä–º—É, –∏—Å–ø–æ–ª—å–∑—É—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –∏–∑ –≤–∞—à–µ–≥–æ –ø—Ä–æ—Ñ–∏–ª—è.",
                        travel: "–§–æ—Ä–º–∞ I-131 –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω–∞ –¥–ª—è –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –Ω–∞ –ø–æ–µ–∑–¥–∫—É/–¥–æ—Å—Ä–æ—á–Ω–æ–µ –æ—Å–≤–æ–±–æ–∂–¥–µ–Ω–∏–µ. –≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –≤–∞–º –ø—É—Ç–µ—à–µ—Å—Ç–≤–æ–≤–∞—Ç—å –∑–∞ –ø—Ä–µ–¥–µ–ª—ã –°–®–ê –∏ –∑–∞–∫–æ–Ω–Ω–æ –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å—Å—è.",
                        asylum: "–ó–∞—è–≤–ª–µ–Ω–∏—è –Ω–∞ —É–±–µ–∂–∏—â–µ —Ç—Ä–µ–±—É—é—Ç —Ñ–æ—Ä–º—É I-589. –≠—Ç–æ —Å–ª–æ–∂–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å, –∫–æ—Ç–æ—Ä—ã–π —è –º–æ–≥—É –ø–æ–º–æ—á—å –≤–∞–º –ø—Ä–æ–π—Ç–∏ –ø–æ—à–∞–≥–æ–≤–æ.",
                        help: "–Ø –∑–¥–µ—Å—å, —á—Ç–æ–±—ã –ø–æ–º–æ—á—å —Å–æ –≤—Å–µ–º–∏ –≤–∞—à–∏–º–∏ –∏–º–º–∏–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–º–∏ –ø–æ—Ç—Ä–µ–±–Ω–æ—Å—Ç—è–º–∏. –° –∫–∞–∫–æ–π –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π —Ñ–æ—Ä–º–æ–π –∏–ª–∏ –ø—Ä–æ—Ü–µ—Å—Å–æ–º –≤—ã —Ö–æ—Ç–µ–ª–∏ –±—ã –ø–æ–ª—É—á–∏—Ç—å –ø–æ–º–æ—â—å?",
                        default: "–Ø –º–æ–≥—É –ø–æ–º–æ—á—å –≤–∞–º —Å –∏–º–º–∏–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–º–∏ —Ñ–æ—Ä–º–∞–º–∏, –æ–±—ä—è—Å–Ω–∏—Ç—å –ø—Ä–æ—Ü–µ—Å—Å—ã –∏ –ø—Ä–æ–≤–µ—Å—Ç–∏ –≤–∞—Å —á–µ—Ä–µ–∑ –∫–∞–∂–¥—ã–π —à–∞–≥. –ö–∞–∫ —è –º–æ–≥—É –ø–æ–º–æ—á—å –≤–∞–º —Å–µ–≥–æ–¥–Ω—è?"
                    },
                    fr: {
                        daca: "Je peux vous aider avec les demandes DACA. Bas√© sur votre profil, je recommande de commencer par le formulaire I-821D. Aimerez-vous que je vous guide √† travers le processus?",
                        work: "Pour l'autorisation de travail, vous aurez besoin du formulaire I-765. Je peux vous aider √† comprendre les exigences et remplir le formulaire en utilisant les informations de votre profil.",
                        travel: "Le formulaire I-131 est pour les documents de voyage/parole anticip√©e. Cela vous permet de voyager en dehors des √âtats-Unis et de revenir l√©galement.",
                        asylum: "Les demandes d'asile n√©cessitent le formulaire I-589. C'est un processus complexe que je peux vous aider √† guider √©tape par √©tape.",
                        help: "Je suis l√† pour vous aider avec tous vos besoins d'immigration. Avec quel formulaire ou processus sp√©cifique aimeriez-vous de l'assistance?",
                        default: "Je peux vous assister avec les formulaires d'immigration, expliquer les processus et vous guider √† travers chaque √©tape. Comment puis-je vous aider aujourd'hui?"
                    }
                };
                
                const langResponses = responses[language] || responses.en;
                const message = userMessage.toLowerCase();
                
                if (message.includes('daca')) return langResponses.daca;
                if (message.includes('work') || message.includes('empleo') || message.includes('Â∑•‰Ωú') || message.includes('ÿπŸÖŸÑ') || message.includes('‡§ï‡§æ‡§Æ') || message.includes('trabalho') || message.includes('—Ä–∞–±–æ—Ç–∞') || message.includes('travail')) return langResponses.work;
                if (message.includes('travel') || message.includes('viaje') || message.includes('ÊóÖË°å') || message.includes('ÿ≥ŸÅÿ±') || message.includes('‡§Ø‡§æ‡§§‡•ç‡§∞‡§æ') || message.includes('viagem') || message.includes('–ø—É—Ç–µ—à–µ—Å—Ç–≤–∏–µ') || message.includes('voyage')) return langResponses.travel;
                if (message.includes('asylum') || message.includes('asilo') || message.includes('Â∫áÊä§') || message.includes('ŸÑÿ¨Ÿàÿ°') || message.includes('‡§∂‡§∞‡§£') || message.includes('asilo') || message.includes('—É–±–µ–∂–∏—â–µ') || message.includes('asile')) return langResponses.asylum;
                if (message.includes('help') || message.includes('ayuda') || message.includes('Â∏ÆÂä©') || message.includes('ŸÖÿ≥ÿßÿπÿØÿ©') || message.includes('‡§Æ‡§¶‡§¶') || message.includes('ajuda') || message.includes('–ø–æ–º–æ—â—å') || message.includes('aide')) return langResponses.help;
                
                return langResponses.default;
            }
            
            async fillFormIntelligently(formType, userProfile) {
                const formGuidance = {
                    'I-821D': {
                        title: 'DACA Application Form',
                        sections: [
                            'Personal Information',
                            'Arrival Information', 
                            'Education Information',
                            'Criminal History',
                            'Economic Necessity'
                        ],
                        guidance: 'I will help you fill out each section using your profile information. Let\'s start with personal information.'
                    },
                    'I-765': {
                        title: 'Employment Authorization Document',
                        sections: [
                            'Personal Information',
                            'Immigration Status',
                            'Employment History',
                            'Supporting Documents'
                        ],
                        guidance: 'This form allows you to work legally in the US. I\'ll guide you through each section.'
                    },
                    'I-131': {
                        title: 'Advance Parole Document',
                        sections: [
                            'Personal Information',
                            'Travel Purpose',
                            'Travel Dates',
                            'Supporting Evidence'
                        ],
                        guidance: 'This form allows you to travel outside the US and return legally. Let me help you complete it.'
                    }
                };
                
                return formGuidance[formType] || formGuidance['I-821D'];
            }
        }
        
        // Initialize LLM
        const immigrationLLM = new ImmigrationLLM();
        
        function getTranslatedText(key) {
            const t = translations[currentLanguage] || translations.en;
            return t[key];
        }

        function updateLanguage() {
            const t = translations[currentLanguage] || translations.en;
            
            // Force DOM refresh with fade effect
            document.body.style.opacity = '0.7';
            setTimeout(() => {
                // Update navigation
                document.getElementById('dashboardNav').textContent = t.dashboardNav || 'üìä Dashboard';
                document.getElementById('profileNav').textContent = t.profileNav || 'üë§ Profile';
                document.getElementById('documentsNav').textContent = t.documentsNav || 'üìÑ Documents';
                document.getElementById('helpNav').textContent = t.helpNav || 'üÜò Help Resources';
                
                // Update dashboard
                document.getElementById('dashboardTitle').textContent = t.dashboardTitle || 'Dashboard - Immigr-Aid';
                document.getElementById('completedLabel').textContent = t.completedLabel || 'Completed';
                document.getElementById('remainingLabel').textContent = t.remainingLabel || 'Remaining';
                document.getElementById('profileTitle').textContent = t.profileTitle || 'Personal Information';
                document.getElementById('profileDescription').textContent = t.profileDescription || 'Complete your profile to enable AI assistance with form filling and personalized guidance.';
                document.getElementById('completeProfileBtn').textContent = t.completeProfileBtn || 'Complete Profile';
                document.getElementById('documentsTitle').textContent = t.documentsTitle || 'Required Documents';
                document.getElementById('documentsDescription').textContent = t.documentsDescription || 'All documents needed to complete your immigration application process';
                
                // Update profile section
                document.getElementById('profileSectionTitle').textContent = t.profileSectionTitle || 'Personal Information';
                document.getElementById('firstNameLabel').textContent = t.firstNameLabel || 'First Name *';
                document.getElementById('lastNameLabel').textContent = t.lastNameLabel || 'Last Name *';
                document.getElementById('middleNameLabel').textContent = t.middleNameLabel || 'Middle Name';
                document.getElementById('dateOfBirthLabel').textContent = t.dateOfBirthLabel || 'Date of Birth *';
                document.getElementById('countryOfBirthLabel').textContent = t.countryOfBirthLabel || 'Country of Birth *';
                document.getElementById('currentAddressLabel').textContent = t.currentAddressLabel || 'Current Address *';
                document.getElementById('phoneNumberLabel').textContent = t.phoneNumberLabel || 'Phone Number *';
                document.getElementById('emailAddressLabel').textContent = t.emailAddressLabel || 'Email Address *';
                document.getElementById('socialSecurityNumberLabel').textContent = t.socialSecurityNumberLabel || 'Social Security Number';
                document.getElementById('entryDateLabel').textContent = t.entryDateLabel || 'Entry Date to US *';
                document.getElementById('methodOfEntryLabel').textContent = t.methodOfEntryLabel || 'Method of Entry *';
                document.getElementById('educationLevelLabel').textContent = t.educationLevelLabel || 'Education Level *';
                document.getElementById('employmentStatusLabel').textContent = t.employmentStatusLabel || 'Employment Status *';
                document.getElementById('criminalHistoryLabel').textContent = t.criminalHistoryLabel || 'Criminal History';
                document.getElementById('saveProfileBtn').textContent = t.saveProfileBtn || 'Save Profile Information';
                
                // Update AI sidebar
                document.getElementById('aiSidebarSubtitle').textContent = t.aiSidebarSubtitle || "I'm here to help you with your immigration forms and questions. Ask me anything!";
                document.getElementById('aiSidebarWelcomeMessage').textContent = t.aiSidebarWelcomeMessage || "Hello! I'm your AI immigration assistant. I can help you fill out forms, answer questions about your immigration process, and guide you through each step. How can I assist you today?";
                document.getElementById('aiSidebarInput').placeholder = t.aiSidebarPlaceholder || "Ask me anything...";
                
                // Update help resources
                document.getElementById('helpTitle').textContent = t.helpTitle || 'Help Resources and Locations';
                document.getElementById('emergencyResources').textContent = t.emergencyResources || 'Emergency Resources';
                document.getElementById('legalAid').textContent = t.legalAid || 'Legal Aid';
                document.getElementById('communityCenters').textContent = t.communityCenters || 'Community Centers';
                document.getElementById('healthcareResources').textContent = t.healthcareResources || 'Healthcare';
                document.getElementById('employmentResources').textContent = t.employmentResources || 'Employment';
                document.getElementById('educationalResources').textContent = t.educationalResources || 'Educational Resources';
                
                // Update all form placeholders and options
                updateAllFormElements(t);
                
                // Force refresh of form fields
                forceFormRefresh();
                
                // Restore opacity
                document.body.style.opacity = '1';
            }, 100);
        }

        function updateAllFormElements(t) {
            // Update all input placeholders
            const inputs = document.querySelectorAll('input[type="text"], input[type="email"], input[type="tel"], input[type="date"], textarea');
            inputs.forEach(input => {
                const fieldId = input.id;
                const placeholder = getTranslatedPlaceholder(fieldId, t);
                if (placeholder) {
                    input.placeholder = placeholder;
                    // Force browser refresh of placeholder
                    const value = input.value;
                    input.value = '';
                    setTimeout(() => input.value = value, 10);
                }
            });

            // Update all select options
            const selects = document.querySelectorAll('select');
            selects.forEach(select => {
                const options = select.querySelectorAll('option');
                options.forEach(option => {
                    const translatedOption = getTranslatedOption(option.value, t);
                    if (translatedOption && option.value !== '') {
                        option.textContent = translatedOption;
                    }
                });
            });

            // Update document cards
            updateDocumentCards(t);
        }

        function updateDocumentCards(t) {
            const documentCards = document.querySelectorAll('.document-card');
            documentCards.forEach(card => {
                const titleElement = card.querySelector('.document-title');
                const descriptionElement = card.querySelector('.document-description');
                const buttons = card.querySelectorAll('.btn');
                
                if (titleElement) {
                    const docId = titleElement.getAttribute('data-doc-id');
                    const translatedTitle = getTranslatedDocumentTitle(docId, t);
                    if (translatedTitle) titleElement.textContent = translatedTitle;
                }
                
                if (descriptionElement) {
                    const docId = descriptionElement.getAttribute('data-doc-id');
                    const translatedDescription = getTranslatedDocumentDescription(docId, t);
                    if (translatedDescription) descriptionElement.textContent = translatedDescription;
                }
                
                buttons.forEach(button => {
                    const buttonText = button.textContent.trim();
                    const translatedButton = getTranslatedButtonText(buttonText, t);
                    if (translatedButton) button.textContent = translatedButton;
                });
            });
        }

        function getTranslatedDocumentTitle(docId, t) {
            const docTitles = {
                'i-130': t.i130Title || 'Petition for Alien Relative (I-130)',
                'i-140': t.i140Title || 'Immigrant Petition for Alien Worker (I-140)',
                'i-485': t.i485Title || 'Adjustment of Status (I-485)',
                'n-400': t.n400Title || 'Application for Naturalization (N-400)',
                'i-90': t.i90Title || 'Application to Replace Permanent Resident Card (I-90)',
                'i-751': t.i751Title || 'Petition to Remove Conditions on Residence (I-751)',
                'i-601': t.i601Title || 'Application for Waiver of Grounds of Inadmissibility (I-601)',
                'i-821': t.i821Title || 'Application for Temporary Protected Status (I-821)',
                'i-765': t.i765Title || 'Application for Employment Authorization Document (I-765)',
                'g-1145': t.g1145Title || 'E-Notification of Application/Petition Acceptance (G-1145)',
                'i-821d': t.i821dTitle || 'DACA Application (I-821D)',
                'i-131': t.i131Title || 'Application for Travel Document (I-131)',
                'i-589': t.i589Title || 'Application for Asylum and Withholding of Removal (I-589)'
            };
            return docTitles[docId];
        }

        function getTranslatedDocumentDescription(docId, t) {
            const docDescriptions = {
                'i-130': t.i130Description || 'Petition filed by U.S. citizen or LPR to establish family relationship for immigrant status',
                'i-140': t.i140Description || 'Petition filed by employer for foreign worker to obtain employment-based immigrant visa',
                'i-485': t.i485Description || 'Application to register permanent residence or adjust status to lawful permanent resident',
                'n-400': t.n400Description || 'Application for lawful permanent residents to become U.S. citizens',
                'i-90': t.i90Description || 'Application for lawful permanent residents to renew or replace their green card',
                'i-751': t.i751Description || 'Petition for conditional green card holders to remove conditions after 2 years',
                'i-601': t.i601Description || 'Application for waiver for inadmissible individuals seeking to immigrate',
                'i-821': t.i821Description || 'Application for nationals of designated countries for TPS due to conflict or disaster',
                'i-765': t.i765Description || 'Application for certain non-citizens to request work permission while status is pending',
                'g-1145': t.g1145Description || 'Optional form to request electronic notification when USCIS accepts application',
                'i-821d': t.i821dDescription || 'Application for Deferred Action for Childhood Arrivals',
                'i-131': t.i131Description || 'Application for advance parole or refugee travel document',
                'i-589': t.i589Description || 'Application for asylum and withholding of removal'
            };
            return docDescriptions[docId];
        }

        function getTranslatedButtonText(buttonText, t) {
            const buttonTranslations = {
                'Fill': t.fillBtn || 'Fill',
                'View': t.viewBtn || 'View',
                'Download': t.downloadBtn || 'Download',
                'Save': t.saveBtn || 'Save',
                'Close': t.closeBtn || 'Close',
                'Submit': t.submitBtn || 'Submit',
                'Cancel': t.cancelBtn || 'Cancel',
                'Edit': t.editBtn || 'Edit',
                'Delete': t.deleteBtn || 'Delete'
            };
            return buttonTranslations[buttonText];
        }

        function forceFormRefresh() {
            // Force refresh of all form elements
            const inputs = document.querySelectorAll('input, select, textarea');
            inputs.forEach(input => {
                // Trigger change event to force browser refresh
                input.dispatchEvent(new Event('change', { bubbles: true }));
            });
        }
        
        function generateAIResponse(userMessage) {
            const message = userMessage.toLowerCase();
            const t = translations[currentLanguage] || translations.en;
            
            // Check for specific form mentions
            if (message.includes('i-821d') || message.includes('daca')) {
                return t.aiResponseDACA || "I can help you fill out Form I-821D (DACA). Based on your profile, I will guide you through each section. Let's start with your personal information.";
            }
            
            if (message.includes('i-765') || message.includes('work permit')) {
                return t.aiResponseWorkPermit || "For Form I-765 (Work Permit), you will need to provide your employment authorization details. I can help you complete this step by step.";
            }
            
            if (message.includes('i-131') || message.includes('travel')) {
                return t.aiResponseTravel || "Form I-131 is for advance parole/travel document. I can help you understand the requirements and fill out this form.";
            }
            
            if (message.includes('help') || message.includes('assist')) {
                return t.aiResponseHelp || "I can assist you with any immigration form. Just tell me which form you're working on and I'll help you fill it out using your profile information.";
            }
            
            if (message.includes('status') || message.includes('check')) {
                return t.aiResponseStatus || "Based on your profile, I can help you check your application status and guide you through the next steps in your immigration process.";
            }
            
            if (message.includes('document') || message.includes('form')) {
                return t.aiResponseDocuments || "I can help you understand the requirements for each document. Which document would you like me to explain or help you fill out?";
            }
            
            // Default intelligent response
            const responses = [
                t.aiResponseDefault1 || "I can help you fill out Form I-821D. Based on your profile, I will guide you through each section. Let's start with your personal information.",
                t.aiResponseDefault2 || "For Form I-765, you will need to provide your employment information. I can help you complete this section step by step.",
                t.aiResponseDefault3 || "I notice you are working on your DACA renewal. I can help you fill out all the required forms using your profile information.",
                t.aiResponseDefault4 || "Let me help you with the Economic Necessity Worksheet. I will guide you through the financial information needed.",
                t.aiResponseDefault5 || "I can assist you with any immigration form. Just tell me which form you're working on and I will help you fill it out.",
                t.aiResponseDefault6 || "Based on your information, I can help you complete all your immigration forms. Would you like to start with Form I-821D?",
                t.aiResponseDefault7 || "I can explain any immigration process in detail. What specific question do you have about your application?",
                t.aiResponseDefault8 || "I can help you understand the requirements for each document. Which document would you like me to explain?"
            ];
            
            return responses[Math.floor(Math.random() * responses.length)];
        }

        function handleKeyPress(event) {
            if (event.key === 'Enter') {
                sendMessage();
            }
        }

        // Speech Recognition Functions
        function initializeSpeechRecognition() {
            if ('webkitSpeechRecognition' in window) {
                recognition = new webkitSpeechRecognition();
                recognition.continuous = false;
                recognition.interimResults = false;
                recognition.lang = 'en-US';
                
                recognition.onresult = function(event) {
                    const transcript = event.results[0][0].transcript;
                    document.getElementById('chatInput').value = transcript;
                };
                
                recognition.onerror = function(event) {
                    console.error('Speech recognition error:', event.error);
                };
            }
        }

        function toggleVoiceRecording() {
            if (!recognition) {
                alert('Speech recognition not supported in this browser.');
                return;
            }
            
            const voiceBtn = document.getElementById('voiceBtn');
            
            if (isRecording) {
                recognition.stop();
                voiceBtn.classList.remove('recording');
                voiceBtn.textContent = 'üé§';
                isRecording = false;
            } else {
                recognition.start();
                voiceBtn.classList.add('recording');
                voiceBtn.textContent = '‚èπÔ∏è';
                isRecording = true;
            }
        }

        // Progress Functions
        function updateProgress() {
            const completed = profileComplete ? 1 : 0;
            const remaining = 3 - completed;
            
            document.getElementById('completedCount').textContent = completed;
            document.getElementById('remainingCount').textContent = remaining;
        }

        // Chat History Functions
        function updateChatHistory() {
            const container = document.getElementById('chatHistoryContainer');
            
            if (chatHistory.length === 0) {
                container.innerHTML = '<p id="noChatHistory">No chat history yet. Start a conversation with the AI assistant!</p>';
                return;
            }
            
            container.innerHTML = '';
            chatHistory.forEach(chat => {
                const chatCard = document.createElement('div');
                chatCard.className = 'card';
                chatCard.innerHTML = `
                    <h3>${chat.title}</h3>
                    <p>Date: ${chat.date.toLocaleDateString()}</p>
                    <p>Messages: ${chat.messages.length}</p>
                    <button class="btn btn-secondary" onclick="loadChatHistory(${chat.id})">Load Chat</button>
                `;
                container.appendChild(chatCard);
            });
        }

        function loadChatHistory(chatId) {
            const chat = chatHistory.find(c => c.id === chatId);
            if (chat) {
                showSection('chat');
                const messagesContainer = document.getElementById('chatMessages');
                messagesContainer.innerHTML = '';
                
                chat.messages.forEach(msg => {
                    addChatMessage(msg.text, msg.isUser);
                });
            }
        }

        // Help Resources Functions
        function populateHelpResources() {
            const helpResources = {
                emergency: [
                    {
                        name: 'National Immigration Hotline',
                        type: 'Emergency Hotline',
                        phone: '1-800-375-5283',
                        services: ['Emergency Assistance', 'Legal Referrals'],
                        languages: ['English', 'Spanish'],
                        availability: '24/7'
                    }
                ],
                legalAid: [
                    {
                        name: 'Legal Aid Society',
                        type: 'Legal Services',
                        phone: '1-800-LEGAL-AID',
                        website: 'legalaid.org',
                        services: ['Immigration Law', 'Family Law', 'Housing'],
                        languages: ['English', 'Spanish', 'Chinese'],
                        availability: 'Mon-Fri 9AM-5PM'
                    }
                ],
                communityCenters: [
                    {
                        name: 'Community Immigration Center',
                        type: 'Community Center',
                        phone: '555-123-4567',
                        website: 'communitycenter.org',
                        services: ['ESL Classes', 'Job Training', 'Legal Clinics'],
                        languages: ['English', 'Spanish', 'Arabic'],
                        availability: 'Mon-Sat 8AM-8PM'
                    }
                ],
                healthcare: [
                    {
                        name: 'Community Health Center',
                        type: 'Healthcare',
                        phone: '555-987-6543',
                        website: 'communityhealth.org',
                        services: ['Primary Care', 'Mental Health', 'Dental'],
                        languages: ['English', 'Spanish', 'Portuguese'],
                        availability: 'Mon-Fri 7AM-7PM'
                    }
                ],
                employment: [
                    {
                        name: 'Workforce Development Center',
                        type: 'Employment Services',
                        phone: '555-456-7890',
                        website: 'workforce.org',
                        services: ['Job Placement', 'Resume Help', 'Skills Training'],
                        languages: ['English', 'Spanish', 'French'],
                        availability: 'Mon-Fri 8AM-6PM'
                    }
                ],
                educational: [
                    {
                        name: 'Adult Education Center',
                        type: 'Educational Services',
                        phone: '555-321-0987',
                        website: 'adulted.org',
                        services: ['GED Prep', 'English Classes', 'Computer Skills'],
                        languages: ['English', 'Spanish', 'Chinese', 'Arabic'],
                        availability: 'Mon-Thu 9AM-9PM'
                    }
                ]
            };
            
            Object.keys(helpResources).forEach(category => {
                const container = document.getElementById(category + 'Container');
                if (container) {
                    container.innerHTML = '';
                    helpResources[category].forEach(resource => {
                        const resourceCard = createResourceCard(resource);
                        container.appendChild(resourceCard);
                    });
                }
            });
        }

        function createResourceCard(resource) {
            const card = document.createElement('div');
            card.className = 'resource-card';
            
            let servicesHtml = '';
            if (resource.services) {
                servicesHtml = `
                    <div style="margin: 10px 0;">
                        <strong>Services:</strong>
                        ${resource.services.map(service => `<span class="service-tag">${service}</span>`).join('')}
                    </div>
                `;
            }
            
            let languagesHtml = '';
            if (resource.languages) {
                languagesHtml = `
                    <div style="margin: 10px 0;">
                        <strong>Languages:</strong>
                        ${resource.languages.map(lang => `<span class="language-tag">${lang}</span>`).join('')}
                    </div>
                `;
            }
            
            card.innerHTML = `
                <div class="resource-name">${resource.name}</div>
                <div class="resource-type">${resource.type}</div>
                ${resource.phone ? `<div class="resource-phone">üìû ${resource.phone}</div>` : ''}
                ${resource.website ? `<a href="https://${resource.website}" target="_blank" class="resource-website">üåê ${resource.website}</a>` : ''}
                ${servicesHtml}
                ${languagesHtml}
                ${resource.availability ? `<div style="margin: 10px 0;"><strong>Hours:</strong> ${resource.availability}</div>` : ''}
            `;
            
            return card;
        }

        // Translation System
        const translations = {
            en: {
                // Navigation
                dashboardNav: "üìä Dashboard",
                profileNav: "üë§ Profile",
                documentsNav: "üìÑ Documents",
                chatNav: "ü§ñ AI Assistant",
                chatHistoryNav: "üí¨ AI Chats",
                helpNav: "üÜò Help Resources",
                
                // Dashboard
                dashboardTitle: "Dashboard - Immigr-Aid",
                completedLabel: "Completed",
                remainingLabel: "Remaining",
                profileTitle: "Personal Information",
                profileDescription: "Complete your profile to enable AI assistance with form filling and personalized guidance.",
                completeProfileBtn: "Complete Profile",
                documentsTitle: "Required Documents",
                documentsDescription: "All documents needed to complete your immigration application process",
                
                // Profile
                profileSectionTitle: "Personal Information",
                firstNameLabel: "First Name",
                lastNameLabel: "Last Name",
                middleNameLabel: "Middle Name",
                dateOfBirthLabel: "Date of Birth",
                countryOfBirthLabel: "Country of Birth",
                currentAddressLabel: "Current Address",
                phoneNumberLabel: "Phone Number",
                emailAddressLabel: "Email Address",
                socialSecurityNumberLabel: "Social Security Number",
                entryDateLabel: "Entry Date to US",
                methodOfEntryLabel: "Method of Entry",
                educationLevelLabel: "Education Level",
                employmentStatusLabel: "Employment Status",
                criminalHistoryLabel: "Criminal History",
                saveProfileBtn: "Save Profile Information",
                
                // Documents
                documentsSectionTitle: "Required Documents",
                
                // Chat
                chatTitle: "AI Assistant - Immigr-Aid",
                welcomeMessage: "Hello! I am your AI immigration assistant. I can help you fill out forms, answer questions about your immigration process, and guide you through each step. How can I assist you today?",
                
                // Chat History
                chatHistoryTitle: "AI Chat History",
                
                // Help Resources
                helpTitle: "Help Resources & Locations",
                emergencyResources: "Emergency Resources",
                legalAid: "Legal Aid",
                communityCenters: "Community Centers",
                healthcareResources: "Healthcare",
                employmentResources: "Employment",
                educationalResources: "Educational Resources",
                
                // AI Responses
                aiResponseDACA: "I can help you fill out Form I-821D (DACA). Based on your profile, I will guide you through each section. Let's start with your personal information.",
                aiResponseWorkPermit: "For Form I-765 (Work Permit), you will need to provide your employment authorization details. I can help you complete this step by step.",
                aiResponseTravel: "Form I-131 is for advance parole/travel document. I can help you understand the requirements and fill out this form.",
                aiResponseHelp: "I can assist you with any immigration form. Just tell me which form you're working on and I'll help you fill it out using your profile information.",
                aiResponseStatus: "Based on your profile, I can help you check your application status and guide you through the next steps in your immigration process.",
                aiResponseDocuments: "I can help you understand the requirements for each document. Which document would you like me to explain or help you fill out?",
                aiResponseDefault1: "I can help you fill out Form I-821D. Based on your profile, I will guide you through each section. Let's start with your personal information.",
                aiResponseDefault2: "For Form I-765, you will need to provide your employment information. I can help you complete this section step by step.",
                aiResponseDefault3: "I notice you are working on your DACA renewal. I can help you fill out all the required forms using your profile information.",
                aiResponseDefault4: "Let me help you with the Economic Necessity Worksheet. I will guide you through the financial information needed.",
                aiResponseDefault5: "I can assist you with any immigration form. Just tell me which form you're working on and I will help you fill it out.",
                aiResponseDefault6: "Based on your information, I can help you complete all your immigration forms. Would you like to start with Form I-821D?",
                aiResponseDefault7: "I can explain any immigration process in detail. What specific question do you have about your application?",
                aiResponseDefault8: "I can help you understand the requirements for each document. Which document would you like me to explain?",
                formHelpMessage: "I can help you fill out immigration forms. Would you like me to open a specific form for you?",
                
                // Sidebar AI
                aiSidebarSubtitle: "I'm here to help you with your immigration forms and questions. Ask me anything!",
                aiSidebarWelcomeMessage: "Hello! I'm your AI immigration assistant. I can help you fill out forms, answer questions about your immigration process, and guide you through each step. How can I assist you today?",
                aiSidebarPlaceholder: "Ask me anything...",
                
                // Form field translations
                personalInformation: "Personal Information",
                arrivalInformation: "Arrival Information",
                educationInformation: "Education Information",
                criminalRecord: "Criminal Record",
                criminalDetails: "Criminal Details (if applicable)",
                economicNecessity: "Economic Necessity",
                immigrationStatus: "Immigration Status",
                currentStatus: "Current Immigration Status",
                alienNumber: "Alien Number (if applicable)",
                employmentHistory: "Employment History",
                previousEmployer: "Previous Employer",
                employmentDates: "Employment Dates",
                jobTitle: "Job Title",
                supportingDocuments: "Supporting Documents",
                passportPhoto: "Passport Photo Required",
                identityDocument: "Identity Document",
                employmentEvidence: "Employment Evidence",
                travelPurpose: "Travel Purpose",
                travelReason: "Reason for Travel",
                travelDestination: "Travel Destination",
                travelDates: "Travel Dates",
                departureDate: "Departure Date",
                returnDate: "Return Date",
                supportingEvidence: "Supporting Evidence",
                travelDocumentation: "Travel Documentation",
                emergencyContact: "Emergency Contact",
                emergencyPhone: "Emergency Phone",
                schoolName: "Current/Last School Name",
                graduationDate: "Graduation Date",
                annualIncome: "Annual Income",
                householdSize: "Household Size",
                economicHardship: "Economic Hardship Explanation",
                
                // Placeholders
                firstNamePlaceholder: "Enter your first name",
                lastNamePlaceholder: "Enter your last name",
                middleNamePlaceholder: "Enter your middle name (optional)",
                dateOfBirthPlaceholder: "Select your date of birth",
                addressPlaceholder: "Enter your current address",
                phonePlaceholder: "Enter your phone number",
                emailPlaceholder: "Enter your email address",
                ssnPlaceholder: "Enter your SSN (if applicable)",
                entryDatePlaceholder: "Select your date of entry",
                schoolNamePlaceholder: "Enter school name",
                graduationDatePlaceholder: "Select graduation date",
                criminalDetailsPlaceholder: "Enter criminal details if applicable",
                annualIncomePlaceholder: "Enter annual income",
                householdSizePlaceholder: "Enter household size",
                economicHardshipPlaceholder: "Explain economic hardship",
                alienNumberPlaceholder: "Enter alien number if applicable",
                previousEmployerPlaceholder: "Enter previous employer",
                employmentDatesPlaceholder: "Enter employment dates",
                jobTitlePlaceholder: "Enter job title",
                travelDestinationPlaceholder: "Enter travel destination",
                travelDocumentationPlaceholder: "Enter travel documentation",
                emergencyContactPlaceholder: "Enter emergency contact name",
                emergencyPhonePlaceholder: "Enter emergency contact phone",
                
                // Select options
                selectOption: "Select...",
                mexico: "Mexico",
                china: "China",
                india: "India",
                philippines: "Philippines",
                elSalvador: "El Salvador",
                guatemala: "Guatemala",
                honduras: "Honduras",
                cuba: "Cuba",
                dominicanRepublic: "Dominican Republic",
                colombia: "Colombia",
                venezuela: "Venezuela",
                brazil: "Brazil",
                argentina: "Argentina",
                peru: "Peru",
                ecuador: "Ecuador",
                bolivia: "Bolivia",
                chile: "Chile",
                uruguay: "Uruguay",
                paraguay: "Paraguay",
                other: "Other",
                visa: "Visa",
                borderCrossing: "Border Crossing",
                airport: "Airport",
                elementary: "Elementary School",
                middleSchool: "Middle School",
                highSchool: "High School",
                someCollege: "Some College",
                associateDegree: "Associate Degree",
                bachelorDegree: "Bachelor Degree",
                masterDegree: "Master Degree",
                doctorate: "Doctorate",
                employed: "Employed",
                unemployed: "Unemployed",
                student: "Student",
                selfEmployed: "Self-Employed",
                retired: "Retired",
                none: "No Criminal History",
                minor: "Minor Offenses",
                major: "Major Offenses",
                daca: "DACA",
                tps: "TPS",
                asylumPending: "Asylum Pending",
                familyPetitionPending: "Family Petition Pending",
                educational: "Educational",
                employment: "Employment",
                humanitarian: "Humanitarian",
                familyEmergency: "Family Emergency",
                medical: "Medical"
            },
            es: {
                // Navigation
                dashboardNav: "üìä Panel de Control",
                profileNav: "üë§ Perfil",
                documentsNav: "üìÑ Documentos",
                chatNav: "ü§ñ Asistente IA",
                chatHistoryNav: "üí¨ Chats IA",
                helpNav: "üÜò Recursos de Ayuda",
                
                // Dashboard
                dashboardTitle: "Panel de Control - Immigr-Aid",
                completedLabel: "Completado",
                remainingLabel: "Pendiente",
                profileTitle: "Informaci√≥n Personal",
                profileDescription: "Complete su perfil para habilitar la asistencia de IA con el llenado de formularios y orientaci√≥n personalizada.",
                completeProfileBtn: "Completar Perfil",
                documentsTitle: "Documentos Requeridos",
                documentsDescription: "Todos los documentos necesarios para completar su proceso de aplicaci√≥n de inmigraci√≥n",
                
                // Profile
                profileSectionTitle: "Informaci√≥n Personal",
                firstNameLabel: "Nombre",
                lastNameLabel: "Apellido",
                middleNameLabel: "Segundo Nombre",
                dateOfBirthLabel: "Fecha de Nacimiento",
                countryOfBirthLabel: "Pa√≠s de Nacimiento",
                currentAddressLabel: "Direcci√≥n Actual",
                phoneNumberLabel: "N√∫mero de Tel√©fono",
                emailAddressLabel: "Direcci√≥n de Correo",
                socialSecurityNumberLabel: "N√∫mero de Seguro Social",
                entryDateLabel: "Fecha de Entrada a EE.UU.",
                methodOfEntryLabel: "M√©todo de Entrada",
                educationLevelLabel: "Nivel de Educaci√≥n",
                employmentStatusLabel: "Estado de Empleo",
                criminalHistoryLabel: "Historial Criminal",
                saveProfileBtn: "Guardar Informaci√≥n del Perfil",
                
                // Documents
                documentsSectionTitle: "Documentos Requeridos",
                
                // Chat
                chatTitle: "Asistente IA - Immigr-Aid",
                welcomeMessage: "¬°Hola! Soy tu asistente de inmigraci√≥n con IA. Puedo ayudarte a llenar formularios, responder preguntas sobre tu proceso de inmigraci√≥n y guiarte a trav√©s de cada paso. ¬øC√≥mo puedo ayudarte hoy?",
                
                // Chat History
                chatHistoryTitle: "Historial de Chats IA",
                
                // Help Resources
                helpTitle: "Recursos de Ayuda y Ubicaciones",
                emergencyResources: "Recursos de Emergencia",
                legalAid: "Ayuda Legal",
                communityCenters: "Centros Comunitarios",
                healthcareResources: "Atenci√≥n M√©dica",
                employmentResources: "Empleo",
                educationalResources: "Recursos Educativos",
                
                // Sidebar AI
                aiSidebarSubtitle: "Estoy aqu√≠ para ayudarte con tus formularios de inmigraci√≥n y preguntas. ¬°Preg√∫ntame cualquier cosa!",
                aiSidebarWelcomeMessage: "¬°Hola! Soy tu asistente de inmigraci√≥n con IA. Puedo ayudarte a llenar formularios, responder preguntas sobre tu proceso de inmigraci√≥n y guiarte a trav√©s de cada paso. ¬øC√≥mo puedo ayudarte hoy?",
                aiSidebarPlaceholder: "Preg√∫ntame cualquier cosa...",
                
                // Form field translations
                personalInformation: "Informaci√≥n Personal",
                arrivalInformation: "Informaci√≥n de Llegada",
                educationInformation: "Informaci√≥n Educativa",
                criminalRecord: "Antecedentes Penales",
                criminalDetails: "Detalles Penales (si aplica)",
                economicNecessity: "Necesidad Econ√≥mica",
                immigrationStatus: "Estado de Inmigraci√≥n",
                currentStatus: "Estado Actual de Inmigraci√≥n",
                alienNumber: "N√∫mero de Extranjero (si aplica)",
                employmentHistory: "Historial de Empleo",
                previousEmployer: "Empleador Anterior",
                employmentDates: "Fechas de Empleo",
                jobTitle: "T√≠tulo del Trabajo",
                supportingDocuments: "Documentos de Apoyo",
                passportPhoto: "Foto de Pasaporte Requerida",
                identityDocument: "Documento de Identidad",
                employmentEvidence: "Evidencia de Empleo",
                travelPurpose: "Prop√≥sito de Viaje",
                travelReason: "Raz√≥n del Viaje",
                travelDestination: "Destino del Viaje",
                travelDates: "Fechas de Viaje",
                departureDate: "Fecha de Salida",
                returnDate: "Fecha de Regreso",
                supportingEvidence: "Evidencia de Apoyo",
                travelDocumentation: "Documentaci√≥n de Viaje",
                emergencyContact: "Contacto de Emergencia",
                emergencyPhone: "Tel√©fono de Emergencia",
                schoolName: "Nombre de la Escuela Actual/√öltima",
                graduationDate: "Fecha de Graduaci√≥n",
                annualIncome: "Ingreso Anual",
                householdSize: "Tama√±o del Hogar",
                economicHardship: "Explicaci√≥n de Dificultad Econ√≥mica",
                
                // Placeholders
                firstNamePlaceholder: "Ingresa tu nombre",
                lastNamePlaceholder: "Ingresa tu apellido",
                middleNamePlaceholder: "Ingresa tu segundo nombre (opcional)",
                dateOfBirthPlaceholder: "Selecciona tu fecha de nacimiento",
                addressPlaceholder: "Ingresa tu direcci√≥n actual",
                phonePlaceholder: "Ingresa tu n√∫mero de tel√©fono",
                emailPlaceholder: "Ingresa tu direcci√≥n de correo",
                ssnPlaceholder: "Ingresa tu SSN (si aplica)",
                entryDatePlaceholder: "Selecciona tu fecha de entrada",
                schoolNamePlaceholder: "Ingresa el nombre de la escuela",
                graduationDatePlaceholder: "Selecciona la fecha de graduaci√≥n",
                criminalDetailsPlaceholder: "Ingresa detalles penales si aplican",
                annualIncomePlaceholder: "Ingresa el ingreso anual",
                householdSizePlaceholder: "Ingresa el tama√±o del hogar",
                economicHardshipPlaceholder: "Explica la dificultad econ√≥mica",
                alienNumberPlaceholder: "Ingresa el n√∫mero de extranjero si aplica",
                previousEmployerPlaceholder: "Ingresa el empleador anterior",
                employmentDatesPlaceholder: "Ingresa las fechas de empleo",
                jobTitlePlaceholder: "Ingresa el t√≠tulo del trabajo",
                travelDestinationPlaceholder: "Ingresa el destino del viaje",
                travelDocumentationPlaceholder: "Ingresa la documentaci√≥n de viaje",
                emergencyContactPlaceholder: "Ingresa el nombre del contacto de emergencia",
                emergencyPhonePlaceholder: "Ingresa el tel√©fono de emergencia",
                
                // Select options
                selectOption: "Seleccionar...",
                mexico: "M√©xico",
                china: "China",
                india: "India",
                philippines: "Filipinas",
                elSalvador: "El Salvador",
                guatemala: "Guatemala",
                honduras: "Honduras",
                cuba: "Cuba",
                dominicanRepublic: "Rep√∫blica Dominicana",
                colombia: "Colombia",
                venezuela: "Venezuela",
                brazil: "Brasil",
                argentina: "Argentina",
                peru: "Per√∫",
                ecuador: "Ecuador",
                bolivia: "Bolivia",
                chile: "Chile",
                uruguay: "Uruguay",
                paraguay: "Paraguay",
                other: "Otro",
                visa: "Visa",
                borderCrossing: "Cruzar Frontera",
                airport: "Aeropuerto",
                elementary: "Escuela Primaria",
                middleSchool: "Escuela Secundaria",
                highSchool: "Escuela Preparatoria",
                someCollege: "Algo de Universidad",
                associateDegree: "Grado Asociado",
                bachelorDegree: "Licenciatura",
                masterDegree: "Maestr√≠a",
                doctorate: "Doctorado",
                employed: "Empleado",
                unemployed: "Desempleado",
                student: "Estudiante",
                selfEmployed: "Autoempleado",
                retired: "Retirado",
                none: "Sin Antecedentes Penales",
                minor: "Delitos Menores",
                major: "Delitos Mayores",
                daca: "DACA",
                tps: "TPS",
                asylumPending: "Asilo Pendiente",
                familyPetitionPending: "Petici√≥n Familiar Pendiente",
                educational: "Educativo",
                employment: "Empleo",
                humanitarian: "Humanitario",
                familyEmergency: "Emergencia Familiar",
                medical: "M√©dico"
            },
            zh: {
                // Navigation
                dashboardNav: "üìä ‰ª™Ë°®Êùø",
                profileNav: "üë§ ‰∏™‰∫∫ËµÑÊñô",
                documentsNav: "üìÑ Êñá‰ª∂",
                chatNav: "ü§ñ AIÂä©Êâã",
                chatHistoryNav: "üí¨ AIËÅäÂ§©ËÆ∞ÂΩï",
                helpNav: "üÜò Â∏ÆÂä©ËµÑÊ∫ê",
                
                // Dashboard
                dashboardTitle: "‰ª™Ë°®Êùø - Immigr-Aid",
                completedLabel: "Â∑≤ÂÆåÊàê",
                remainingLabel: "ÂæÖÂÆåÊàê",
                profileTitle: "‰∏™‰∫∫‰ø°ÊÅØ",
                profileDescription: "ÂÆåÊàêÊÇ®ÁöÑ‰∏™‰∫∫ËµÑÊñô‰ª•ÂêØÁî®AIÂä©ÊâãÂ∏ÆÂä©Â°´ÂÜôË°®Ê†ºÂíåÊèê‰æõ‰∏™ÊÄßÂåñÊåáÂØº„ÄÇ",
                completeProfileBtn: "ÂÆåÊàê‰∏™‰∫∫ËµÑÊñô",
                documentsTitle: "ÊâÄÈúÄÊñá‰ª∂",
                documentsDescription: "ÂÆåÊàêÁßªÊ∞ëÁî≥ËØ∑ÊµÅÁ®ãÊâÄÈúÄÁöÑÊâÄÊúâÊñá‰ª∂",
                
                // Profile
                profileSectionTitle: "‰∏™‰∫∫‰ø°ÊÅØ",
                firstNameLabel: "ÂêçÂ≠ó",
                lastNameLabel: "ÂßìÊ∞è",
                middleNameLabel: "‰∏≠Èó¥Âêç",
                dateOfBirthLabel: "Âá∫ÁîüÊó•Êúü",
                countryOfBirthLabel: "Âá∫ÁîüÂõΩÂÆ∂",
                currentAddressLabel: "ÂΩìÂâçÂú∞ÂùÄ",
                phoneNumberLabel: "ÁîµËØùÂè∑Á†Å",
                emailAddressLabel: "ÁîµÂ≠êÈÇÆ‰ª∂Âú∞ÂùÄ",
                socialSecurityNumberLabel: "Á§æ‰ºöÂÆâÂÖ®Âè∑Á†Å",
                entryDateLabel: "ÂÖ•Â¢ÉÁæéÂõΩÊó•Êúü",
                methodOfEntryLabel: "ÂÖ•Â¢ÉÊñπÂºè",
                educationLevelLabel: "ÊïôËÇ≤Ê∞¥Âπ≥",
                employmentStatusLabel: "Â∞±‰∏öÁä∂ÂÜµ",
                criminalHistoryLabel: "ÁäØÁΩ™ËÆ∞ÂΩï",
                saveProfileBtn: "‰øùÂ≠ò‰∏™‰∫∫ËµÑÊñô‰ø°ÊÅØ",
                
                // Documents
                documentsSectionTitle: "ÊâÄÈúÄÊñá‰ª∂",
                
                // Chat
                chatTitle: "AIÂä©Êâã - Immigr-Aid",
                welcomeMessage: "‰Ω†Â•ΩÔºÅÊàëÊòØ‰Ω†ÁöÑAIÁßªÊ∞ëÂä©Êâã„ÄÇÊàëÂèØ‰ª•Â∏ÆÂä©‰Ω†Â°´ÂÜôË°®Ê†ºÔºåÂõûÁ≠îÂÖ≥‰∫é‰Ω†ÁöÑÁßªÊ∞ëËøáÁ®ãÁöÑÈóÆÈ¢òÔºåÂπ∂ÊåáÂØº‰Ω†ÂÆåÊàêÊØè‰∏ÄÊ≠•„ÄÇÊàë‰ªäÂ§©ËÉΩÂ¶Ç‰ΩïÂ∏ÆÂä©‰Ω†Ôºü",
                
                // Chat History
                chatHistoryTitle: "AIËÅäÂ§©ËÆ∞ÂΩï",
                
                // Help Resources
                helpTitle: "Â∏ÆÂä©ËµÑÊ∫êÂíåÂú∞ÁÇπ",
                emergencyResources: "Á¥ßÊÄ•ËµÑÊ∫ê",
                legalAid: "Ê≥ïÂæãÊè¥Âä©",
                communityCenters: "Á§æÂå∫‰∏≠ÂøÉ",
                healthcareResources: "ÂåªÁñó‰øùÂÅ•",
                employmentResources: "Â∞±‰∏ö",
                educationalResources: "ÊïôËÇ≤ËµÑÊ∫ê",
                
                // Sidebar AI
                aiSidebarSubtitle: "ÊàëÂú®ËøôÈáåÂ∏ÆÂä©ÊÇ®Â§ÑÁêÜÁßªÊ∞ëË°®Ê†ºÂíåÈóÆÈ¢ò„ÄÇÈóÆÊàë‰ªª‰ΩïÈóÆÈ¢òÔºÅ",
                aiSidebarWelcomeMessage: "ÊÇ®Â•ΩÔºÅÊàëÊòØÊÇ®ÁöÑAIÁßªÊ∞ëÂä©Êâã„ÄÇÊàëÂèØ‰ª•Â∏ÆÂä©ÊÇ®Â°´ÂÜôË°®Ê†ºÔºåÂõûÁ≠îÊúâÂÖ≥ÁßªÊ∞ëËøáÁ®ãÁöÑÈóÆÈ¢òÔºåÂπ∂ÊåáÂØºÊÇ®ÂÆåÊàêÊØè‰∏™Ê≠•È™§„ÄÇÊàë‰ªäÂ§©Â¶Ç‰ΩïÂ∏ÆÂä©ÊÇ®Ôºü",
                aiSidebarPlaceholder: "ÈóÆÊàë‰ªª‰ΩïÈóÆÈ¢ò...",
                
                // Form field translations
                personalInformation: "‰∏™‰∫∫‰ø°ÊÅØ",
                arrivalInformation: "ÂÖ•Â¢É‰ø°ÊÅØ",
                educationInformation: "ÊïôËÇ≤‰ø°ÊÅØ",
                criminalRecord: "ÁäØÁΩ™ËÆ∞ÂΩï",
                criminalDetails: "ÁäØÁΩ™ËØ¶ÊÉÖÔºàÂ¶ÇÈÄÇÁî®Ôºâ",
                economicNecessity: "ÁªèÊµéÈúÄË¶Å",
                immigrationStatus: "ÁßªÊ∞ëË∫´‰ªΩ",
                currentStatus: "ÂΩìÂâçÁßªÊ∞ëË∫´‰ªΩ",
                alienNumber: "Â§ñÂõΩ‰∫∫Âè∑Á†ÅÔºàÂ¶ÇÈÄÇÁî®Ôºâ",
                employmentHistory: "Â∞±‰∏öÂéÜÂè≤",
                previousEmployer: "ÂâçÈõá‰∏ª",
                employmentDates: "Â∞±‰∏öÊó•Êúü",
                jobTitle: "ËÅå‰Ωç",
                supportingDocuments: "ÊîØÊåÅÊñá‰ª∂",
                passportPhoto: "ÈúÄË¶ÅÊä§ÁÖßÁÖßÁâá",
                identityDocument: "Ë∫´‰ªΩÊñá‰ª∂",
                employmentEvidence: "Â∞±‰∏öËØÅÊòé",
                travelPurpose: "ÊóÖË°åÁõÆÁöÑ",
                travelReason: "ÊóÖË°åÂéüÂõ†",
                travelDestination: "ÊóÖË°åÁõÆÁöÑÂú∞",
                travelDates: "ÊóÖË°åÊó•Êúü",
                departureDate: "Âá∫ÂèëÊó•Êúü",
                returnDate: "ËøîÂõûÊó•Êúü",
                supportingEvidence: "ÊîØÊåÅËØÅÊçÆ",
                travelDocumentation: "ÊóÖË°åÊñá‰ª∂",
                emergencyContact: "Á¥ßÊÄ•ËÅîÁ≥ª‰∫∫",
                emergencyPhone: "Á¥ßÊÄ•ÁîµËØù",
                schoolName: "ÂΩìÂâç/ÊúÄÂêéÂ≠¶Ê†°ÂêçÁß∞",
                graduationDate: "ÊØï‰∏öÊó•Êúü",
                annualIncome: "Âπ¥Êî∂ÂÖ•",
                householdSize: "ÂÆ∂Â∫≠ËßÑÊ®°",
                economicHardship: "ÁªèÊµéÂõ∞ÈöæËØ¥Êòé",
                
                // Placeholders
                firstNamePlaceholder: "ËæìÂÖ•ÊÇ®ÁöÑÂêçÂ≠ó",
                lastNamePlaceholder: "ËæìÂÖ•ÊÇ®ÁöÑÂßìÊ∞è",
                middleNamePlaceholder: "ËæìÂÖ•ÊÇ®ÁöÑ‰∏≠Èó¥ÂêçÔºàÂèØÈÄâÔºâ",
                dateOfBirthPlaceholder: "ÈÄâÊã©ÊÇ®ÁöÑÂá∫ÁîüÊó•Êúü",
                addressPlaceholder: "ËæìÂÖ•ÊÇ®ÂΩìÂâçÁöÑÂú∞ÂùÄ",
                phonePlaceholder: "ËæìÂÖ•ÊÇ®ÁöÑÁîµËØùÂè∑Á†Å",
                emailPlaceholder: "ËæìÂÖ•ÊÇ®ÁöÑÁîµÂ≠êÈÇÆ‰ª∂Âú∞ÂùÄ",
                ssnPlaceholder: "ËæìÂÖ•ÊÇ®ÁöÑSSNÔºàÂ¶ÇÈÄÇÁî®Ôºâ",
                entryDatePlaceholder: "ÈÄâÊã©ÊÇ®ÁöÑÂÖ•Â¢ÉÊó•Êúü",
                schoolNamePlaceholder: "ËæìÂÖ•Â≠¶Ê†°ÂêçÁß∞",
                graduationDatePlaceholder: "ÈÄâÊã©ÊØï‰∏öÊó•Êúü",
                criminalDetailsPlaceholder: "ËæìÂÖ•ÁäØÁΩ™ËØ¶ÊÉÖÔºàÂ¶ÇÈÄÇÁî®Ôºâ",
                annualIncomePlaceholder: "ËæìÂÖ•Âπ¥Êî∂ÂÖ•",
                householdSizePlaceholder: "ËæìÂÖ•ÂÆ∂Â∫≠ËßÑÊ®°",
                economicHardshipPlaceholder: "ËØ¥ÊòéÁªèÊµéÂõ∞Èöæ",
                alienNumberPlaceholder: "ËæìÂÖ•Â§ñÂõΩ‰∫∫Âè∑Á†ÅÔºàÂ¶ÇÈÄÇÁî®Ôºâ",
                previousEmployerPlaceholder: "ËæìÂÖ•ÂâçÈõá‰∏ª",
                employmentDatesPlaceholder: "ËæìÂÖ•Â∞±‰∏öÊó•Êúü",
                jobTitlePlaceholder: "ËæìÂÖ•ËÅå‰Ωç",
                travelDestinationPlaceholder: "ËæìÂÖ•ÊóÖË°åÁõÆÁöÑÂú∞",
                travelDocumentationPlaceholder: "ËæìÂÖ•ÊóÖË°åÊñá‰ª∂",
                emergencyContactPlaceholder: "ËæìÂÖ•Á¥ßÊÄ•ËÅîÁ≥ª‰∫∫ÂßìÂêç",
                emergencyPhonePlaceholder: "ËæìÂÖ•Á¥ßÊÄ•ÁîµËØù",
                
                // Select options
                selectOption: "ÈÄâÊã©...",
                mexico: "Â¢®Ë•øÂì•",
                china: "‰∏≠ÂõΩ",
                india: "Âç∞Â∫¶",
                philippines: "Ëè≤ÂæãÂÆæ",
                elSalvador: "Ëê®Â∞îÁì¶Â§ö",
                guatemala: "Âç±Âú∞È©¨Êãâ",
                honduras: "Ê¥™ÈÉΩÊãâÊñØ",
                cuba: "Âè§Â∑¥",
                dominicanRepublic: "Â§öÁ±≥Â∞ºÂä†ÂÖ±ÂíåÂõΩ",
                colombia: "Âì•‰º¶ÊØî‰∫ö",
                venezuela: "ÂßîÂÜÖÁëûÊãâ",
                brazil: "Â∑¥Ë•ø",
                argentina: "ÈòøÊ†πÂª∑",
                peru: "ÁßòÈ≤Å",
                ecuador: "ÂéÑÁìúÂ§öÂ∞î",
                bolivia: "ÁéªÂà©Áª¥‰∫ö",
                chile: "Êô∫Âà©",
                uruguay: "‰πåÊãâÂú≠",
                paraguay: "Â∑¥ÊãâÂú≠",
                other: "ÂÖ∂‰ªñ",
                visa: "Á≠æËØÅ",
                borderCrossing: "ËæπÂ¢ÉËøáÂ¢É",
                airport: "Êú∫Âú∫",
                elementary: "Â∞èÂ≠¶",
                middleSchool: "‰∏≠Â≠¶",
                highSchool: "È´ò‰∏≠",
                someCollege: "Â§ßÂ≠¶ÈÉ®ÂàÜ",
                associateDegree: "ÂâØÂ≠¶Â£´Â≠¶‰Ωç",
                bachelorDegree: "Â≠¶Â£´Â≠¶‰Ωç",
                masterDegree: "Á°ïÂ£´Â≠¶‰Ωç",
                doctorate: "ÂçöÂ£´Â≠¶‰Ωç",
                employed: "Â∞±‰∏ö",
                unemployed: "Â§±‰∏ö",
                student: "Â≠¶Áîü",
                selfEmployed: "Ëá™Èõá",
                retired: "ÈÄÄ‰ºë",
                none: "Êó†ÁäØÁΩ™ËÆ∞ÂΩï",
                minor: "ËΩªÂæÆÁäØÁΩ™",
                major: "‰∏•ÈáçÁäØÁΩ™",
                daca: "DACA",
                tps: "TPS",
                asylumPending: "Â∫áÊä§ÂæÖÂÆö",
                familyPetitionPending: "ÂÆ∂Â∫≠Áî≥ËØ∑ÂæÖÂÆö",
                educational: "ÊïôËÇ≤",
                employment: "Â∞±‰∏ö",
                humanitarian: "‰∫∫ÈÅì‰∏ª‰πâ",
                familyEmergency: "ÂÆ∂Â∫≠Á¥ßÊÄ•ÊÉÖÂÜµ",
                medical: "ÂåªÁñó"
            },
            ar: {
                // Navigation
                dashboardNav: "üìä ŸÑŸàÿ≠ÿ© ÿßŸÑÿ™ÿ≠ŸÉŸÖ",
                profileNav: "üë§ ÿßŸÑŸÖŸÑŸÅ ÿßŸÑÿ¥ÿÆÿµŸä",
                documentsNav: "üìÑ ÿßŸÑŸÖÿ≥ÿ™ŸÜÿØÿßÿ™",
                chatNav: "ü§ñ ŸÖÿ≥ÿßÿπÿØ ÿßŸÑÿ∞ŸÉÿßÿ° ÿßŸÑÿßÿµÿ∑ŸÜÿßÿπŸä",
                chatHistoryNav: "üí¨ ŸÖÿ≠ÿßÿØÿ´ÿßÿ™ ÿßŸÑÿ∞ŸÉÿßÿ° ÿßŸÑÿßÿµÿ∑ŸÜÿßÿπŸä",
                helpNav: "üÜò ŸÖŸàÿßÿ±ÿØ ÿßŸÑŸÖÿ≥ÿßÿπÿØÿ©",
                
                // Dashboard
                dashboardTitle: "ŸÑŸàÿ≠ÿ© ÿßŸÑÿ™ÿ≠ŸÉŸÖ - Immigr-Aid",
                completedLabel: "ŸÖŸÉÿ™ŸÖŸÑ",
                remainingLabel: "ŸÖÿ™ÿ®ŸÇŸä",
                profileTitle: "ÿßŸÑŸÖÿπŸÑŸàŸÖÿßÿ™ ÿßŸÑÿ¥ÿÆÿµŸäÿ©",
                profileDescription: "ÿ£ŸÉŸÖŸÑ ŸÖŸÑŸÅŸÉ ÿßŸÑÿ¥ÿÆÿµŸä ŸÑÿ™ŸÖŸÉŸäŸÜ ŸÖÿ≥ÿßÿπÿØÿ© ÿßŸÑÿ∞ŸÉÿßÿ° ÿßŸÑÿßÿµÿ∑ŸÜÿßÿπŸä ŸÅŸä ŸÖŸÑÿ° ÿßŸÑŸÜŸÖÿßÿ∞ÿ¨ ŸàÿßŸÑÿ™Ÿàÿ¨ŸäŸá ÿßŸÑÿ¥ÿÆÿµŸä.",
                completeProfileBtn: "ÿ•ŸÉŸÖÿßŸÑ ÿßŸÑŸÖŸÑŸÅ ÿßŸÑÿ¥ÿÆÿµŸä",
                documentsTitle: "ÿßŸÑŸÖÿ≥ÿ™ŸÜÿØÿßÿ™ ÿßŸÑŸÖÿ∑ŸÑŸàÿ®ÿ©",
                documentsDescription: "ÿ¨ŸÖŸäÿπ ÿßŸÑŸÖÿ≥ÿ™ŸÜÿØÿßÿ™ ÿßŸÑŸÑÿßÿ≤ŸÖÿ© ŸÑÿ•ŸÉŸÖÿßŸÑ ÿπŸÖŸÑŸäÿ© ÿ∑ŸÑÿ® ÿßŸÑŸáÿ¨ÿ±ÿ©",
                
                // Profile
                profileSectionTitle: "ÿßŸÑŸÖÿπŸÑŸàŸÖÿßÿ™ ÿßŸÑÿ¥ÿÆÿµŸäÿ©",
                firstNameLabel: "ÿßŸÑÿßÿ≥ŸÖ ÿßŸÑÿ£ŸàŸÑ",
                lastNameLabel: "ÿßÿ≥ŸÖ ÿßŸÑÿπÿßÿ¶ŸÑÿ©",
                middleNameLabel: "ÿßŸÑÿßÿ≥ŸÖ ÿßŸÑÿ£Ÿàÿ≥ÿ∑",
                dateOfBirthLabel: "ÿ™ÿßÿ±ŸäÿÆ ÿßŸÑŸÖŸäŸÑÿßÿØ",
                countryOfBirthLabel: "ÿ®ŸÑÿØ ÿßŸÑŸÖŸäŸÑÿßÿØ",
                currentAddressLabel: "ÿßŸÑÿπŸÜŸàÿßŸÜ ÿßŸÑÿ≠ÿßŸÑŸä",
                phoneNumberLabel: "ÿ±ŸÇŸÖ ÿßŸÑŸáÿßÿ™ŸÅ",
                emailAddressLabel: "ÿπŸÜŸàÿßŸÜ ÿßŸÑÿ®ÿ±ŸäÿØ ÿßŸÑÿ•ŸÑŸÉÿ™ÿ±ŸàŸÜŸä",
                socialSecurityNumberLabel: "ÿ±ŸÇŸÖ ÿßŸÑÿ∂ŸÖÿßŸÜ ÿßŸÑÿßÿ¨ÿ™ŸÖÿßÿπŸä",
                entryDateLabel: "ÿ™ÿßÿ±ŸäÿÆ ÿßŸÑÿØÿÆŸàŸÑ ÿ•ŸÑŸâ ÿßŸÑŸàŸÑÿßŸäÿßÿ™ ÿßŸÑŸÖÿ™ÿ≠ÿØÿ©",
                methodOfEntryLabel: "ÿ∑ÿ±ŸäŸÇÿ© ÿßŸÑÿØÿÆŸàŸÑ",
                educationLevelLabel: "ŸÖÿ≥ÿ™ŸàŸâ ÿßŸÑÿ™ÿπŸÑŸäŸÖ",
                employmentStatusLabel: "ÿ≠ÿßŸÑÿ© ÿßŸÑÿ™Ÿàÿ∏ŸäŸÅ",
                criminalHistoryLabel: "ÿßŸÑÿ≥ÿ¨ŸÑ ÿßŸÑÿ¨ŸÜÿßÿ¶Ÿä",
                saveProfileBtn: "ÿ≠ŸÅÿ∏ ŸÖÿπŸÑŸàŸÖÿßÿ™ ÿßŸÑŸÖŸÑŸÅ ÿßŸÑÿ¥ÿÆÿµŸä",
                
                // Documents
                documentsSectionTitle: "ÿßŸÑŸÖÿ≥ÿ™ŸÜÿØÿßÿ™ ÿßŸÑŸÖÿ∑ŸÑŸàÿ®ÿ©",
                
                // Chat
                chatTitle: "ŸÖÿ≥ÿßÿπÿØ ÿßŸÑÿ∞ŸÉÿßÿ° ÿßŸÑÿßÿµÿ∑ŸÜÿßÿπŸä - Immigr-Aid",
                welcomeMessage: "ŸÖÿ±ÿ≠ÿ®ÿßŸã! ÿ£ŸÜÿß ŸÖÿ≥ÿßÿπÿØ ÿßŸÑŸáÿ¨ÿ±ÿ© ÿ®ÿßŸÑÿ∞ŸÉÿßÿ° ÿßŸÑÿßÿµÿ∑ŸÜÿßÿπŸä. ŸäŸÖŸÉŸÜŸÜŸä ŸÖÿ≥ÿßÿπÿØÿ™ŸÉ ŸÅŸä ŸÖŸÑÿ° ÿßŸÑŸÜŸÖÿßÿ∞ÿ¨ ŸàÿßŸÑÿ•ÿ¨ÿßÿ®ÿ© ÿπŸÑŸâ ÿ£ÿ≥ÿ¶ŸÑÿ© ÿ≠ŸàŸÑ ÿπŸÖŸÑŸäÿ© ÿßŸÑŸáÿ¨ÿ±ÿ© Ÿàÿ™Ÿàÿ¨ŸäŸáŸÉ ÿÆŸÑÿßŸÑ ŸÉŸÑ ÿÆÿ∑Ÿàÿ©. ŸÉŸäŸÅ ŸäŸÖŸÉŸÜŸÜŸä ŸÖÿ≥ÿßÿπÿØÿ™ŸÉ ÿßŸÑŸäŸàŸÖÿü",
                
                // Chat History
                chatHistoryTitle: "ÿ™ÿßÿ±ŸäÿÆ ŸÖÿ≠ÿßÿØÿ´ÿßÿ™ ÿßŸÑÿ∞ŸÉÿßÿ° ÿßŸÑÿßÿµÿ∑ŸÜÿßÿπŸä",
                
                // Help Resources
                helpTitle: "ŸÖŸàÿßÿ±ÿØ ÿßŸÑŸÖÿ≥ÿßÿπÿØÿ© ŸàÿßŸÑŸÖŸàÿßŸÇÿπ",
                emergencyResources: "ŸÖŸàÿßÿ±ÿØ ÿßŸÑÿ∑Ÿàÿßÿ±ÿ¶",
                legalAid: "ÿßŸÑŸÖÿ≥ÿßÿπÿØÿ© ÿßŸÑŸÇÿßŸÜŸàŸÜŸäÿ©",
                communityCenters: "ÿßŸÑŸÖÿ±ÿßŸÉÿ≤ ÿßŸÑŸÖÿ¨ÿ™ŸÖÿπŸäÿ©",
                healthcareResources: "ÿßŸÑÿ±ÿπÿßŸäÿ© ÿßŸÑÿµÿ≠Ÿäÿ©",
                employmentResources: "ÿßŸÑÿ™Ÿàÿ∏ŸäŸÅ",
                educationalResources: "ÿßŸÑŸÖŸàÿßÿ±ÿØ ÿßŸÑÿ™ÿπŸÑŸäŸÖŸäÿ©"
            },
            hi: {
                // Navigation
                dashboardNav: "üìä ‡§°‡•à‡§∂‡§¨‡•ã‡§∞‡•ç‡§°",
                profileNav: "üë§ ‡§™‡•ç‡§∞‡•ã‡§´‡§º‡§æ‡§á‡§≤",
                documentsNav: "üìÑ ‡§¶‡§∏‡•ç‡§§‡§æ‡§µ‡•á‡§ú‡§º",
                chatNav: "ü§ñ AI ‡§∏‡§π‡§æ‡§Ø‡§ï",
                chatHistoryNav: "üí¨ AI ‡§ö‡•à‡§ü‡•ç‡§∏",
                helpNav: "üÜò ‡§∏‡§π‡§æ‡§Ø‡§§‡§æ ‡§∏‡§Ç‡§∏‡§æ‡§ß‡§®",
                
                // Dashboard
                dashboardTitle: "‡§°‡•à‡§∂‡§¨‡•ã‡§∞‡•ç‡§° - Immigr-Aid",
                completedLabel: "‡§™‡•Ç‡§∞‡•ç‡§£",
                remainingLabel: "‡§∂‡•á‡§∑",
                profileTitle: "‡§µ‡•ç‡§Ø‡§ï‡•ç‡§§‡§ø‡§ó‡§§ ‡§ú‡§æ‡§®‡§ï‡§æ‡§∞‡•Ä",
                profileDescription: "‡§´‡•â‡§∞‡•ç‡§Æ ‡§≠‡§∞‡§®‡•á ‡§î‡§∞ ‡§µ‡•ç‡§Ø‡§ï‡•ç‡§§‡§ø‡§ó‡§§ ‡§Æ‡§æ‡§∞‡•ç‡§ó‡§¶‡§∞‡•ç‡§∂‡§® ‡§ï‡•á ‡§≤‡§ø‡§è AI ‡§∏‡§π‡§æ‡§Ø‡§§‡§æ ‡§∏‡§ï‡•ç‡§∑‡§Æ ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§Ö‡§™‡§®‡§æ ‡§™‡•ç‡§∞‡•ã‡§´‡§º‡§æ‡§á‡§≤ ‡§™‡•Ç‡§∞‡§æ ‡§ï‡§∞‡•á‡§Ç‡•§",
                completeProfileBtn: "‡§™‡•ç‡§∞‡•ã‡§´‡§º‡§æ‡§á‡§≤ ‡§™‡•Ç‡§∞‡§æ ‡§ï‡§∞‡•á‡§Ç",
                documentsTitle: "‡§Ü‡§µ‡§∂‡•ç‡§Ø‡§ï ‡§¶‡§∏‡•ç‡§§‡§æ‡§µ‡•á‡§ú‡§º",
                documentsDescription: "‡§Ö‡§™‡§®‡•Ä ‡§Ü‡§™‡•ç‡§∞‡§µ‡§æ‡§∏‡§® ‡§Ü‡§µ‡•á‡§¶‡§® ‡§™‡•ç‡§∞‡§ï‡•ç‡§∞‡§ø‡§Ø‡§æ ‡§ï‡•ã ‡§™‡•Ç‡§∞‡§æ ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§Ü‡§µ‡§∂‡•ç‡§Ø‡§ï ‡§∏‡§≠‡•Ä ‡§¶‡§∏‡•ç‡§§‡§æ‡§µ‡•á‡§ú‡§º",
                
                // Profile
                profileSectionTitle: "‡§µ‡•ç‡§Ø‡§ï‡•ç‡§§‡§ø‡§ó‡§§ ‡§ú‡§æ‡§®‡§ï‡§æ‡§∞‡•Ä",
                firstNameLabel: "‡§™‡§π‡§≤‡§æ ‡§®‡§æ‡§Æ",
                lastNameLabel: "‡§Ö‡§Ç‡§§‡§ø‡§Æ ‡§®‡§æ‡§Æ",
                middleNameLabel: "‡§Æ‡§ß‡•ç‡§Ø ‡§®‡§æ‡§Æ",
                dateOfBirthLabel: "‡§ú‡§®‡•ç‡§Æ ‡§§‡§ø‡§•‡§ø",
                countryOfBirthLabel: "‡§ú‡§®‡•ç‡§Æ ‡§¶‡•á‡§∂",
                currentAddressLabel: "‡§µ‡§∞‡•ç‡§§‡§Æ‡§æ‡§® ‡§™‡§§‡§æ",
                phoneNumberLabel: "‡§´‡•ã‡§® ‡§®‡§Ç‡§¨‡§∞",
                emailAddressLabel: "‡§à‡§Æ‡•á‡§≤ ‡§™‡§§‡§æ",
                socialSecurityNumberLabel: "‡§∏‡§æ‡§Æ‡§æ‡§ú‡§ø‡§ï ‡§∏‡•Å‡§∞‡§ï‡•ç‡§∑‡§æ ‡§∏‡§Ç‡§ñ‡•ç‡§Ø‡§æ",
                entryDateLabel: "‡§Ö‡§Æ‡•á‡§∞‡§ø‡§ï‡§æ ‡§Æ‡•á‡§Ç ‡§™‡•ç‡§∞‡§µ‡•á‡§∂ ‡§ï‡•Ä ‡§§‡§ø‡§•‡§ø",
                methodOfEntryLabel: "‡§™‡•ç‡§∞‡§µ‡•á‡§∂ ‡§ï‡§æ ‡§§‡§∞‡•Ä‡§ï‡§æ",
                educationLevelLabel: "‡§∂‡§ø‡§ï‡•ç‡§∑‡§æ ‡§∏‡•ç‡§§‡§∞",
                employmentStatusLabel: "‡§∞‡•ã‡§ú‡§ó‡§æ‡§∞ ‡§∏‡•ç‡§•‡§ø‡§§‡§ø",
                criminalHistoryLabel: "‡§Ü‡§™‡§∞‡§æ‡§ß‡§ø‡§ï ‡§á‡§§‡§ø‡§π‡§æ‡§∏",
                saveProfileBtn: "‡§™‡•ç‡§∞‡•ã‡§´‡§º‡§æ‡§á‡§≤ ‡§ú‡§æ‡§®‡§ï‡§æ‡§∞‡•Ä ‡§∏‡§π‡•á‡§ú‡•á‡§Ç",
                
                // Documents
                documentsSectionTitle: "‡§Ü‡§µ‡§∂‡•ç‡§Ø‡§ï ‡§¶‡§∏‡•ç‡§§‡§æ‡§µ‡•á‡§ú‡§º",
                
                // Chat
                chatTitle: "AI ‡§∏‡§π‡§æ‡§Ø‡§ï - Immigr-Aid",
                welcomeMessage: "‡§®‡§Æ‡§∏‡•ç‡§§‡•á! ‡§Æ‡•à‡§Ç ‡§Ü‡§™‡§ï‡§æ AI ‡§Ü‡§™‡•ç‡§∞‡§µ‡§æ‡§∏‡§® ‡§∏‡§π‡§æ‡§Ø‡§ï ‡§π‡•Ç‡§Ç‡•§ ‡§Æ‡•à‡§Ç ‡§Ü‡§™‡§ï‡•ã ‡§´‡•â‡§∞‡•ç‡§Æ ‡§≠‡§∞‡§®‡•á, ‡§Ü‡§™‡•ç‡§∞‡§µ‡§æ‡§∏‡§® ‡§™‡•ç‡§∞‡§ï‡•ç‡§∞‡§ø‡§Ø‡§æ ‡§ï‡•á ‡§¨‡§æ‡§∞‡•á ‡§Æ‡•á‡§Ç ‡§™‡•ç‡§∞‡§∂‡•ç‡§®‡•ã‡§Ç ‡§ï‡§æ ‡§â‡§§‡•ç‡§§‡§∞ ‡§¶‡•á‡§®‡•á ‡§î‡§∞ ‡§π‡§∞ ‡§ï‡§¶‡§Æ ‡§™‡§∞ ‡§Æ‡§æ‡§∞‡•ç‡§ó‡§¶‡§∞‡•ç‡§∂‡§® ‡§ï‡§∞‡§®‡•á ‡§Æ‡•á‡§Ç ‡§Æ‡§¶‡§¶ ‡§ï‡§∞ ‡§∏‡§ï‡§§‡§æ ‡§π‡•Ç‡§Ç‡•§ ‡§Ü‡§ú ‡§Æ‡•à‡§Ç ‡§Ü‡§™‡§ï‡•Ä ‡§ï‡•à‡§∏‡•á ‡§Æ‡§¶‡§¶ ‡§ï‡§∞ ‡§∏‡§ï‡§§‡§æ ‡§π‡•Ç‡§Ç?",
                
                // Chat History
                chatHistoryTitle: "AI ‡§ö‡•à‡§ü ‡§á‡§§‡§ø‡§π‡§æ‡§∏",
                
                // Help Resources
                helpTitle: "‡§∏‡§π‡§æ‡§Ø‡§§‡§æ ‡§∏‡§Ç‡§∏‡§æ‡§ß‡§® ‡§î‡§∞ ‡§∏‡•ç‡§•‡§æ‡§®",
                emergencyResources: "‡§Ü‡§™‡§æ‡§§‡§ï‡§æ‡§≤‡•Ä‡§® ‡§∏‡§Ç‡§∏‡§æ‡§ß‡§®",
                legalAid: "‡§ï‡§æ‡§®‡•Ç‡§®‡•Ä ‡§∏‡§π‡§æ‡§Ø‡§§‡§æ",
                communityCenters: "‡§∏‡§æ‡§Æ‡•Å‡§¶‡§æ‡§Ø‡§ø‡§ï ‡§ï‡•á‡§Ç‡§¶‡•ç‡§∞",
                healthcareResources: "‡§∏‡•ç‡§µ‡§æ‡§∏‡•ç‡§•‡•ç‡§Ø ‡§∏‡•á‡§µ‡§æ",
                employmentResources: "‡§∞‡•ã‡§ú‡§ó‡§æ‡§∞",
                educationalResources: "‡§∂‡•à‡§ï‡•ç‡§∑‡§ø‡§ï ‡§∏‡§Ç‡§∏‡§æ‡§ß‡§®"
            },
            pt: {
                // Navigation
                dashboardNav: "üìä Painel",
                profileNav: "üë§ Perfil",
                documentsNav: "üìÑ Documentos",
                chatNav: "ü§ñ Assistente IA",
                chatHistoryNav: "üí¨ Chats IA",
                helpNav: "üÜò Recursos de Ajuda",
                
                // Dashboard
                dashboardTitle: "Painel - Immigr-Aid",
                completedLabel: "Conclu√≠do",
                remainingLabel: "Restante",
                profileTitle: "Informa√ß√µes Pessoais",
                profileDescription: "Complete seu perfil para habilitar assist√™ncia de IA com preenchimento de formul√°rios e orienta√ß√£o personalizada.",
                completeProfileBtn: "Completar Perfil",
                documentsTitle: "Documentos Necess√°rios",
                documentsDescription: "Todos os documentos necess√°rios para completar seu processo de aplica√ß√£o de imigra√ß√£o",
                
                // Profile
                profileSectionTitle: "Informa√ß√µes Pessoais",
                firstNameLabel: "Primeiro Nome",
                lastNameLabel: "Sobrenome",
                middleNameLabel: "Nome do Meio",
                dateOfBirthLabel: "Data de Nascimento",
                countryOfBirthLabel: "Pa√≠s de Nascimento",
                currentAddressLabel: "Endere√ßo Atual",
                phoneNumberLabel: "N√∫mero de Telefone",
                emailAddressLabel: "Endere√ßo de Email",
                socialSecurityNumberLabel: "N√∫mero do Seguro Social",
                entryDateLabel: "Data de Entrada nos EUA",
                methodOfEntryLabel: "M√©todo de Entrada",
                educationLevelLabel: "N√≠vel de Educa√ß√£o",
                employmentStatusLabel: "Status de Emprego",
                criminalHistoryLabel: "Hist√≥rico Criminal",
                saveProfileBtn: "Salvar Informa√ß√µes do Perfil",
                
                // Documents
                documentsSectionTitle: "Documentos Necess√°rios",
                
                // Chat
                chatTitle: "Assistente IA - Immigr-Aid",
                welcomeMessage: "Ol√°! Eu sou seu assistente de imigra√ß√£o com IA. Posso ajud√°-lo a preencher formul√°rios, responder perguntas sobre seu processo de imigra√ß√£o e gui√°-lo atrav√©s de cada etapa. Como posso ajud√°-lo hoje?",
                
                // Chat History
                chatHistoryTitle: "Hist√≥rico de Chats IA",
                
                // Help Resources
                helpTitle: "Recursos de Ajuda e Localiza√ß√µes",
                emergencyResources: "Recursos de Emerg√™ncia",
                legalAid: "Assist√™ncia Jur√≠dica",
                communityCenters: "Centros Comunit√°rios",
                healthcareResources: "Assist√™ncia M√©dica",
                employmentResources: "Emprego",
                educationalResources: "Recursos Educacionais"
            },
            ru: {
                // Navigation
                dashboardNav: "üìä –ü–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è",
                profileNav: "üë§ –ü—Ä–æ—Ñ–∏–ª—å",
                documentsNav: "üìÑ –î–æ–∫—É–º–µ–Ω—Ç—ã",
                chatNav: "ü§ñ –ò–ò –ü–æ–º–æ—â–Ω–∏–∫",
                chatHistoryNav: "üí¨ –ò–ò –ß–∞—Ç—ã",
                helpNav: "üÜò –†–µ—Å—É—Ä—Å—ã –ø–æ–º–æ—â–∏",
                
                // Dashboard
                dashboardTitle: "–ü–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è - Immigr-Aid",
                completedLabel: "–ó–∞–≤–µ—Ä—à–µ–Ω–æ",
                remainingLabel: "–û—Å—Ç–∞–ª–æ—Å—å",
                profileTitle: "–õ–∏—á–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è",
                profileDescription: "–ó–∞–ø–æ–ª–Ω–∏—Ç–µ —Å–≤–æ–π –ø—Ä–æ—Ñ–∏–ª—å –¥–ª—è –≤–∫–ª—é—á–µ–Ω–∏—è –ø–æ–º–æ—â–∏ –ò–ò –≤ –∑–∞–ø–æ–ª–Ω–µ–Ω–∏–∏ —Ñ–æ—Ä–º –∏ –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω–æ–≥–æ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–∞.",
                completeProfileBtn: "–ó–∞–≤–µ—Ä—à–∏—Ç—å –ø—Ä–æ—Ñ–∏–ª—å",
                documentsTitle: "–ù–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã",
                documentsDescription: "–í—Å–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã, –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –¥–ª—è –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –ø—Ä–æ—Ü–µ—Å—Å–∞ –∏–º–º–∏–≥—Ä–∞—Ü–∏–æ–Ω–Ω–æ–π –∑–∞—è–≤–∫–∏",
                
                // Profile
                profileSectionTitle: "–õ–∏—á–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è",
                firstNameLabel: "–ò–º—è",
                lastNameLabel: "–§–∞–º–∏–ª–∏—è",
                middleNameLabel: "–û—Ç—á–µ—Å—Ç–≤–æ",
                dateOfBirthLabel: "–î–∞—Ç–∞ —Ä–æ–∂–¥–µ–Ω–∏—è",
                countryOfBirthLabel: "–°—Ç—Ä–∞–Ω–∞ —Ä–æ–∂–¥–µ–Ω–∏—è",
                currentAddressLabel: "–¢–µ–∫—É—â–∏–π –∞–¥—Ä–µ—Å",
                phoneNumberLabel: "–ù–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞",
                emailAddressLabel: "–ê–¥—Ä–µ—Å —ç–ª–µ–∫—Ç—Ä–æ–Ω–Ω–æ–π –ø–æ—á—Ç—ã",
                socialSecurityNumberLabel: "–ù–æ–º–µ—Ä —Å–æ—Ü–∏–∞–ª—å–Ω–æ–≥–æ —Å—Ç—Ä–∞—Ö–æ–≤–∞–Ω–∏—è",
                entryDateLabel: "–î–∞—Ç–∞ –≤—ä–µ–∑–¥–∞ –≤ –°–®–ê",
                methodOfEntryLabel: "–°–ø–æ—Å–æ–± –≤—ä–µ–∑–¥–∞",
                educationLevelLabel: "–£—Ä–æ–≤–µ–Ω—å –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è",
                employmentStatusLabel: "–°—Ç–∞—Ç—É—Å –∑–∞–Ω—è—Ç–æ—Å—Ç–∏",
                criminalHistoryLabel: "–£–≥–æ–ª–æ–≤–Ω–∞—è –∏—Å—Ç–æ—Ä–∏—è",
                saveProfileBtn: "–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –ø—Ä–æ—Ñ–∏–ª—è",
                
                // Documents
                documentsSectionTitle: "–ù–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã",
                
                // Chat
                chatTitle: "–ò–ò –ü–æ–º–æ—â–Ω–∏–∫ - Immigr-Aid",
                welcomeMessage: "–ü—Ä–∏–≤–µ—Ç! –Ø –≤–∞—à –ò–ò –ø–æ–º–æ—â–Ω–∏–∫ –ø–æ –∏–º–º–∏–≥—Ä–∞—Ü–∏–∏. –Ø –º–æ–≥—É –ø–æ–º–æ—á—å –≤–∞–º –∑–∞–ø–æ–ª–Ω–∏—Ç—å —Ñ–æ—Ä–º—ã, –æ—Ç–≤–µ—Ç–∏—Ç—å –Ω–∞ –≤–æ–ø—Ä–æ—Å—ã –æ –≤–∞—à–µ–º –∏–º–º–∏–≥—Ä–∞—Ü–∏–æ–Ω–Ω–æ–º –ø—Ä–æ—Ü–µ—Å—Å–µ –∏ –ø—Ä–æ–≤–µ—Å—Ç–∏ –≤–∞—Å —á–µ—Ä–µ–∑ –∫–∞–∂–¥—ã–π —à–∞–≥. –ö–∞–∫ —è –º–æ–≥—É –ø–æ–º–æ—á—å –≤–∞–º —Å–µ–≥–æ–¥–Ω—è?",
                
                // Chat History
                chatHistoryTitle: "–ò—Å—Ç–æ—Ä–∏—è –ò–ò —á–∞—Ç–æ–≤",
                
                // Help Resources
                helpTitle: "–†–µ—Å—É—Ä—Å—ã –ø–æ–º–æ—â–∏ –∏ –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏—è",
                emergencyResources: "–≠–∫—Å—Ç—Ä–µ–Ω–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã",
                legalAid: "–Æ—Ä–∏–¥–∏—á–µ—Å–∫–∞—è –ø–æ–º–æ—â—å",
                communityCenters: "–û–±—â–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ —Ü–µ–Ω—Ç—Ä—ã",
                healthcareResources: "–ó–¥—Ä–∞–≤–æ–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ",
                employmentResources: "–¢—Ä—É–¥–æ—É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ",
                educationalResources: "–û–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã"
            },
            fr: {
                // Navigation
                dashboardNav: "üìä Tableau de bord",
                profileNav: "üë§ Profil",
                documentsNav: "üìÑ Documents",
                chatNav: "ü§ñ Assistant IA",
                chatHistoryNav: "üí¨ Chats IA",
                helpNav: "üÜò Ressources d'aide",
                
                // Dashboard
                dashboardTitle: "Tableau de bord - Immigr-Aid",
                completedLabel: "Termin√©",
                remainingLabel: "Restant",
                profileTitle: "Informations personnelles",
                profileDescription: "Compl√©tez votre profil pour activer l'assistance IA avec le remplissage de formulaires et l'orientation personnalis√©e.",
                completeProfileBtn: "Compl√©ter le profil",
                documentsTitle: "Documents requis",
                documentsDescription: "Tous les documents n√©cessaires pour compl√©ter votre processus de demande d'immigration",
                
                // Profile
                profileSectionTitle: "Informations personnelles",
                firstNameLabel: "Pr√©nom",
                lastNameLabel: "Nom de famille",
                middleNameLabel: "Deuxi√®me pr√©nom",
                dateOfBirthLabel: "Date de naissance",
                countryOfBirthLabel: "Pays de naissance",
                currentAddressLabel: "Adresse actuelle",
                phoneNumberLabel: "Num√©ro de t√©l√©phone",
                emailAddressLabel: "Adresse e-mail",
                socialSecurityNumberLabel: "Num√©ro de s√©curit√© sociale",
                entryDateLabel: "Date d'entr√©e aux √âtats-Unis",
                methodOfEntryLabel: "M√©thode d'entr√©e",
                educationLevelLabel: "Niveau d'√©ducation",
                employmentStatusLabel: "Statut d'emploi",
                criminalHistoryLabel: "Ant√©c√©dents criminels",
                saveProfileBtn: "Enregistrer les informations du profil",
                
                // Documents
                documentsSectionTitle: "Documents requis",
                
                // Chat
                chatTitle: "Assistant IA - Immigr-Aid",
                welcomeMessage: "Bonjour ! Je suis votre assistant d'immigration IA. Je peux vous aider √† remplir des formulaires, r√©pondre √† des questions sur votre processus d'immigration et vous guider √† travers chaque √©tape. Comment puis-je vous aider aujourd'hui ?",
                
                // Chat History
                chatHistoryTitle: "Historique des chats IA",
                
                // Help Resources
                helpTitle: "Ressources d'aide et emplacements",
                emergencyResources: "Ressources d'urgence",
                legalAid: "Aide juridique",
                communityCenters: "Centres communautaires",
                healthcareResources: "Soins de sant√©",
                employmentResources: "Emploi",
                educationalResources: "Ressources √©ducatives"
            }
        };

        function updateLanguage() {
            const t = translations[currentLanguage] || translations.en;
            
            // Force complete page refresh
            document.body.style.opacity = '0.8';
            
            setTimeout(() => {
                // Update navigation
                document.getElementById('dashboardNav').innerHTML = t.dashboardNav;
                document.getElementById('profileNav').innerHTML = t.profileNav;
                document.getElementById('documentsNav').innerHTML = t.documentsNav;
                document.getElementById('chatNav').innerHTML = t.chatNav;
                document.getElementById('chatHistoryNav').innerHTML = t.chatHistoryNav;
                document.getElementById('helpNav').innerHTML = t.helpNav;
                
                // Update section titles
                document.getElementById('dashboardTitle').textContent = t.dashboardTitle;
                document.getElementById('profileSectionTitle').textContent = t.profileSectionTitle;
                document.getElementById('documentsSectionTitle').textContent = t.documentsSectionTitle;
                document.getElementById('chatTitle').textContent = t.chatTitle;
                document.getElementById('chatHistoryTitle').textContent = t.chatHistoryTitle;
                document.getElementById('helpTitle').textContent = t.helpTitle;
                
                // Update dashboard
                document.getElementById('completedLabel').textContent = t.completedLabel;
                document.getElementById('remainingLabel').textContent = t.remainingLabel;
                document.getElementById('profileTitle').textContent = t.profileTitle;
                document.getElementById('profileDescription').textContent = t.profileDescription;
                document.getElementById('completeProfileBtn').textContent = t.completeProfileBtn;
                document.getElementById('documentsTitle').textContent = t.documentsTitle;
                document.getElementById('documentsDescription').textContent = t.documentsDescription;
                
                // Update profile form labels
                document.getElementById('firstNameLabel').textContent = t.firstNameLabel + ' *';
                document.getElementById('lastNameLabel').textContent = t.lastNameLabel + ' *';
                document.getElementById('middleNameLabel').textContent = t.middleNameLabel;
                document.getElementById('dateOfBirthLabel').textContent = t.dateOfBirthLabel + ' *';
                document.getElementById('countryOfBirthLabel').textContent = t.countryOfBirthLabel + ' *';
                document.getElementById('currentAddressLabel').textContent = t.currentAddressLabel + ' *';
                document.getElementById('phoneNumberLabel').textContent = t.phoneNumberLabel + ' *';
                document.getElementById('emailAddressLabel').textContent = t.emailAddressLabel + ' *';
                document.getElementById('socialSecurityNumberLabel').textContent = t.socialSecurityNumberLabel;
                document.getElementById('entryDateLabel').textContent = t.entryDateLabel + ' *';
                document.getElementById('methodOfEntryLabel').textContent = t.methodOfEntryLabel + ' *';
                document.getElementById('educationLevelLabel').textContent = t.educationLevelLabel + ' *';
                document.getElementById('employmentStatusLabel').textContent = t.employmentStatusLabel + ' *';
                document.getElementById('criminalHistoryLabel').textContent = t.criminalHistoryLabel + ' *';
                document.getElementById('saveProfileBtn').textContent = t.saveProfileBtn;
                
                // Update sidebar AI elements
                document.getElementById('aiSidebarSubtitle').textContent = t.aiSidebarSubtitle || "I'm here to help you with your immigration forms and questions. Ask me anything!";
                document.getElementById('aiSidebarWelcomeMessage').textContent = t.aiSidebarWelcomeMessage || "Hello! I'm your AI immigration assistant. I can help you fill out forms, answer questions about your immigration process, and guide you through each step. How can I assist you today?";
                document.getElementById('aiSidebarInput').placeholder = t.aiSidebarPlaceholder || "Ask me anything...";
                
                // Update help resources
                document.getElementById('emergencyResources').textContent = t.emergencyResources;
                document.getElementById('legalAid').textContent = t.legalAid;
                document.getElementById('communityCenters').textContent = t.communityCenters;
                document.getElementById('healthcareResources').textContent = t.healthcareResources;
                document.getElementById('employmentResources').textContent = t.employmentResources;
                document.getElementById('educationalResources').textContent = t.educationalResources;
                
                // Restore opacity
                document.body.style.opacity = '1';
            }, 50);
        }

        // Initialize the application
        document.addEventListener('DOMContentLoaded', function() {
            populatePathways();
            populateDocuments();
            populateHelpResources();
            initializeSpeechRecognition();
        });
    </script>
</body>
</html>
